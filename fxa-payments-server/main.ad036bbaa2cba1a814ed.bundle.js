(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"g",function(){return mapToObject}),__webpack_require__.d(__webpack_exports__,"a",function(){return APIError}),__webpack_require__.d(__webpack_exports__,"c",function(){return apiGet}),__webpack_require__.d(__webpack_exports__,"b",function(){return apiDelete}),__webpack_require__.d(__webpack_exports__,"d",function(){return apiPost}),__webpack_require__.d(__webpack_exports__,"h",function(){return setStatic}),__webpack_require__.d(__webpack_exports__,"e",function(){return fetchDefault}),__webpack_require__.d(__webpack_exports__,"f",function(){return fetchReducer});var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(12),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(80),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(281),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(137),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(82),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(275),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(280),redux_promise_middleware__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(86);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach(function(key){Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.a)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}var mapToObject=function mapToObject(list,mapFn){var out={},_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=list[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var item=_step.value;out[item]=mapFn(item)}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return out},APIError=function(_Error){function APIError(body,response,code,errno,error,statusCode){var _getPrototypeOf2,_this;Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__.a)(this,APIError);for(var _len=arguments.length,params=new Array(_len>6?_len-6:0),_key=6;_key<_len;_key++)params[_key-6]=arguments[_key];if((_this=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__.a)(this,(_getPrototypeOf2=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__.a)(APIError)).call.apply(_getPrototypeOf2,[this].concat(params)))).body=void 0,_this.response=void 0,_this.code=void 0,_this.statusCode=void 0,_this.errno=void 0,_this.error=void 0,_this.response=response,_this.body=body||null,_this.code=code||null,_this.statusCode=statusCode||null,_this.errno=errno||null,_this.error=error||null,_this.body){var _this$body=_this.body,_code=_this$body.code,_errno=_this$body.errno,_error=_this$body.error,message=_this$body.message,_statusCode=_this$body.statusCode;Object.assign(Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__.a)(_this),{code:_code,errno:_errno,error:_error,message:message,statusCode:_statusCode})}return _this}return Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_7__.a)(APIError,_Error),APIError}(Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_8__.a)(Error)),apiFetch=function(){var _ref=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee(method,accessToken,path){var options,response,body,_args=arguments;return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return options=_args.length>3&&void 0!==_args[3]?_args[3]:{},_context.next=3,fetch(path,_objectSpread({mode:"cors",credentials:"omit",method:method},options,{headers:_objectSpread({"Content-Type":"application/json",Authorization:"Bearer ".concat(accessToken)},options.headers||{})}));case 3:if(!((response=_context.sent).status>=400)){_context.next=15;break}return body={},_context.prev=6,_context.next=9,response.json();case 9:body=_context.sent,_context.next=14;break;case 12:_context.prev=12,_context.t0=_context.catch(6);case 14:throw new APIError(body,response);case 15:return _context.abrupt("return",response.json());case 16:case"end":return _context.stop()}},_callee,null,[[6,12]])}));return function apiFetch(_x,_x2,_x3){return _ref.apply(this,arguments)}}(),apiGet=function apiGet(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return apiFetch.apply(void 0,["GET"].concat(args))},apiDelete=function apiDelete(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return apiFetch.apply(void 0,["DELETE"].concat(args))},apiPost=function apiPost(accessToken,path,body){return apiFetch("POST",accessToken,path,{body:JSON.stringify(body)})},setStatic=function setStatic(newState){return function(state){return _objectSpread({},state,{},newState)}},fetchDefault=function fetchDefault(defaultResult){return{error:null,loading:!1,result:defaultResult}},fetchReducer=function fetchReducer(name){var _ref7;return _ref7={},Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.a)(_ref7,redux_promise_middleware__WEBPACK_IMPORTED_MODULE_9__.a.Pending,function(state){return _objectSpread({},state,Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.a)({},name,{error:null,loading:!0,result:null}))}),Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.a)(_ref7,redux_promise_middleware__WEBPACK_IMPORTED_MODULE_9__.a.Fulfilled,function(state,_ref5){var payload=_ref5.payload;return _objectSpread({},state,Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.a)({},name,{error:null,loading:!1,result:payload}))}),Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.a)(_ref7,redux_promise_middleware__WEBPACK_IMPORTED_MODULE_9__.a.Rejected,function(state,_ref6){var payload=_ref6.payload;return _objectSpread({},state,Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.a)({},name,{error:payload,loading:!1,result:null}))}),_ref7}},108:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return AlertBar});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_Portal__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(552),__webpack_require__(136)),AlertBar=function AlertBar(_ref){var children=_ref.children,_ref$className=_ref.className,className=void 0===_ref$className?"alert":_ref$className;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_Portal__WEBPACK_IMPORTED_MODULE_2__.a,{id:"top-bar"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{"data-testid":"alert-container",className:className},children))};__webpack_exports__.b=AlertBar},135:function(module,__webpack_exports__,__webpack_require__){"use strict";function formatCurrencyInCents(amount){return(amount/100).toFixed(2)}__webpack_require__.d(__webpack_exports__,"a",function(){return formatCurrencyInCents})},136:function(module,__webpack_exports__,__webpack_require__){"use strict";var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(107);__webpack_require__(553);__webpack_exports__.a=Object(react__WEBPACK_IMPORTED_MODULE_0__.memo)(function Portal(_ref){var id=_ref.id,children=_ref.children,el=document.getElementById(id);return el||((el=document.createElement("div")).setAttribute("class","portal"),el.setAttribute("id",id),document.body.appendChild(el)),Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(function(){return function(){var el=document.getElementById(id);el&&1===el.children.length&&el.remove()}},[id]),Object(react_dom__WEBPACK_IMPORTED_MODULE_1__.createPortal)(children,el)})},138:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Tooltip});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(68),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_lib_AppContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(17),Tooltip=function Tooltip(_ref){var children=_ref.children,parentRef=_ref.parentRef,_ref$id=_ref.id,id=void 0===_ref$id?"":_ref$id,_ref$showBelow=_ref.showBelow,showBelow=void 0===_ref$showBelow||_ref$showBelow,_ref$dismissible=_ref.dismissible,dismissible=void 0!==_ref$dismissible&&_ref$dismissible,_ref$onDismiss=_ref.onDismiss,onDismiss=void 0===_ref$onDismiss?function(){}:_ref$onDismiss,_ref$extraClassNames=_ref.extraClassNames,extraClassNames=void 0===_ref$extraClassNames?"":_ref$extraClassNames,screenInfo=(0,Object(react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_lib_AppContext__WEBPACK_IMPORTED_MODULE_2__.a).getScreenInfo)(),_screenInfo$clientHei=screenInfo.clientHeight,clientHeight=void 0===_screenInfo$clientHei?1e3:_screenInfo$clientHei,_screenInfo$clientWid=screenInfo.clientWidth,doShowBelow=showBelow&&clientHeight>=480&&(void 0===_screenInfo$clientWid?1e3:_screenInfo$clientWid)>=520,tooltipRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(function(){var tooltipEl=tooltipRef.current,parentEl=parentRef.current;tooltipEl&&parentEl&&(tooltipEl.style.top=doShowBelow?parentEl.offsetTop+parentEl.offsetHeight+4+"px":parentEl.offsetTop+(0-tooltipEl.offsetHeight-2)+"px")},[doShowBelow,tooltipRef,parentRef]);var asideClassNames=["tooltip",extraClassNames,doShowBelow?"tooltip-below fade-up-tt":"fade-down-tt"];return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("aside",{ref:tooltipRef,id:id,className:classnames__WEBPACK_IMPORTED_MODULE_1___default.a.apply(void 0,asideClassNames)},children,dismissible&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{"data-testid":"dismiss-button",onClick:onDismiss,className:"dismiss",tabIndex:2},"✕"))};__webpack_exports__.b=Tooltip},17:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return AppContext});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_config__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(21),_screen_info__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(79),noopFunction=function noopFunction(){},defaultAppContext={accessToken:"",config:_config__WEBPACK_IMPORTED_MODULE_1__.a,getScreenInfo:function getScreenInfo(){return new _screen_info__WEBPACK_IMPORTED_MODULE_2__.a},locationReload:noopFunction,matchMedia:function matchMedia(){return!1},navigateToUrl:noopFunction,queryParams:{}},AppContext=react__WEBPACK_IMPORTED_MODULE_0___default.a.createContext(defaultAppContext);__webpack_exports__.b=AppContext},18:function(module,__webpack_exports__,__webpack_require__){"use strict";var defineProperty=__webpack_require__(2),react=__webpack_require__(0),react_default=__webpack_require__.n(react),dist=__webpack_require__(20),es=__webpack_require__(59),MockLoader_MockLoader=function MockLoader(_ref){var children=_ref.children;return react_default.a.createElement(react_default.a.Suspense,{fallback:react_default.a.createElement("div",null,"Loading")},children)},AppContext=__webpack_require__(17),config=__webpack_require__(21),screen_info=__webpack_require__(79);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach(function(key){Object(defineProperty.a)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}__webpack_require__.d(__webpack_exports__,"b",function(){return defaultAppContextValue});var defaultAppContextValue={accessToken:"at_12345",config:_objectSpread({},config.a,{productRedirectURLs:{product_8675309:"https://example.com/product"},servers:_objectSpread({},config.a.servers,{content:{url:"https://accounts.firefox.com"}})}),queryParams:{},navigateToUrl:Object(dist.action)("navigateToUrl"),getScreenInfo:function getScreenInfo(){return new screen_info.a(window)},matchMedia:function matchMedia(query){return window.matchMedia(query).matches},locationReload:Object(dist.action)("locationReload")},defaultStripeStubs=function defaultStripeStubs(stripe){return stripe.createToken=function(element){return Promise.resolve({token:{id:"asdf",object:"mock_object",client_ip:"123.123.123.123",created:Date.now(),livemode:!1,type:"card",used:!1}})},stripe};__webpack_exports__.a=function MockApp(_ref){var children=_ref.children,_ref$stripeApiKey=_ref.stripeApiKey,stripeApiKey=void 0===_ref$stripeApiKey?"8675309":_ref$stripeApiKey,_ref$applyStubsToStri=_ref.applyStubsToStripe,applyStubsToStripe=void 0===_ref$applyStubsToStri?defaultStripeStubs:_ref$applyStubsToStri,_ref$appContextValue=_ref.appContextValue,appContextValue=void 0===_ref$appContextValue?defaultAppContextValue:_ref$appContextValue,mockStripe=Object(react.useMemo)(function(){return applyStubsToStripe(window.Stripe(stripeApiKey))},[stripeApiKey,applyStubsToStripe]);return Object(react.useEffect)(function(){var el=document.documentElement;el.setAttribute("lang","en"),el.setAttribute("dir","ltr"),el.setAttribute("class","js no-touch no-reveal-pw getusermedia")},[]),react_default.a.createElement(es.StripeProvider,{stripe:mockStripe},react_default.a.createElement(AppContext.a.Provider,{value:appContextValue},react_default.a.createElement(MockLoader_MockLoader,null,children)))}},21:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return config});__webpack_require__(6);var config={featureFlags:{},sentryDsn:"",servers:{auth:{url:""},content:{url:""},oauth:{url:""},profile:{url:""}},stripe:{apiKey:""},lang:"",productRedirectURLs:{},legalDocLinks:{privacyNotice:"",termsOfService:""}}},270:function(module,__webpack_exports__,__webpack_require__){"use strict";var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);__webpack_exports__.a=function LoremIpsum(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam diam orci, pulvinar sit amet lorem sed, scelerisque laoreet nulla. Vestibulum scelerisque non ligula eget auctor. Aliquam ullamcorper, quam non convallis ultricies, tellus nunc sodales mi, vel ultricies tellus ex sit amet mi. Mauris sit amet arcu at libero feugiat lacinia sed non ligula. Maecenas sit amet posuere orci. Mauris venenatis pulvinar nisi, eget porta mi. Praesent et velit pulvinar, ultrices velit non, vehicula felis.")}},278:function(module,__webpack_exports__,__webpack_require__){"use strict";var slicedToArray=__webpack_require__(6),react=__webpack_require__(0),react_default=__webpack_require__.n(react),es=__webpack_require__(84),dayjs_min=__webpack_require__(57),dayjs_min_default=__webpack_require__.n(dayjs_min),errors=__webpack_require__(70),store=__webpack_require__(5),AppContext=__webpack_require__(17),AlertBar=(__webpack_require__(593),__webpack_require__(108)),DialogMessage=__webpack_require__(7),hooks=__webpack_require__(55),formats=__webpack_require__(135),PaymentForm=__webpack_require__(85),Subscriptions_PaymentUpdateForm=function PaymentUpdateForm(_ref){var accessToken=_ref.accessToken,updatePayment=_ref.updatePayment,updatePaymentStatus=_ref.updatePaymentStatus,resetUpdatePayment=_ref.resetUpdatePayment,customer=_ref.customer,customerSubscription=_ref.customerSubscription,plan=_ref.plan,_useBooleanState=Object(hooks.a)(),_useBooleanState2=Object(slicedToArray.a)(_useBooleanState,3),updateRevealed=_useBooleanState2[0],revealUpdate=_useBooleanState2[1],hideUpdate=_useBooleanState2[2],_useState=Object(react.useState)({type:"",error:!1}),_useState2=Object(slicedToArray.a)(_useState,2),createTokenError=_useState2[0],setCreateTokenError=_useState2[1],onRevealUpdateClick=Object(react.useCallback)(function(){resetUpdatePayment(),revealUpdate()},[resetUpdatePayment,revealUpdate]),onPayment=Object(react.useCallback)(function(tokenResponse){if(tokenResponse&&tokenResponse.token)updatePayment(accessToken,{paymentToken:tokenResponse.token.id});else{setCreateTokenError({type:"api_error",error:!0})}},[accessToken,updatePayment,setCreateTokenError]),onPaymentError=Object(react.useCallback)(function(error){error.error=!0,setCreateTokenError(error)},[setCreateTokenError]),onTokenErrorDismiss=Object(react.useCallback)(function(){setCreateTokenError({type:"",error:!1})},[setCreateTokenError]),inProgress=updatePaymentStatus.loading||null!==updatePaymentStatus.error,_ref2=customer.result,last4=_ref2.last4,exp_month=_ref2.exp_month,exp_year=_ref2.exp_year,periodEndDate=dayjs_min_default.a.unix(customerSubscription.current_period_end).format("MM/DD/YYYY"),expirationDate=dayjs_min_default()().set("month",Number(exp_month)).set("year",Number(exp_year)).format("MMMM YYYY");return react_default.a.createElement("div",{className:"payment-update"},createTokenError.error&&react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:onTokenErrorDismiss},react_default.a.createElement("h4",{"data-testid":"error-payment-submission"},"Payment submission failed"),react_default.a.createElement("p",null,Object(errors.b)(createTokenError.type))),react_default.a.createElement("h3",{className:"billing-title"},react_default.a.createElement("span",null,"Billing Information")),react_default.a.createElement("p",{className:"billing-description"},"You'll be billed $",Object(formats.a)(plan.amount)," per"," ",plan.interval," for ",plan.plan_name,". Your next payment occurs on"," ",periodEndDate,"."),updateRevealed?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(PaymentForm.a,{onPayment:onPayment,onPaymentError:onPaymentError,inProgress:inProgress,confirm:!1,onCancel:hideUpdate})):react_default.a.createElement("div",{className:"with-settings-button"},react_default.a.createElement("div",{className:"card-details"},react_default.a.createElement("div",null,"Card ending ",last4),react_default.a.createElement("div",null,"Expires ",expirationDate)),react_default.a.createElement("div",{className:"action"},react_default.a.createElement("button",{"data-testid":"reveal-payment-update-button",className:"settings-button",onClick:onRevealUpdateClick},react_default.a.createElement("span",{className:"change-button"},"Change")))))},SubscriptionItem_CancelSubscriptionPanel=function CancelSubscriptionPanel(_ref2){var accessToken=_ref2.accessToken,plan=_ref2.plan,cancelSubscription=_ref2.cancelSubscription,_ref2$customerSubscri=_ref2.customerSubscription,subscription_id=_ref2$customerSubscri.subscription_id,current_period_end=_ref2$customerSubscri.current_period_end,_useBooleanState=Object(hooks.a)(),_useBooleanState2=Object(slicedToArray.a)(_useBooleanState,3),cancelRevealed=_useBooleanState2[0],revealCancel=_useBooleanState2[1],hideCancel=_useBooleanState2[2],_useCheckboxState=Object(hooks.b)(),_useCheckboxState2=Object(slicedToArray.a)(_useCheckboxState,2),confirmationChecked=_useCheckboxState2[0],onConfirmationChanged=_useCheckboxState2[1],confirmCancellation=Object(react.useCallback)(function(){return cancelSubscription(accessToken,subscription_id)},[accessToken,cancelSubscription,subscription_id]),periodEndDate=dayjs_min_default.a.unix(current_period_end).format("MMMM DD, YYYY");return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("div",{className:"cancel-subscription"},cancelRevealed?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("h3",null,"Cancel Subscription"),react_default.a.createElement("p",null,"Cancelling means you'll no longer be able to access any of the"," ",plan.plan_name," features or your saved information after"," ",periodEndDate,", the last day of your billing cycle."),react_default.a.createElement("p",null,react_default.a.createElement("label",null,react_default.a.createElement("input",{"data-testid":"confirm-cancel-subscription-checkbox",type:"checkbox",defaultChecked:confirmationChecked,onChange:onConfirmationChanged}),react_default.a.createElement("span",null,"Cancel my access and my saved information within"," ",plan.plan_name," on ",periodEndDate))),react_default.a.createElement("div",{className:"button-row"},react_default.a.createElement("button",{className:"settings-button primary-button",onClick:hideCancel},"Stay Subscribed"),react_default.a.createElement("button",{"data-testid":"cancel-subscription-button",className:"settings-button secondary-button",onClick:confirmCancellation,disabled:!confirmationChecked},"Cancel Subscription"))):react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("div",{className:"with-settings-button"},react_default.a.createElement("div",{className:"card-details"},react_default.a.createElement("h3",null,"Cancel Subscription")),react_default.a.createElement("div",{className:"action"},react_default.a.createElement("button",{className:"settings-button",onClick:revealCancel,"data-testid":"reveal-cancel-subscription-button"},react_default.a.createElement("span",{className:"change-button"},"Cancel")))))))},SubscriptionItem_ReactivateSubscriptionPanel=function ReactivateSubscriptionPanel(_ref3){var accessToken=_ref3.accessToken,plan=_ref3.plan,customerSubscription=_ref3.customerSubscription,subscription=_ref3.subscription,reactivateSubscription=_ref3.reactivateSubscription,subscription_id=customerSubscription.subscription_id,onReactivateClick=Object(react.useCallback)(function(){return reactivateSubscription(accessToken,subscription_id)},[accessToken,reactivateSubscription,subscription_id]),cancelledAtDate=dayjs_min_default.a.unix(subscription.cancelledAt/1e3).format("MMMM DD, YYYY"),periodEndDate=dayjs_min_default.a.unix(customerSubscription.current_period_end).format("MMMM DD, YYYY");return react_default.a.createElement("div",{className:"subscription-cancelled"},react_default.a.createElement("div",{className:"with-settings-button"},react_default.a.createElement("div",null,react_default.a.createElement("p",null,"You cancelled your subscription on ",cancelledAtDate,"."),react_default.a.createElement("p",null,"You will lose access to ",plan.plan_name," on"," ",react_default.a.createElement("strong",null,periodEndDate),".")),react_default.a.createElement("div",{className:"action"},react_default.a.createElement("button",{className:"settings-button",onClick:onReactivateClick,"data-testid":"reactivate-subscription-button"},react_default.a.createElement("span",{className:"change-button"},"Resubscribe")))))},Subscriptions_SubscriptionItem=function SubscriptionItem(_ref){var accessToken=_ref.accessToken,subscription=_ref.subscription,cancelSubscription=_ref.cancelSubscription,reactivateSubscription=_ref.reactivateSubscription,customer=_ref.customer,plan=_ref.plan,updatePayment=_ref.updatePayment,resetUpdatePayment=_ref.resetUpdatePayment,updatePaymentStatus=_ref.updatePaymentStatus,customerSubscription=_ref.customerSubscription,locationReload=Object(react.useContext)(AppContext.b).locationReload;return subscription?plan?react_default.a.createElement("div",{className:"settings-unit"},react_default.a.createElement("div",{className:"subscription","data-testid":"subscription-item"},react_default.a.createElement("header",null,react_default.a.createElement("h2",null,plan.plan_name)),customerSubscription.cancel_at_period_end?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(SubscriptionItem_ReactivateSubscriptionPanel,{accessToken:accessToken,plan:plan,customerSubscription:customerSubscription,subscription:subscription,reactivateSubscription:reactivateSubscription})):react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(Subscriptions_PaymentUpdateForm,{plan:plan,customerSubscription:customerSubscription,accessToken:accessToken,customer:customer,updatePayment:updatePayment,resetUpdatePayment:resetUpdatePayment,updatePaymentStatus:updatePaymentStatus}),react_default.a.createElement(SubscriptionItem_CancelSubscriptionPanel,{accessToken:accessToken,cancelSubscription:cancelSubscription,plan:plan,customerSubscription:customerSubscription})))):react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:locationReload},react_default.a.createElement("h4",{"data-testid":"error-subhub-missing-plan"},"Plan not found"),react_default.a.createElement("p",null,"No such plan for this subscription.")):react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:locationReload},react_default.a.createElement("h4",{"data-testid":"error-fxa-missing-subscription"},"Problem loading subscriptions"),react_default.a.createElement("p",null,"Please try again later."))},LoadingOverlay=__webpack_require__(81);__webpack_require__.d(__webpack_exports__,"a",function(){return Subscriptions_Subscriptions});var Subscriptions_Subscriptions=function Subscriptions(_ref){var profile=_ref.profile,customer=_ref.customer,plans=_ref.plans,subscriptions=_ref.subscriptions,customerSubscriptions=_ref.customerSubscriptions,fetchSubscriptionsRouteResources=_ref.fetchSubscriptionsRouteResources,cancelSubscription=_ref.cancelSubscription,cancelSubscriptionStatus=_ref.cancelSubscriptionStatus,reactivateSubscription=_ref.reactivateSubscription,reactivateSubscriptionStatus=_ref.reactivateSubscriptionStatus,resetReactivateSubscription=_ref.resetReactivateSubscription,updatePayment=_ref.updatePayment,resetUpdatePayment=_ref.resetUpdatePayment,resetCancelSubscription=_ref.resetCancelSubscription,updatePaymentStatus=_ref.updatePaymentStatus,_useContext=Object(react.useContext)(AppContext.a),accessToken=_useContext.accessToken,config=_useContext.config,locationReload=_useContext.locationReload,navigateToUrl=_useContext.navigateToUrl,_useState=(_useContext.queryParams,Object(react.useState)(!0)),_useState2=Object(slicedToArray.a)(_useState,2),showPaymentSuccessAlert=_useState2[0],setShowPaymentSuccessAlert=_useState2[1],clearSuccessAlert=Object(react.useCallback)(function(){return setShowPaymentSuccessAlert(!1)},[setShowPaymentSuccessAlert]),SUPPORT_FORM_URL="".concat(config.servers.content.url,"/support");Object(react.useEffect)(function(){fetchSubscriptionsRouteResources(accessToken)},[fetchSubscriptionsRouteResources,accessToken]);var onSupportClick=Object(react.useCallback)(function(){return navigateToUrl(SUPPORT_FORM_URL)},[navigateToUrl,SUPPORT_FORM_URL]);return customer.loading||subscriptions.loading||profile.loading||plans.loading?react_default.a.createElement(LoadingOverlay.a,{isLoading:!0}):null!==profile.error?react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:locationReload},react_default.a.createElement("h4",{"data-testid":"error-profile-fetch"},"Problem loading profile"),react_default.a.createElement("p",null,profile.error.message)):null!==plans.error?react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:locationReload},react_default.a.createElement("h4",{"data-testid":"error-plans-fetch"},"Problem loading plans"),react_default.a.createElement("p",null,plans.error.message)):null!==subscriptions.error?react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:locationReload},react_default.a.createElement("h4",{"data-testid":"error-subscriptions-fetch"},"Problem loading subscriptions"),react_default.a.createElement("p",null,subscriptions.error.message)):customer.error&&customer.error.errno!==errors.a.UNKNOWN_SUBSCRIPTION_CUSTOMER?react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:locationReload},react_default.a.createElement("h4",{"data-testid":"error-customer-fetch"},"Problem loading customer information"),react_default.a.createElement("p",null,customer.error.message)):react_default.a.createElement("div",{className:"subscription-management"},null!==cancelSubscriptionStatus.result&&react_default.a.createElement(Subscriptions_CancellationDialogMessage,{subscription:cancelSubscriptionStatus.result,customerSubscriptions:customerSubscriptions,plans:plans,resetCancelSubscription:resetCancelSubscription,supportFormUrl:SUPPORT_FORM_URL}),updatePaymentStatus.result&&showPaymentSuccessAlert&&react_default.a.createElement(AlertBar.b,{className:"alert alertSuccess alertCenter"},react_default.a.createElement("span",{"data-testid":"success-billing-update",className:"checked"},"Your billing information has been updated successfully"),react_default.a.createElement("span",{"data-testid":"clear-success-alert",className:"close",onClick:clearSuccessAlert})),updatePaymentStatus.loading&&react_default.a.createElement(AlertBar.b,{className:"alert alertPending"},react_default.a.createElement("span",null,"Updating billing information...")),updatePaymentStatus.error&&react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:resetUpdatePayment},react_default.a.createElement("h4",{"data-testid":"error-billing-update"},"Updating billing information failed"),react_default.a.createElement("p",null,updatePaymentStatus.error.message)),reactivateSubscriptionStatus.error&&react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:resetReactivateSubscription},react_default.a.createElement("h4",{"data-testid":"error-reactivation"},"Reactivating subscription failed"),react_default.a.createElement("p",null,reactivateSubscriptionStatus.error.message)),profile.result&&react_default.a.createElement(Subscriptions_ProfileBanner,{profile:profile.result}),react_default.a.createElement("div",{className:"child-views","data-testid":"subscription-management-loaded"},react_default.a.createElement("div",{className:"settings-child-view support"},react_default.a.createElement("div",{className:"settings-unit"},react_default.a.createElement("div",{className:"settings-unit-stub"},react_default.a.createElement("header",{className:"settings-unit-summary"},react_default.a.createElement("h2",{className:"settings-unit-title"},"Subscriptions")),react_default.a.createElement("button",{"data-testid":"contact-support-button",className:"settings-button secondary-button settings-unit-toggle",onClick:onSupportClick},react_default.a.createElement("span",{className:"change-button"},"Contact Support")))),0===customerSubscriptions.length&&react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("div",{className:"settings-unit"},react_default.a.createElement("div",{className:"subscription","data-testid":"no-subscriptions-available"},react_default.a.createElement("p",null,"No subscriptions available.")))),customerSubscriptions.map(function(customerSubscription,idx){return react_default.a.createElement(Subscriptions_SubscriptionItem,Object.assign({key:idx},{accessToken:accessToken,customer:customer,updatePayment:updatePayment,resetUpdatePayment:resetUpdatePayment,updatePaymentStatus:updatePaymentStatus,cancelSubscription:cancelSubscription,reactivateSubscription:reactivateSubscription,customerSubscription:customerSubscription,plan:planForId(customerSubscription.plan_id,plans),subscription:subscriptionForId(customerSubscription.subscription_id,subscriptions)}))}))))},subscriptionForId=function subscriptionForId(subscriptionId,subscriptions){return subscriptions.result.filter(function(subscription){return subscription.subscriptionId===subscriptionId})[0]},planForId=function planForId(planId,plans){return plans.result.filter(function(plan){return plan.plan_id===planId})[0]},Subscriptions_CancellationDialogMessage=function CancellationDialogMessage(_ref2){var subscription=_ref2.subscription,customerSubscriptions=_ref2.customerSubscriptions,plans=_ref2.plans,resetCancelSubscription=_ref2.resetCancelSubscription,supportFormUrl=_ref2.supportFormUrl,customerSubscription=function customerSubscriptionForId(subscriptionId,customerSubscriptions){return customerSubscriptions.filter(function(subscription){return subscription.subscription_id===subscriptionId})[0]}(subscription.subscriptionId,customerSubscriptions),plan=planForId(customerSubscription.plan_id,plans),periodEndDate=dayjs_min_default.a.unix(customerSubscription.current_period_end).format("MMMM DD, YYYY");return react_default.a.createElement(DialogMessage.b,{onDismiss:resetCancelSubscription},react_default.a.createElement("h4",{"data-testid":"cancellation-message-title"},"We're sorry to see you go"),react_default.a.createElement("p",null,"Your ",plan.plan_name," subscription has been cancelled. You will still have until access to ",plan.plan_name," until ",periodEndDate,"."),react_default.a.createElement("p",{className:"small"},"Have questions? Visit ",react_default.a.createElement("a",{href:supportFormUrl},"Mozilla Support"),"."))},Subscriptions_ProfileBanner=function ProfileBanner(_ref3){var _ref3$profile=_ref3.profile,email=_ref3$profile.email,avatar=_ref3$profile.avatar,displayName=_ref3$profile.displayName;return react_default.a.createElement("header",{id:"fxa-settings-profile-header-wrapper"},react_default.a.createElement("div",{className:"avatar-wrapper avatar-settings-view"},react_default.a.createElement("img",{src:avatar,alt:displayName||email,className:"profile-image"})),react_default.a.createElement("div",{id:"fxa-settings-profile-header"},displayName&&react_default.a.createElement("h1",{className:"card-header"},displayName),react_default.a.createElement("h2",{className:"card-subheader"},email)))};Object(es.a)(function(state){return{plans:store.b.plans(state),profile:store.b.profile(state),customer:store.b.customer(state),customerSubscriptions:store.b.customerSubscriptions(state),subscriptions:store.b.subscriptions(state),updatePaymentStatus:store.b.updatePaymentStatus(state),cancelSubscriptionStatus:store.b.cancelSubscriptionStatus(state),reactivateSubscriptionStatus:store.b.reactivateSubscriptionStatus(state),plansByProductId:store.b.plansByProductId(state)}},{fetchSubscriptionsRouteResources:store.c.fetchSubscriptionsRouteResources,updatePayment:store.c.updatePaymentAndRefresh,resetUpdatePayment:store.a.resetUpdatePayment,cancelSubscription:store.c.cancelSubscriptionAndRefresh,resetCancelSubscription:store.a.resetCancelSubscription,reactivateSubscription:store.c.reactivateSubscriptionAndRefresh,resetReactivateSubscription:store.a.resetReactivateSubscription})(Subscriptions_Subscriptions)},279:function(module,__webpack_exports__,__webpack_require__){"use strict";var slicedToArray=__webpack_require__(6),react=__webpack_require__(0),react_default=__webpack_require__.n(react),es=__webpack_require__(84),errors=__webpack_require__(70),store=__webpack_require__(5),AppContext=__webpack_require__(17),LoadingOverlay=__webpack_require__(81),DialogMessage=(__webpack_require__(589),__webpack_require__(7)),PaymentForm=__webpack_require__(85),loadDetails123DonePro=(__webpack_require__(590),function loadDetails123DonePro(){return __webpack_require__.e(3).then(__webpack_require__.bind(null,597))}),availableDetails={fortressProMonthly:react_default.a.lazy(loadDetails123DonePro),plan_FUUOYlhpIhWtoo:react_default.a.lazy(loadDetails123DonePro),plan_F4bof27uz71Vk7:react_default.a.lazy(loadDetails123DonePro),prod_FfiuDs9u11ESbD:react_default.a.lazy(loadDetails123DonePro)},defaultDetails=react_default.a.lazy(function(){return __webpack_require__.e(4).then(__webpack_require__.bind(null,598))}),routes_Product_PlanDetails=function PlanDetails(_ref){var plan=_ref.plan,Details=plan.plan_id in availableDetails?availableDetails[plan.plan_id]:defaultDetails;return react_default.a.createElement(Details,{plan:plan})},routes_Product_SubscriptionRedirect=(__webpack_require__(591),function SubscriptionRedirect(_ref){var _ref$plan=_ref.plan,product_id=_ref$plan.product_id,plan_name=_ref$plan.plan_name,_useContext=Object(react.useContext)(AppContext.a),productRedirectURLs=_useContext.config.productRedirectURLs,navigateToUrl=_useContext.navigateToUrl,redirectUrl=productRedirectURLs[product_id]||"https://mozilla.org";return Object(react.useEffect)(function(){navigateToUrl(redirectUrl)},[navigateToUrl,redirectUrl]),react_default.a.createElement("div",{className:"subscription-ready"},react_default.a.createElement("h2",null,"Your subscription is ready"),react_default.a.createElement("p",null,"Hang on for a moment while we send you to the"," ",react_default.a.createElement("span",{className:"plan-name"},plan_name)," download page."),react_default.a.createElement("a",{href:redirectUrl},"Click here if you're not automatically redirected"))});__webpack_require__.d(__webpack_exports__,"a",function(){return Product_Product});var Product_Product=function Product(_ref){var productId=_ref.match.params.productId,profile=_ref.profile,plans=_ref.plans,customer=_ref.customer,customerSubscriptions=_ref.customerSubscriptions,createSubscriptionStatus=_ref.createSubscriptionStatus,plansByProductId=_ref.plansByProductId,createSubscription=_ref.createSubscription,resetCreateSubscription=_ref.resetCreateSubscription,resetCreateSubscriptionError=_ref.resetCreateSubscriptionError,fetchProductRouteResources=_ref.fetchProductRouteResources,validatorInitialState=_ref.validatorInitialState,_useContext=Object(react.useContext)(AppContext.a),accessToken=_useContext.accessToken,queryParams=_useContext.queryParams,locationReload=_useContext.locationReload,_queryParams$plan=queryParams.plan,planId=void 0===_queryParams$plan?"":_queryParams$plan,_queryParams$activate=queryParams.activated,accountActivated=void 0!==_queryParams$activate&&_queryParams$activate,_useState=Object(react.useState)({type:"",error:!1}),_useState2=Object(slicedToArray.a)(_useState,2),createTokenError=_useState2[0],setCreateTokenError=_useState2[1];Object(react.useEffect)(function(){fetchProductRouteResources(accessToken)},[fetchProductRouteResources,accessToken]),Object(react.useEffect)(function(){resetCreateSubscription()},[resetCreateSubscription]);var productPlans=plansByProductId(productId),selectedPlan=productPlans.filter(function(plan){return plan.plan_id===planId})[0];selectedPlan||(selectedPlan=productPlans[0]);var onPayment=Object(react.useCallback)(function(tokenResponse,name){if(tokenResponse&&tokenResponse.token)createSubscription(accessToken,{paymentToken:tokenResponse.token.id,planId:selectedPlan.plan_id,displayName:name});else{setCreateTokenError({type:"api_error",error:!0})}},[accessToken,selectedPlan,createSubscription,setCreateTokenError]),onPaymentError=Object(react.useCallback)(function(error){error.error=!0,setCreateTokenError(error)},[setCreateTokenError]);if(customer.loading||plans.loading||profile.loading)return react_default.a.createElement(LoadingOverlay.a,{isLoading:!0});if(null!==profile.error)return react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:locationReload},react_default.a.createElement("h4",{"data-testid":"error-loading-profile"},"Problem loading profile"),react_default.a.createElement("p",null,profile.error.message));if(null!==plans.error)return react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:locationReload},react_default.a.createElement("h4",{"data-testid":"error-loading-plans"},"Problem loading plans"),react_default.a.createElement("p",null,plans.error.message));if(customer.error&&customer.error.errno!==errors.a.UNKNOWN_SUBSCRIPTION_CUSTOMER)return react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:locationReload},react_default.a.createElement("h4",{"data-testid":"error-loading-customer"},"Problem loading customer information"),react_default.a.createElement("p",null,customer.error.message));if(!selectedPlan)return react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:locationReload},react_default.a.createElement("h4",null,"Plan not found"),react_default.a.createElement("p",{"data-testid":"no-such-plan-error"},"No such plan for this product."));if(!customer.error&&!plans.error&&customerSubscriptions.some(function(customerSubscription){return productPlans.some(function(plan){return plan.plan_id===customerSubscription.plan_id})}))return react_default.a.createElement("div",{className:"product-payment"},react_default.a.createElement(routes_Product_SubscriptionRedirect,{plan:selectedPlan}));var inProgress=createSubscriptionStatus.loading||null!==createSubscriptionStatus.error;return react_default.a.createElement("div",{className:"product-payment"},null!==createSubscriptionStatus.error&&react_default.a.createElement(Product_CreateSubscriptionErrorDialog,{onDismiss:resetCreateSubscriptionError,error:createSubscriptionStatus.error}),createTokenError.error&&react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:function onDismiss(){resetCreateSubscriptionError(),setCreateTokenError({type:"",error:!1})}},react_default.a.createElement("h4",{"data-testid":"error-payment-submission"},"Payment submission failed"),react_default.a.createElement("p",null,Object(errors.b)(createTokenError.type))),profile.result&&react_default.a.createElement(react_default.a.Fragment,null,accountActivated?react_default.a.createElement(Product_AccountActivatedBanner,{profile:profile.result}):react_default.a.createElement(Product_ProfileBanner,{profile:profile.result}),react_default.a.createElement("hr",null)),react_default.a.createElement(routes_Product_PlanDetails,{plan:selectedPlan}),react_default.a.createElement("hr",null),react_default.a.createElement("h3",{className:"billing-title"},react_default.a.createElement("span",null,"Billing Information")),react_default.a.createElement(PaymentForm.a,{onPayment:onPayment,onPaymentError:onPaymentError,inProgress:inProgress,validatorInitialState:validatorInitialState,confirm:!0,plan:selectedPlan}))},Product_CreateSubscriptionErrorDialog=function CreateSubscriptionErrorDialog(_ref2){var onDismiss=_ref2.onDismiss,_ref2$error=_ref2.error,code=_ref2$error.code,message=_ref2$error.message;return"card_declined"===code?react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:onDismiss},react_default.a.createElement("h4",{"data-testid":"error-card-declined"},"Card declined"),react_default.a.createElement("p",null,message)):react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:onDismiss},react_default.a.createElement("h4",{"data-testid":"error-subscription-failed"},"Subscription failed"),react_default.a.createElement("p",null,message))},Product_ProfileBanner=function ProfileBanner(_ref3){var _ref3$profile=_ref3.profile,email=_ref3$profile.email,avatar=_ref3$profile.avatar,displayName=_ref3$profile.displayName;return react_default.a.createElement("div",{className:"profile-banner"},react_default.a.createElement("img",{className:"avatar hoisted",src:avatar,alt:displayName||email}),displayName&&react_default.a.createElement("h2",{"data-testid":"profile-display-name",className:"displayName"},displayName),react_default.a.createElement("h3",{"data-testid":"profile-email",className:"name email"},email))},Product_AccountActivatedBanner=function AccountActivatedBanner(_ref4){var _ref4$profile=_ref4.profile,email=_ref4$profile.email,displayName=_ref4$profile.displayName;return react_default.a.createElement("div",{"data-testid":"account-activated",className:"account-activated"},react_default.a.createElement("h2",null,"Your account is activated,"," ",displayName?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("span",{"data-testid":"activated-display-name",className:"displayName"},displayName)):react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("span",{"data-testid":"activated-email",className:"email"},email))))};Object(es.a)(function(state){return{customer:store.b.customer(state),customerSubscriptions:store.b.customerSubscriptions(state),profile:store.b.profile(state),plans:store.b.plans(state),createSubscriptionStatus:store.b.createSubscriptionStatus(state),plansByProductId:store.b.plansByProductId(state)}},{resetCreateSubscription:store.a.resetCreateSubscription,resetCreateSubscriptionError:store.a.resetCreateSubscription,fetchProductRouteResources:store.c.fetchProductRouteResources,createSubscription:store.c.createSubscriptionAndRefresh})(Product_Product)},28:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return SignInLayout}),__webpack_require__.d(__webpack_exports__,"a",function(){return SettingsLayout});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_lib_AppContext__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(17),AppLayout=(__webpack_require__(574),function AppLayout(_ref){var children=_ref.children,config=Object(react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_lib_AppContext__WEBPACK_IMPORTED_MODULE_1__.a).config;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{id:"stage","data-testid":"stage",className:"fade-in-forward",style:{opacity:1}},children),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("footer",{"data-testid":"footer"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{id:"about-moz-footer","data-testid":"about-moz-footer"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("a",{id:"about-mozilla",rel:"author noopener noreferrer",target:"_blank",href:"https://www.mozilla.org/about/?utm_source=firefox-accounts&utm_medium=Referral"}," ")),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{id:"legal-footer","data-testid":"legal-footer"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("a",{className:"terms",rel:"noopener noreferrer",target:"_blank",href:config.legalDocLinks.termsOfService},"Terms of Service"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("a",{className:"privacy",rel:"noopener noreferrer",target:"_blank",href:config.legalDocLinks.privacyNotice},"Privacy Notice"))))}),SignInLayout=function SignInLayout(_ref2){var children=_ref2.children;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(AppLayout,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"sign-in"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{id:"main-content",className:"card payments-card"},children))))},SettingsLayout=function SettingsLayout(_ref3){var children=_ref3.children;Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(function(){return document.body.classList.add("settings"),function(){return document.body.classList.remove("settings")}},[children]);var config=Object(react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_lib_AppContext__WEBPACK_IMPORTED_MODULE_1__.a).config,homeURL="".concat(config.servers.content.url,"/settings"),breadcrumbs=react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("ol",{className:"breadcrumbs","data-testid":"breadcrumbs"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("li",null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("a",{href:homeURL},"Account Home")),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("li",null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("a",{href:"/subscriptions"},"Subscriptions")));return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(AppLayout,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"settings"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{id:"fxa-settings-header-wrapper"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("header",{id:"fxa-settings-header"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h1",{id:"fxa-manage-account"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{className:"fxa-account-title"},"Firefox Accounts"))),breadcrumbs),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{id:"fxa-settings"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{id:"fxa-settings-content",className:"card"},children))))}},282:function(module,exports,__webpack_require__){__webpack_require__(283),__webpack_require__(386),module.exports=__webpack_require__(387)},387:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _storybook_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(11),reqFromComponents=(__webpack_require__(547),__webpack_require__(548),__webpack_require__(549),__webpack_require__(550)),reqFromRoutes=__webpack_require__(586);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.configure)(function loadStories(){[reqFromComponents,reqFromRoutes].forEach(function(req){return req.keys().forEach(function(filename){return req(filename)})})},module)}.call(this,__webpack_require__(44)(module))},5:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return selectors}),__webpack_require__.d(__webpack_exports__,"a",function(){return actions}),__webpack_require__.d(__webpack_exports__,"c",function(){return thunks});__webpack_require__(277);var _typeToReducer,_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(12),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(6),redux_actions__WEBPACK_IMPORTED_MODULE_7__=(__webpack_require__(69),__webpack_require__(272),__webpack_require__(595)),type_to_reducer__WEBPACK_IMPORTED_MODULE_10__=(__webpack_require__(273),__webpack_require__(86),__webpack_require__(274)),type_to_reducer__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(type_to_reducer__WEBPACK_IMPORTED_MODULE_10__),_lib_config__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(21),_utils__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(1);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach(function(key){Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__.a)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}var _reactivateSubscription,defaultState={api:{cancelSubscription:Object(_utils__WEBPACK_IMPORTED_MODULE_12__.e)(null),reactivateSubscription:Object(_utils__WEBPACK_IMPORTED_MODULE_12__.e)(null),createSubscription:Object(_utils__WEBPACK_IMPORTED_MODULE_12__.e)(null),customer:Object(_utils__WEBPACK_IMPORTED_MODULE_12__.e)(null),plans:Object(_utils__WEBPACK_IMPORTED_MODULE_12__.e)(null),profile:Object(_utils__WEBPACK_IMPORTED_MODULE_12__.e)(null),updatePayment:Object(_utils__WEBPACK_IMPORTED_MODULE_12__.e)(null),subscriptions:Object(_utils__WEBPACK_IMPORTED_MODULE_12__.e)(null),token:Object(_utils__WEBPACK_IMPORTED_MODULE_12__.e)(null)}},selectors={profile:function profile(state){return state.api.profile},token:function token(state){return state.api.token},subscriptions:function subscriptions(state){return state.api.subscriptions},plans:function plans(state){return state.api.plans},customer:function customer(state){return state.api.customer},createSubscriptionStatus:function createSubscriptionStatus(state){return state.api.createSubscription},cancelSubscriptionStatus:function cancelSubscriptionStatus(state){return state.api.cancelSubscription},reactivateSubscriptionStatus:function reactivateSubscriptionStatus(state){return state.api.reactivateSubscription},updatePaymentStatus:function updatePaymentStatus(state){return state.api.updatePayment},lastError:function lastError(state){return Object.entries(state.api).filter(function(_ref){var _ref2=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_4__.a)(_ref,2),v=(_ref2[0],_ref2[1]);return v&&!!v.error}).map(function(_ref3){var _ref4=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_4__.a)(_ref3,2);return[_ref4[0],_ref4[1].error]})[0]},isLoading:function isLoading(state){return Object.values(state.api).some(function(v){return v&&!!v.loading})},plansByProductId:function plansByProductId(state){return function(productId){var plans=selectors.plans(state).result||[];return productId?plans.filter(function(plan){return plan.product_id===productId}):plans}},customerSubscriptions:function customerSubscriptions(state){var customer=selectors.customer(state);return customer&&customer.result&&customer.result.subscriptions?customer.result.subscriptions:[]}},actions=Object(redux_actions__WEBPACK_IMPORTED_MODULE_7__.a)({fetchProfile:function fetchProfile(accessToken){return Object(_utils__WEBPACK_IMPORTED_MODULE_12__.c)(accessToken,"".concat(_lib_config__WEBPACK_IMPORTED_MODULE_11__.a.servers.profile.url,"/v1/profile"))},fetchPlans:function fetchPlans(accessToken){return Object(_utils__WEBPACK_IMPORTED_MODULE_12__.c)(accessToken,"".concat(_lib_config__WEBPACK_IMPORTED_MODULE_11__.a.servers.auth.url,"/v1/oauth/subscriptions/plans"))},fetchSubscriptions:function fetchSubscriptions(accessToken){return Object(_utils__WEBPACK_IMPORTED_MODULE_12__.c)(accessToken,"".concat(_lib_config__WEBPACK_IMPORTED_MODULE_11__.a.servers.auth.url,"/v1/oauth/subscriptions/active"))},fetchToken:function fetchToken(accessToken){return Object(_utils__WEBPACK_IMPORTED_MODULE_12__.d)(accessToken,"".concat(_lib_config__WEBPACK_IMPORTED_MODULE_11__.a.servers.oauth.url,"/v1/introspect"),{token:accessToken})},fetchCustomer:function fetchCustomer(accessToken){return Object(_utils__WEBPACK_IMPORTED_MODULE_12__.c)(accessToken,"".concat(_lib_config__WEBPACK_IMPORTED_MODULE_11__.a.servers.auth.url,"/v1/oauth/subscriptions/customer"))},createSubscription:function createSubscription(accessToken,params){return Object(_utils__WEBPACK_IMPORTED_MODULE_12__.d)(accessToken,"".concat(_lib_config__WEBPACK_IMPORTED_MODULE_11__.a.servers.auth.url,"/v1/oauth/subscriptions/active"),params)},cancelSubscription:function cancelSubscription(accessToken,subscriptionId){return Object(_utils__WEBPACK_IMPORTED_MODULE_12__.b)(accessToken,"".concat(_lib_config__WEBPACK_IMPORTED_MODULE_11__.a.servers.auth.url,"/v1/oauth/subscriptions/active/").concat(subscriptionId)).then(function(result){return _objectSpread({},result,{subscriptionId:subscriptionId})})},reactivateSubscription:(_reactivateSubscription=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee(accessToken,subscriptionId){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",Object(_utils__WEBPACK_IMPORTED_MODULE_12__.d)(accessToken,"".concat(_lib_config__WEBPACK_IMPORTED_MODULE_11__.a.servers.auth.url,"/v1/oauth/subscriptions/reactivate"),{subscriptionId:subscriptionId}));case 1:case"end":return _context.stop()}},_callee)})),function reactivateSubscription(_x,_x2){return _reactivateSubscription.apply(this,arguments)}),updatePayment:function updatePayment(accessToken,_ref5){var paymentToken=_ref5.paymentToken;return Object(_utils__WEBPACK_IMPORTED_MODULE_12__.d)(accessToken,"".concat(_lib_config__WEBPACK_IMPORTED_MODULE_11__.a.servers.auth.url,"/v1/oauth/subscriptions/updatePayment"),{paymentToken:paymentToken})}},"updateApiData","resetCreateSubscription","resetCancelSubscription","resetReactivateSubscription","resetUpdatePayment"),handleThunkError=function handleThunkError(err){},thunks={fetchProductRouteResources:function fetchProductRouteResources(accessToken){return function(){var _ref6=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee2(dispatch){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,Promise.all([dispatch(actions.fetchPlans(accessToken)),dispatch(actions.fetchProfile(accessToken)),dispatch(actions.fetchCustomer(accessToken)),dispatch(actions.fetchSubscriptions(accessToken))]).catch(handleThunkError);case 2:case"end":return _context2.stop()}},_callee2)}));return function(_x3){return _ref6.apply(this,arguments)}}()},fetchSubscriptionsRouteResources:function fetchSubscriptionsRouteResources(accessToken){return function(){var _ref7=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee3(dispatch){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,Promise.all([dispatch(actions.fetchPlans(accessToken)),dispatch(actions.fetchProfile(accessToken)),dispatch(actions.fetchCustomer(accessToken)),dispatch(actions.fetchSubscriptions(accessToken))]).catch(handleThunkError);case 2:case"end":return _context3.stop()}},_callee3)}));return function(_x4){return _ref7.apply(this,arguments)}}()},fetchCustomerAndSubscriptions:function fetchCustomerAndSubscriptions(accessToken){return function(){var _ref8=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee4(dispatch){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,Promise.all([dispatch(actions.fetchCustomer(accessToken)),dispatch(actions.fetchSubscriptions(accessToken))]).catch(handleThunkError);case 2:case"end":return _context4.stop()}},_callee4)}));return function(_x5){return _ref8.apply(this,arguments)}}()},createSubscriptionAndRefresh:function createSubscriptionAndRefresh(accessToken,params){return function(){var _ref9=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee5(dispatch){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.prev=0,_context5.next=3,dispatch(actions.createSubscription(accessToken,params));case 3:return _context5.next=5,dispatch(thunks.fetchCustomerAndSubscriptions(accessToken));case 5:_context5.next=10;break;case 7:_context5.prev=7,_context5.t0=_context5.catch(0),_context5.t0;case 10:case"end":return _context5.stop()}},_callee5,null,[[0,7]])}));return function(_x6){return _ref9.apply(this,arguments)}}()},cancelSubscriptionAndRefresh:function cancelSubscriptionAndRefresh(accessToken,subscriptionId){return function(){var _ref10=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee6(dispatch,getState){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.prev=0,_context6.next=3,dispatch(actions.cancelSubscription(accessToken,subscriptionId));case 3:return _context6.next=5,dispatch(thunks.fetchCustomerAndSubscriptions(accessToken));case 5:_context6.next=10;break;case 7:_context6.prev=7,_context6.t0=_context6.catch(0),_context6.t0;case 10:case"end":return _context6.stop()}},_callee6,null,[[0,7]])}));return function(_x7,_x8){return _ref10.apply(this,arguments)}}()},reactivateSubscriptionAndRefresh:function reactivateSubscriptionAndRefresh(accessToken,subscriptionId){return function(){var _ref11=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee7(dispatch,getState){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.prev=0,_context7.next=3,dispatch(actions.reactivateSubscription(accessToken,subscriptionId));case 3:return _context7.next=5,dispatch(thunks.fetchCustomerAndSubscriptions(accessToken));case 5:_context7.next=10;break;case 7:_context7.prev=7,_context7.t0=_context7.catch(0),_context7.t0;case 10:case"end":return _context7.stop()}},_callee7,null,[[0,7]])}));return function(_x9,_x10){return _ref11.apply(this,arguments)}}()},updatePaymentAndRefresh:function updatePaymentAndRefresh(accessToken,params){return function(){var _ref12=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee8(dispatch){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.prev=0,_context8.next=3,dispatch(actions.updatePayment(accessToken,params));case 3:return _context8.next=5,dispatch(thunks.fetchCustomerAndSubscriptions(accessToken));case 5:setTimeout(function(){return dispatch(actions.resetUpdatePayment())},2e3),_context8.next=11;break;case 8:_context8.prev=8,_context8.t0=_context8.catch(0),_context8.t0;case 11:case"end":return _context8.stop()}},_callee8,null,[[0,8]])}));return function(_x11){return _ref12.apply(this,arguments)}}()}};type_to_reducer__WEBPACK_IMPORTED_MODULE_10___default()((_typeToReducer={},Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__.a)(_typeToReducer,actions.fetchProfile.toString(),Object(_utils__WEBPACK_IMPORTED_MODULE_12__.f)("profile")),Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__.a)(_typeToReducer,actions.fetchPlans.toString(),Object(_utils__WEBPACK_IMPORTED_MODULE_12__.f)("plans")),Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__.a)(_typeToReducer,actions.fetchSubscriptions.toString(),Object(_utils__WEBPACK_IMPORTED_MODULE_12__.f)("subscriptions")),Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__.a)(_typeToReducer,actions.fetchToken.toString(),Object(_utils__WEBPACK_IMPORTED_MODULE_12__.f)("token")),Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__.a)(_typeToReducer,actions.fetchCustomer.toString(),Object(_utils__WEBPACK_IMPORTED_MODULE_12__.f)("customer")),Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__.a)(_typeToReducer,actions.createSubscription.toString(),Object(_utils__WEBPACK_IMPORTED_MODULE_12__.f)("createSubscription")),Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__.a)(_typeToReducer,actions.cancelSubscription.toString(),Object(_utils__WEBPACK_IMPORTED_MODULE_12__.f)("cancelSubscription")),Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__.a)(_typeToReducer,actions.reactivateSubscription.toString(),Object(_utils__WEBPACK_IMPORTED_MODULE_12__.f)("reactivateSubscription")),Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__.a)(_typeToReducer,actions.updatePayment.toString(),Object(_utils__WEBPACK_IMPORTED_MODULE_12__.f)("updatePayment")),Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__.a)(_typeToReducer,actions.updateApiData.toString(),function(state,_ref13){return _objectSpread({},state,{},_ref13.payload)}),Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__.a)(_typeToReducer,actions.resetCreateSubscription.toString(),Object(_utils__WEBPACK_IMPORTED_MODULE_12__.h)({createSubscription:Object(_utils__WEBPACK_IMPORTED_MODULE_12__.e)(null)})),Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__.a)(_typeToReducer,actions.resetCancelSubscription.toString(),Object(_utils__WEBPACK_IMPORTED_MODULE_12__.h)({cancelSubscription:Object(_utils__WEBPACK_IMPORTED_MODULE_12__.e)(null)})),Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__.a)(_typeToReducer,actions.resetReactivateSubscription.toString(),Object(_utils__WEBPACK_IMPORTED_MODULE_12__.h)({reactivateSubscription:Object(_utils__WEBPACK_IMPORTED_MODULE_12__.e)(null)})),Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__.a)(_typeToReducer,actions.resetUpdatePayment.toString(),Object(_utils__WEBPACK_IMPORTED_MODULE_12__.h)({updatePayment:Object(_utils__WEBPACK_IMPORTED_MODULE_12__.e)(null)})),_typeToReducer),defaultState.api)},547:function(module,exports,__webpack_require__){},548:function(module,exports,__webpack_require__){},549:function(module,exports,__webpack_require__){},55:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return useBooleanState}),__webpack_require__.d(__webpack_exports__,"b",function(){return useCheckboxState}),__webpack_require__.d(__webpack_exports__,"c",function(){return useClickOutsideEffect});var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0);function useBooleanState(){var defaultState=arguments.length>0&&void 0!==arguments[0]&&arguments[0],_useState=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(defaultState),_useState2=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useState,2),state=_useState2[0],setState=_useState2[1];return[state,Object(react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(function(){return setState(!0)},[setState]),Object(react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(function(){return setState(!1)},[setState])]}function useCheckboxState(){var defaultState=arguments.length>0&&void 0!==arguments[0]&&arguments[0],_useState3=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(defaultState),_useState4=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useState3,2),state=_useState4[0],setState=_useState4[1];return[state,Object(react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(function(ev){return setState(ev.target.checked)},[setState])]}function useClickOutsideEffect(onClickOutside){var insideEl=Object(react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);return Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(function(){var onBodyClick=function onBodyClick(ev){insideEl.current instanceof HTMLElement&&ev.target instanceof HTMLElement&&!insideEl.current.contains(ev.target)&&onClickOutside()};return document.body.addEventListener("click",onBodyClick),function(){return document.body.removeEventListener("click",onBodyClick)}},[onClickOutside]),insideEl}},550:function(module,exports,__webpack_require__){var map={"./AlertBar.stories.tsx":551,"./AppLayout/index.stories.tsx":554,"./DialogMessage.stories.tsx":575,"./LoadingOverlay.stories.tsx":577,"./PaymentForm/index.stories.tsx":583,"./Tooltip.stories.tsx":585};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=550},551:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_storybook_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(11),_AlertBar__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(108);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_1__.storiesOf)("components/AlertBar",module).add("basic",function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_AlertBar__WEBPACK_IMPORTED_MODULE_2__.a,{className:"alert"},"This is an alert.")})}.call(this,__webpack_require__(44)(module))},552:function(module,exports,__webpack_require__){},553:function(module,exports,__webpack_require__){},554:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_storybook_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(11),_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(18),_index__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(28);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_1__.storiesOf)("components/AppLayout",module).add("Settings layout",function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_2__.a,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_index__WEBPACK_IMPORTED_MODULE_3__.a,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",{style:{padding:"0 2em 4em 2em"}},"App contents go here")))}).add("Sign-in layout",function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_2__.a,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_index__WEBPACK_IMPORTED_MODULE_3__.b,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",null,"App contents go here")))})}.call(this,__webpack_require__(44)(module))},574:function(module,exports,__webpack_require__){},575:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_storybook_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(11),_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(18),_storybook_components_LoremIpsum__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(270),_lib_hooks__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(55),_AppLayout__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(28),_DialogMessage__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(7);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_2__.storiesOf)("components/DialogMessage",module).add("basic",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(MockPage,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(DialogToggle,null,function(_ref){var dialogShown=_ref.dialogShown,hideDialog=_ref.hideDialog;return dialogShown&&react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_DialogMessage__WEBPACK_IMPORTED_MODULE_7__.a,{onDismiss:hideDialog},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("h4",null,"This is a basic dialog"),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("p",null,"Content goes in here."))}))}).add("error",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(MockPage,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(DialogToggle,null,function(_ref2){var dialogShown=_ref2.dialogShown,hideDialog=_ref2.hideDialog;return dialogShown&&react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_DialogMessage__WEBPACK_IMPORTED_MODULE_7__.a,{className:"dialog-error",onDismiss:hideDialog},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("h4",null,"This is an error dialog"),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("p",null,"Content goes in here."))}))});var MockPage=function MockPage(_ref3){var children=_ref3.children;return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_3__.a,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_AppLayout__WEBPACK_IMPORTED_MODULE_6__.b,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("h2",null,"This is some sample content"),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("p",null,"App content goes here, underneath the dialog."),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_storybook_components_LoremIpsum__WEBPACK_IMPORTED_MODULE_4__.a,null),children))},DialogToggle=function DialogToggle(_ref4){var children=_ref4.children,_useBooleanState=Object(_lib_hooks__WEBPACK_IMPORTED_MODULE_5__.a)(!0),_useBooleanState2=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useBooleanState,3),dialogShown=_useBooleanState2[0],showDialog=_useBooleanState2[1],hideDialog=_useBooleanState2[2],onClick=Object(react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(function(ev){ev.preventDefault(),showDialog()},[showDialog]);return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{className:"dialog-toggle"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("button",{onClick:onClick},"Show dialog"),children({dialogShown:dialogShown,showDialog:showDialog,hideDialog:hideDialog}))}}.call(this,__webpack_require__(44)(module))},576:function(module,exports,__webpack_require__){},577:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_storybook_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(11),_LoadingOverlay__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(81);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_1__.storiesOf)("components/LoadingOverlay",module).add("isLoading = true",function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_LoadingOverlay__WEBPACK_IMPORTED_MODULE_2__.a,{isLoading:!0})})}.call(this,__webpack_require__(44)(module))},582:function(module,exports,__webpack_require__){},583:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_storybook_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(11),_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(20),_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(18),_AppLayout__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(28),_index__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(85);var PLAN={plan_id:"plan_123",plan_name:"Example Plan",product_id:"product_8675309",product_name:"Example Product",currency:"USD",amount:1099,interval:"month"},Subject=function Subject(_ref){var _ref$inProgress=_ref.inProgress,inProgress=void 0!==_ref$inProgress&&_ref$inProgress,_ref$confirm=_ref.confirm,confirm=void 0===_ref$confirm||_ref$confirm,_ref$plan=_ref.plan,plan=void 0===_ref$plan?PLAN:_ref$plan,_ref$onPayment=_ref.onPayment,onPayment=void 0===_ref$onPayment?Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_2__.action)("onPayment"):_ref$onPayment,_ref$onPaymentError=_ref.onPaymentError,paymentFormProps={inProgress:inProgress,confirm:confirm,plan:plan,onPayment:onPayment,onPaymentError:void 0===_ref$onPaymentError?Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_2__.action)("onPaymentError"):_ref$onPaymentError,validatorInitialState:_ref.validatorInitialState,validatorMiddlewareReducer:_ref.validatorMiddlewareReducer};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(MockPage,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_index__WEBPACK_IMPORTED_MODULE_5__.a,paymentFormProps))},MockPage=function MockPage(_ref2){var children=_ref2.children;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_3__.a,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_AppLayout__WEBPACK_IMPORTED_MODULE_4__.b,null,children))},mockValidatorState=function mockValidatorState(){return{error:null,fields:{name:{value:null,valid:null,error:null,fieldType:"input",required:!0},zip:{value:null,valid:null,error:null,fieldType:"input",required:!0},creditCardNumber:{value:null,valid:null,error:null,fieldType:"stripe",required:!0},expDate:{value:null,valid:null,error:null,fieldType:"stripe",required:!0},cvc:{value:null,valid:null,error:null,fieldType:"stripe",required:!0},confirm:{value:null,valid:null,error:null,fieldType:"input",required:!0},submit:{value:null,valid:null,error:null,fieldType:"input",required:!1}}}};!function init(){Object(_storybook_react__WEBPACK_IMPORTED_MODULE_1__.storiesOf)("components/PaymentForm",module).add("default",function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Subject,null)}).add("in progress",function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Subject,{inProgress:!0})}).add("all invalid",function(){var state=mockValidatorState();return state.fields.name.valid=!1,state.fields.name.error="Please enter your name",state.fields.zip.valid=!1,state.fields.zip.error="Zip code is too short",state.fields.creditCardNumber.valid=!1,state.fields.creditCardNumber.error="Your card number is incomplete",state.fields.expDate.valid=!1,state.fields.expDate.error="Your card's expiration date is incomplete",state.fields.cvc.valid=!1,state.fields.cvc.error="Your card's security code is incomplete",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Subject,{validatorInitialState:state})})}()}.call(this,__webpack_require__(44)(module))},584:function(module,exports,__webpack_require__){},585:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__),_storybook_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(11),_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(18),_lib_screen_info__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(79),_AppLayout__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(28),_Tooltip__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(138);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}var Field=function Field(_ref){var children=_ref.children,_ref$message=_ref.message,message=void 0===_ref$message?"Valid email required":_ref$message,_ref$showTooltip=_ref.showTooltip,showTooltip=void 0===_ref$showTooltip||_ref$showTooltip,_ref$dismissible=_ref.dismissible,dismissible=void 0!==_ref$dismissible&&_ref$dismissible,_ref$onDismiss=_ref.onDismiss,onDismiss=void 0===_ref$onDismiss?function(){}:_ref$onDismiss,_ref$onFocus=_ref.onFocus,onFocus=void 0===_ref$onFocus?function(){}:_ref$onFocus,_ref$showBelow=_ref.showBelow,showBelow=void 0===_ref$showBelow?void 0:_ref$showBelow,_ref$clientHeight=_ref.clientHeight,clientHeight=void 0===_ref$clientHeight?void 0:_ref$clientHeight,_ref$extraClassNames=_ref.extraClassNames,extraClassNames=void 0===_ref$extraClassNames?"tooltip-error":_ref$extraClassNames,screenInfo=new _lib_screen_info__WEBPACK_IMPORTED_MODULE_5__.a(window);void 0!==clientHeight&&(screenInfo.clientHeight=clientHeight);var parentRef=Object(react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div",{className:"input-row"},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("label",null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("span",{className:"label-text"},children),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("input",{ref:parentRef,onFocus:onFocus,name:"name",type:"text",className:"name tooltip-below invalid",defaultValue:"",required:!0,autoFocus:!0,"aria-invalid":"true"}),showTooltip&&react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_Tooltip__WEBPACK_IMPORTED_MODULE_7__.a,{parentRef:parentRef,showBelow:showBelow,dismissible:dismissible,onDismiss:onDismiss,extraClassNames:extraClassNames,screenInfo:screenInfo},message)))},FieldWithDismissible=function FieldWithDismissible(props){var _useState=Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(!0),_useState2=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(_useState,2),showTooltip=_useState2[0],setShowTooltip=_useState2[1],onFocus=Object(react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(function(){return setShowTooltip(!0)},[setShowTooltip]),onDismiss=Object(react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(function(ev){ev.preventDefault(),setShowTooltip(!1)},[setShowTooltip]);return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach(function(key){Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}({},props,{showTooltip:showTooltip,onFocus:onFocus,onDismiss:onDismiss}))},MockPage=function MockPage(_ref2){var children=_ref2.children;return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_4__.a,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_AppLayout__WEBPACK_IMPORTED_MODULE_6__.b,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("form",{className:"payment"},children)))};!function init(){Object(_storybook_react__WEBPACK_IMPORTED_MODULE_3__.storiesOf)("components/Tooltip",module).add("default",function(){return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(MockPage,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,null,"default"))}).add("dismissible",function(){return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(MockPage,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(FieldWithDismissible,{message:react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_2___default.a.Fragment,null,"Did you mean ",react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("a",{href:"https://mozilla.org"},"mozilla.org"),"?"),extraClassNames:"tooltip-error tooltip-suggest",dismissible:!0},"dismissible = true"))}).add("showBelow",function(){return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(MockPage,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,{showBelow:!1},"showBelow = false"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,{showBelow:!0},"showBelow default"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,{showBelow:!0},"showBelow = true"))}).add("clientHeight",function(){return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(MockPage,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,{clientHeight:300},"clientHeight = 300"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,{showBelow:!1,clientHeight:300},"clientHeight = 300, showBelow = false"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,{clientHeight:1e3},"clientHeight = 1000"))})}()}.call(this,__webpack_require__(44)(module))},586:function(module,exports,__webpack_require__){var map={"./Product/index.stories.tsx":587,"./Subscriptions/index.stories.tsx":592};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=586},587:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_storybook_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(11),_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(20),_storybook_addon_links__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(47),_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(18),_store_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(1),_components_AppLayout__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(28),_index__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(279);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach(function(key){Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}var ProductRoute=function ProductRoute(_ref){var _ref$routeProps=_ref.routeProps,routeProps=void 0===_ref$routeProps?MOCK_PROPS:_ref$routeProps,_ref$queryParams=_ref.queryParams,queryParams=void 0===_ref$queryParams?_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_5__.b.queryParams:_ref$queryParams,applyStubsToStripe=_ref.applyStubsToStripe;return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_5__.a,{applyStubsToStripe:applyStubsToStripe,appContextValue:_objectSpread({},_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_5__.b,{queryParams:queryParams})},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_components_AppLayout__WEBPACK_IMPORTED_MODULE_7__.b,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_index__WEBPACK_IMPORTED_MODULE_8__.a,routeProps)))},PLANS=[{plan_id:"plan_123",plan_name:"Example Plan",product_id:"product_8675309",product_name:"Example Product",currency:"USD",amount:1050,interval:"month"}],linkToSubscriptionSuccess=Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_4__.linkTo)("routes/Product","subscription success"),MOCK_PROPS={match:{params:{productId:"product_8675309"}},profile:{error:null,loading:!1,result:{amrValues:[],avatar:"http://placekitten.com/256/256",avatarDefault:!1,displayName:"Foo Barson",email:"foo@example.com",locale:"en-US",twoFactorAuthentication:!0,uid:"8675309asdf"}},plans:{error:null,loading:!1,result:PLANS},createSubscriptionStatus:{error:null,loading:!1,result:null},customer:{error:null,loading:!1,result:null},customerSubscriptions:[],plansByProductId:function plansByProductId(_){return PLANS},createSubscription:linkToSubscriptionSuccess,resetCreateSubscription:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("resetCreateSubscription"),resetCreateSubscriptionError:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("resetCreateSubscriptionError"),fetchProductRouteResources:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("fetchProductRouteResources")},FAILURE_PROPS=_objectSpread({},MOCK_PROPS,{resetCreateSubscriptionError:Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_4__.linkTo)("routes/Product","subscribing with existing account")}),mkValidPaymentFormState=function mkValidPaymentFormState(){return{error:null,fields:{name:{value:"Foo Barson",valid:!0,error:null,fieldType:"input",required:!0},zip:{value:"90210",valid:!0,error:null,fieldType:"input",required:!0},creditCardNumber:{value:!0,valid:null,error:null,fieldType:"stripe",required:!0},expDate:{value:!0,valid:null,error:null,fieldType:"stripe",required:!0},cvc:{value:!0,valid:null,error:null,fieldType:"stripe",required:!0},confirm:{value:!0,valid:!0,error:null,fieldType:"input",required:!0},submit:{value:null,valid:null,error:null,fieldType:"input",required:!1}}}};!function init(){Object(_storybook_react__WEBPACK_IMPORTED_MODULE_2__.storiesOf)("routes/Product",module).add("subscribing with existing account",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,null)}).add("subscribing with new account",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{queryParams:{activated:"1"}})}).add("success",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},MOCK_PROPS,{customerSubscriptions:[{current_period_end:(Date.now()+86400)/1e3,current_period_start:(Date.now()-86400)/1e3,cancel_at_period_end:!1,end_at:null,nickname:"Example Plan",plan_id:"plan_123",status:"active",subscription_id:"sk_78987"}]})})}),Object(_storybook_react__WEBPACK_IMPORTED_MODULE_2__.storiesOf)("routes/Product/page load",module).add("profile loading",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},MOCK_PROPS,{profile:{loading:!0,error:null,result:null}})})}).add("profile error",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},MOCK_PROPS,{profile:{loading:!1,result:null,error:new _store_utils__WEBPACK_IMPORTED_MODULE_6__.a({statusCode:500,message:"Internal Server Error"})}})})}).add("customer loading",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},MOCK_PROPS,{customer:{loading:!0,error:null,result:null}})})}).add("customer error",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},MOCK_PROPS,{customer:{loading:!1,result:null,error:new _store_utils__WEBPACK_IMPORTED_MODULE_6__.a({statusCode:500,message:"Internal Server Error"})}})})}).add("plans loading",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},MOCK_PROPS,{plans:{loading:!0,error:null,result:null}})})}).add("plans error",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},MOCK_PROPS,{plans:{loading:!1,result:null,error:new _store_utils__WEBPACK_IMPORTED_MODULE_6__.a({statusCode:500,message:"Internal Server Error"})}})})}),Object(_storybook_react__WEBPACK_IMPORTED_MODULE_2__.storiesOf)("routes/Product/payment failures",module).add("card declined",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},FAILURE_PROPS,{createSubscriptionStatus:{result:null,loading:!1,error:{code:"expired_card",message:"Your card has expired.",errno:181,error:"Bad Request",info:"https://github.com/mozilla/fxa/blob/master/packages/fxa-auth-server/docs/api.md#response-format",statusCode:402}}})})}).add("miscellaneous",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},FAILURE_PROPS,{createSubscriptionStatus:{result:null,loading:!1,error:{code:"",message:"Payment server request failed."}}})})}).add("stripe.createToken() fails on submit",function(){var validatorInitialState=mkValidPaymentFormState();return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{applyStubsToStripe:function applyStubsToStripe(stripe){return stripe.createToken=function(element){return Promise.reject({type:"api_error",message:"The Stripe system is down."})},stripe},routeProps:_objectSpread({},MOCK_PROPS,{validatorInitialState:validatorInitialState})})})}()}.call(this,__webpack_require__(44)(module))},589:function(module,exports,__webpack_require__){},590:function(module,exports,__webpack_require__){},591:function(module,exports,__webpack_require__){},592:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_storybook_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(11),_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(20),_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(18),_components_AppLayout__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(28),_index__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(278),_store_utils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1),_storybook_addon_links__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(47);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach(function(key){Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}var errorFetchState=function errorFetchState(){return{loading:!1,result:null,error:new _store_utils__WEBPACK_IMPORTED_MODULE_7__.a({statusCode:500,message:"Internal Server Error"})}},SubscriptionsRoute=function SubscriptionsRoute(_ref){var _ref$routeProps=_ref.routeProps,routeProps=void 0===_ref$routeProps?baseProps:_ref$routeProps,_ref$queryParams=_ref.queryParams,queryParams=void 0===_ref$queryParams?_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_4__.b.queryParams:_ref$queryParams,applyStubsToStripe=_ref.applyStubsToStripe;return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_4__.a,{applyStubsToStripe:applyStubsToStripe,appContextValue:_objectSpread({},_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_4__.b,{queryParams:queryParams})},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_components_AppLayout__WEBPACK_IMPORTED_MODULE_5__.a,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_index__WEBPACK_IMPORTED_MODULE_6__.a,routeProps)))},baseProps={profile:{error:null,loading:!1,result:{amrValues:[],avatar:"http://placekitten.com/256/256",avatarDefault:!1,displayName:"Foo Barson",email:"foo@example.com",locale:"en-US",twoFactorAuthentication:!0,uid:"8675309asdf"}},plans:{error:null,loading:!1,result:[{plan_id:"plan_123",plan_name:"Example Plan",product_id:"product_8675309",product_name:"Example Product",currency:"USD",amount:1099,interval:"month"}]},customer:{error:null,loading:!1,result:null},subscriptions:{error:null,loading:!1,result:null},customerSubscriptions:[],fetchSubscriptionsRouteResources:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("fetchSubscriptionsRouteResources"),cancelSubscription:Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_8__.linkTo)("routes/Subscriptions","cancelled"),reactivateSubscription:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("reactivateSubscription"),resetUpdatePayment:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("resetUpdatePayment"),resetCancelSubscription:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("resetCancelSubscription"),resetReactivateSubscription:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("resetReactivateSubscription"),updatePayment:Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_8__.linkTo)("routes/Subscriptions","updated payment"),updatePaymentStatus:{error:null,loading:!1,result:null},cancelSubscriptionStatus:{error:null,loading:!1,result:null},reactivateSubscriptionStatus:{error:null,loading:!1,result:null}},subscribedProps=_objectSpread({},baseProps,{customer:{loading:!1,error:null,result:{payment_type:"card",last4:"8675",exp_month:"12",exp_year:"2028",subscriptions:[]}},customerSubscriptions:[{current_period_end:(Date.now()+86400)/1e3,current_period_start:(Date.now()-86400)/1e3,cancel_at_period_end:!1,end_at:null,nickname:"Example Plan",plan_id:"plan_123",status:"active",subscription_id:"sub_5551212"}],subscriptions:{loading:!1,error:null,result:[{subscriptionId:"sub_5551212",productId:"product_123",createdAt:Date.now(),cancelledAt:null}]}}),cancelledProps=_objectSpread({},subscribedProps,{customerSubscriptions:[_objectSpread({},subscribedProps.customerSubscriptions[0],{cancel_at_period_end:!0})],subscriptions:{loading:!1,error:null,result:[{subscriptionId:"sub_5551212",productId:"product_123",createdAt:Date.now()-4e8,cancelledAt:Date.now()-2e8}]}}),reactivationErrorProps=_objectSpread({},cancelledProps,{reactivateSubscriptionStatus:{loading:!1,result:!1,error:new _store_utils__WEBPACK_IMPORTED_MODULE_7__.a({statusCode:500,message:"reactivateSubscription API not implemented"})}});!function init(){Object(_storybook_react__WEBPACK_IMPORTED_MODULE_2__.storiesOf)("routes/Subscriptions",module).add("loading",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},baseProps,{subscriptions:{loading:!0,error:!1,result:null}})})}).add("no subscription",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,null)}).add("subscribed",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},subscribedProps)})}).add("updated payment",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},subscribedProps,{updatePaymentStatus:{loading:!1,error:null,result:!0}})})}).add("cancelled",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},cancelledProps,{resetCancelSubscription:Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_8__.linkTo)("routes/Subscriptions","reactivation"),cancelSubscriptionStatus:{loading:!1,error:!1,result:{subscriptionId:"sub_5551212",productId:"product_123",createdAt:Date.now()-864e5,cancelledAt:Date.now()}}})})}).add("reactivation",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},cancelledProps,{reactivateSubscription:Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_8__.linkTo)("routes/Subscriptions","subscribed")})})}),Object(_storybook_react__WEBPACK_IMPORTED_MODULE_2__.storiesOf)("routes/Subscriptions/errors",module).add("profile",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},baseProps,{profile:errorFetchState()})})}).add("plans",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},baseProps,{plans:errorFetchState()})})}).add("subscriptions",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},baseProps,{subscriptions:errorFetchState()})})}).add("payment update",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},subscribedProps,{updatePaymentStatus:{loading:!1,result:null,error:new _store_utils__WEBPACK_IMPORTED_MODULE_7__.a({code:"expired_card",message:"Your card has expired.",errno:181,error:"Bad Request",info:"https://github.com/mozilla/fxa/blob/master/packages/fxa-auth-server/docs/api.md#response-format"})},resetUpdatePayment:Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_8__.linkTo)("routes/Subscriptions","subscribed")})})}).add("reactivation",function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},reactivationErrorProps,{reactivateSubscriptionStatus:errorFetchState(),resetReactivateSubscription:Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_8__.linkTo)("routes/Subscriptions","reactivation")})})})}()}.call(this,__webpack_require__(44)(module))},593:function(module,exports,__webpack_require__){},7:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return DialogMessage});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(68),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_lib_hooks__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(55),_Portal__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(136),DialogMessage=(__webpack_require__(576),function DialogMessage(_ref){var _ref$className=_ref.className,className=void 0===_ref$className?"":_ref$className,onDismiss=_ref.onDismiss,children=_ref.children,dialogInsideRef=Object(_lib_hooks__WEBPACK_IMPORTED_MODULE_2__.c)(onDismiss);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_Portal__WEBPACK_IMPORTED_MODULE_3__.a,{id:"dialogs"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{"data-testid":"dialog-message-container",className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("blocker","current")},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{"data-testid":"dialog-message-content",className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("modal",className),ref:dialogInsideRef},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("button",{"data-testid":"dialog-dismiss",className:"dismiss",onClick:onDismiss},"✕"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"message"},children))))});__webpack_exports__.b=DialogMessage},70:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return AuthServerErrno}),__webpack_require__.d(__webpack_exports__,"b",function(){return getErrorMessage});var AuthServerErrno={UNKNOWN_SUBSCRIPTION_CUSTOMER:176,UNKNOWN_SUBSCRIPTION:177,UNKNOWN_SUBSCRIPTION_PLAN:178,REJECTED_SUBSCRIPTION_PAYMENT_TOKEN:179,SUBSCRIPTION_ALREADY_CANCELLED:180,REJECTED_CUSTOMER_UPDATE:181},BASIC_ERROR="Hmm, we're having trouble with our system. We're working on fixing it for you and apologize for the inconvenience. Please try again later.",errorMessageIndex={expired_card:"It looks like your credit card has expired. Try another card.",insufficient_funds:"It looks like your card has insufficient funds. Try another card.",withdrawal_count_limit_exceeded:"It looks like this transaction will put you over your credit limit. Try another card.",charge_exceeds_source_limit:"It looks like this transaction will put you over your daily credit limit. Try another card or in 24 hours.",instant_payouts_unsupported:"It looks like your debit card isn't setup for instant payments. Try another debit or credit card.",duplicate_transaction:"Hmm. Looks like an identical transaction was just sent. Check your payment history.",coupon_expired:"It looks like that promo code has expired."};function getErrorMessage(type){return errorMessageIndex[type]?errorMessageIndex[type]:BASIC_ERROR}["api_key_expired","platform_api_key_expired","rate_limit","UNKNOWN","api_connection_error","api_error","invalid_request_error","UNKNOWN","state_unsupported","invalid_source_usage","invoice_no_customer_line_items","invoice_no_subscription_line_items","invoice_not_editable","invoice_upcoming_none","missing","order_creation_failed","order_required_settings","order_status_invalid","order_upstream_timeout","payment_intent_incompatible_payment_method","payment_intent_unexpected_state","payment_method_unactivated","payment_method_unexpected_state","payouts_not_allowed","resource_already_exists","resource_missing","secret_key_required","sepa_unsupported_account","shipping_calculation_failed","tax_id_invalid","taxes_calculation_failed","tls_version_unsupported","token_already_used","token_in_use","transfers_not_allowed"].forEach(function(k){return errorMessageIndex[k]=BASIC_ERROR}),["approve_with_id","issuer_not_available","processing_error","reenter_transaction","try_again_later","payment_intent_authentication_failure","processing_error"].forEach(function(k){return errorMessageIndex[k]="Hmm. There was a problem authorizing your payment. Try again or get in touch with your card issuer."}),["call_issuer","card_not_supported","card_velocity_exceeded","do_not_honor","do_not_try_again","fraudulent","generic_decline","invalid_account","lost_card","merchant_blacklist","new_account_information_available","no_action_taken","not_permitted","pickup_card","restricted_card","revocation_of_all_authorizations","revocation_of_authorization","security_violation","service_not_allowed","stolen_card","stop_payment_order","transaction_not_allowed"].forEach(function(k){return errorMessageIndex[k]="Hmm. There was a problem authorizing your payment. Get in touch with your card issuer."})},79:function(module,__webpack_exports__,__webpack_require__){"use strict";var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(80);__webpack_exports__.a=function ScreenInfo(win){if(Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,ScreenInfo),this.clientHeight=void 0,this.clientWidth=void 0,this.devicePixelRatio=void 0,this.screenHeight=void 0,this.screenWidth=void 0,win){var documentElement=win.document.documentElement||{clientHeight:void 0,clientWidth:void 0},screen=win.screen||{height:void 0,width:void 0};this.clientHeight=documentElement.clientHeight,this.clientWidth=documentElement.clientWidth,this.devicePixelRatio=win.devicePixelRatio,this.screenHeight=screen.height,this.screenWidth=screen.width}}},81:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return LoadingOverlay});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),react_redux__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(84),_store__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(5),LoadingOverlay=(__webpack_require__(582),function LoadingOverlay(_ref){return _ref.isLoading?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{id:"loading-overlay","data-testid":"loading-overlay"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("img",{alt:"Loading",src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSI3M3B4IiBoZWlnaHQ9IjczcHgiIHZpZXdCb3g9IjAgMCA3MyA3MyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgICAgIDxkZWZzPiAgICAgICAgPGxpbmVhckdyYWRpZW50IHgxPSI5My4wOTI4MDk2JSIgeTE9IjUyLjc3MzQzNzUlIiB4Mj0iNjguNTEzMzM5OCUiIHkyPSIxMTkuMzI2MDA3JSIgaWQ9ImxpbmVhckdyYWRpZW50LTEiPiAgICAgICAgICAgIDxzdG9wIHN0b3AtY29sb3I9IiMwQTg0RkYiIHN0b3Atb3BhY2l0eT0iMCIgb2Zmc2V0PSIwJSI+PC9zdG9wPiAgICAgICAgICAgIDxzdG9wIHN0b3AtY29sb3I9IiMwQTg0RkYiIG9mZnNldD0iNjkuMzY5ODE4MiUiPjwvc3RvcD4gICAgICAgICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMEE4NEZGIiBvZmZzZXQ9IjEwMCUiPjwvc3RvcD4gICAgICAgICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMjQ4NEM2IiBzdG9wLW9wYWNpdHk9IjAuMDA0Nzc3NjY5NTEiIG9mZnNldD0iMTAwJSI+PC9zdG9wPiAgICAgICAgICAgIDxzdG9wIHN0b3AtY29sb3I9IiMyNDg0QzYiIHN0b3Atb3BhY2l0eT0iMCIgb2Zmc2V0PSIxMDAlIj48L3N0b3A+ICAgICAgICAgICAgPHN0b3Agc3RvcC1jb2xvcj0iIzI0ODRDNiIgc3RvcC1vcGFjaXR5PSIwIiBvZmZzZXQ9IjEwMCUiPjwvc3RvcD4gICAgICAgIDwvbGluZWFyR3JhZGllbnQ+ICAgICAgICA8cmVjdCBpZD0icGF0aC0yIiB4PSIwIiB5PSIwIiB3aWR0aD0iNDgiIGhlaWdodD0iNjAiPjwvcmVjdD4gICAgPC9kZWZzPiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4gICAgICAgIDxnIGlkPSJTaGFwZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTUuMDAwMDAwLCAtMS4wMDAwMDApIj4gICAgICAgICAgICA8cGF0aCBkPSJNNDEuOCw3My44IEMyMS45LDczLjggNS44LDU3LjcgNS44LDM3LjggQzUuOCwxOC4xIDIxLjYsMi4yIDQxLjEsMS44IEM0MS4zLDEuOCA0MS40LDEuOCA0MS40LDEuOCBDNDEuNSwxLjggNDEuNywxLjggNDEuOCwxLjggQzQ0LjYsMi4yIDQ2LjgsNC41IDQ2LjgsNy4zIEM0Ni44LDEwLjEgNDQuNiwxMi41IDQxLjgsMTIuNyBDMjgsMTIuOCAxNi44LDI0IDE2LjgsMzcuOCBDMTYuOCw1MS42IDI4LDYyLjggNDEuOCw2Mi44IEM1NS42LDYyLjggNjYuOCw1MS42IDY2LjgsMzcuOCBMNzcuOCwzNy44IEM3Ny44LDU3LjcgNjEuNyw3My44IDQxLjgsNzMuOCBaIiBmaWxsPSJ1cmwoI2xpbmVhckdyYWRpZW50LTEpIj48L3BhdGg+ICAgICAgICAgICAgPG1hc2sgaWQ9Im1hc2stMyIgZmlsbD0id2hpdGUiPiAgICAgICAgICAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNwYXRoLTIiPjwvdXNlPiAgICAgICAgICAgIDwvbWFzaz4gICAgICAgICAgICA8ZyBpZD0iTWFzayI+PC9nPiAgICAgICAgICAgIDxwYXRoIGQ9Ik00MS44LDczLjggQzIxLjksNzMuOCA1LjgsNTcuNyA1LjgsMzcuOCBDNS44LDE4LjEgMjEuNiwyLjIgNDEuMSwxLjggQzQxLjMsMS44IDQxLjQsMS44IDQxLjQsMS44IEM0MS41LDEuOCA0MS43LDEuOCA0MS44LDEuOCBDNDQuNiwyLjIgNDYuOCw0LjUgNDYuOCw3LjMgQzQ2LjgsMTAuMSA0NC42LDEyLjUgNDEuOCwxMi43IEMyOCwxMi44IDE2LjgsMjQgMTYuOCwzNy44IEMxNi44LDUxLjYgMjgsNjIuOCA0MS44LDYyLjggQzU1LjYsNjIuOCA2Ni44LDUxLjYgNjYuOCwzNy44IEw3Ny44LDM3LjggQzc3LjgsNTcuNyA2MS43LDczLjggNDEuOCw3My44IFoiIGZpbGw9IiMwQTg0RkYiIG1hc2s9InVybCgjbWFzay0zKSI+PC9wYXRoPiAgICAgICAgPC9nPiAgICA8L2c+PC9zdmc+"})):null});Object(react_redux__WEBPACK_IMPORTED_MODULE_1__.a)(function(state){return{isLoading:_store__WEBPACK_IMPORTED_MODULE_2__.b.isLoading(state)}})(LoadingOverlay)},85:function(module,__webpack_exports__,__webpack_require__){"use strict";var react=__webpack_require__(0),react_default=__webpack_require__.n(react),es=__webpack_require__(59),defineProperty=__webpack_require__(2),objectWithoutProperties=__webpack_require__(87),classnames=__webpack_require__(68),classnames_default=__webpack_require__.n(classnames),Tooltip=__webpack_require__(138);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach(function(key){Object(defineProperty.a)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}var FormContext=react_default.a.createContext(null),fields_Form=function Form(props){var children=props.children,validator=props.validator,formProps=Object(objectWithoutProperties.a)(props,["children","validator"]);return react_default.a.createElement("form",formProps,react_default.a.createElement(FormContext.Provider,{value:{validator:validator}},children))},fields_FieldGroup=function FieldGroup(_ref){var children=_ref.children;return react_default.a.createElement("div",{className:"input-row-group"},children)},fields_Field=function Field(_ref2){var tooltipParentRef=_ref2.tooltipParentRef,fieldType=_ref2.fieldType,name=_ref2.name,_ref2$initialValue=_ref2.initialValue,initialValue=void 0===_ref2$initialValue?null:_ref2$initialValue,_ref2$tooltip=_ref2.tooltip,tooltip=void 0===_ref2$tooltip||_ref2$tooltip,_ref2$required=_ref2.required,required=void 0!==_ref2$required&&_ref2$required,label=_ref2.label,_ref2$className=_ref2.className,className=void 0===_ref2$className?"input-row":_ref2$className,children=_ref2.children,validator=Object(react.useContext)(FormContext).validator;return Object(react.useEffect)(function(){return validator.registerField({name:name,initialValue:initialValue,required:required,fieldType:fieldType})},[name,required,fieldType]),react_default.a.createElement("div",{className:className},react_default.a.createElement("label",null,label&&react_default.a.createElement("span",{className:"label-text"},label),children,tooltip&&tooltipParentRef&&validator.getError(name)&&react_default.a.createElement(Tooltip.b,{parentRef:tooltipParentRef},validator.getError(name))))},fields_Input=function Input(props){var name=props.name,label=props.label,initialValue=props.initialValue,onValidate=props.onValidate,tooltip=props.tooltip,_props$required=props.required,required=void 0!==_props$required&&_props$required,className=props.className,childProps=Object(objectWithoutProperties.a)(props,["name","label","initialValue","onValidate","tooltip","required","className"]),validator=Object(react.useContext)(FormContext).validator,onChange=Object(react.useCallback)(function(ev){var value=ev.target.value;validator.updateField({name:name,value:value})},[name,validator,required]),onBlur=Object(react.useCallback)(function(ev){var value=ev.target.value;if(onValidate){var _onValidate=onValidate(value),newValue=_onValidate.value,error=_onValidate.error;validator.updateField({name:name,value:newValue,error:error,valid:null===error})}else required&&null!==value&&!value?validator.updateField({name:name,value:value,error:"This field is required"}):validator.updateField({name:name,value:value,valid:!0})},[name,validator,onValidate,required]),tooltipParentRef=Object(react.useRef)(null);return react_default.a.createElement(fields_Field,{fieldType:"input",tooltipParentRef:tooltipParentRef,name:name,initialValue:initialValue,tooltip:tooltip,required:required,label:label,className:className},react_default.a.createElement("input",_objectSpread({},childProps,{ref:tooltipParentRef,name:name,required:required,className:classnames_default()({invalid:validator.isInvalid(name)}),value:validator.getValue(name,""),onBlur:onBlur,onChange:onChange})))},fields_StripeElement=function StripeElement(props){var StripeElementComponent=props.component,name=props.name,tooltip=props.tooltip,onValidate=props.onValidate,_props$required2=props.required,required=void 0!==_props$required2&&_props$required2,label=props.label,className=props.className,childProps=Object(objectWithoutProperties.a)(props,["component","name","tooltip","onValidate","required","label","className"]),validator=Object(react.useContext)(FormContext).validator,elementValue=Object(react.useRef)(),validateElementValue=Object(react.useCallback)(function(){var value=elementValue.current;if(onValidate){var _onValidate2=onValidate(value),newValue=_onValidate2.value,error=_onValidate2.error;validator.updateField({name:name,value:newValue,error:error,valid:null===error})}else if(value)if(value.error&&value.error.message){var _error=value.error.message;_error.endsWith(".")&&(_error=_error.slice(0,-1)),validator.updateField({name:name,value:value,valid:!1,error:_error})}else value.complete&&validator.updateField({name:name,value:value,valid:!0});else required&&validator.updateField({name:name,value:value,error:"".concat(label," is required")})},[name,validator,label,onValidate,required]),onChange=Object(react.useCallback)(function(value){elementValue.current=value,validateElementValue()},[validateElementValue]),onBlur=Object(react.useCallback)(function(){return validateElementValue()},[validateElementValue]),tooltipParentRef=Object(react.useRef)(null);return react_default.a.createElement(fields_Field,{fieldType:"stripe",tooltipParentRef:tooltipParentRef,name:name,tooltip:tooltip,required:required,label:label,className:className},react_default.a.createElement(StripeElementComponent,_objectSpread({},childProps,{ref:function stripeElementRef(el){el&&(tooltipParentRef.current=el._ref)},onChange:onChange,onBlur:onBlur})))},fields_Checkbox=function Checkbox(props){var name=props.name,label=props.label,_props$required3=props.required,required=void 0!==_props$required3&&_props$required3,_props$className=props.className,className=void 0===_props$className?"input-row input-row--checkbox":_props$className,childProps=Object(objectWithoutProperties.a)(props,["name","label","required","className"]),validator=Object(react.useContext)(FormContext).validator,onChange=Object(react.useCallback)(function(ev){var value=ev.target.checked;required&&!value?validator.updateField({name:name,value:value,valid:!1}):validator.updateField({name:name,value:value,valid:!0})},[name,validator,required]);return react_default.a.createElement(fields_Field,{fieldType:"input",name:name,className:className,required:required,tooltip:!1},react_default.a.createElement("input",_objectSpread({},childProps,{type:"checkbox",name:name,onChange:onChange,onBlur:onChange})),react_default.a.createElement("span",{className:"label-text checkbox"},label))},fields_SubmitButton=function SubmitButton(props){var name=props.name,children=(props.label,props.children),className=props.className,_props$disabled=props.disabled,disabled=void 0!==_props$disabled&&_props$disabled,childProps=Object(objectWithoutProperties.a)(props,["name","label","children","className","disabled"]),validator=Object(react.useContext)(FormContext).validator,buttonProps={className:className,name:name,disabled:disabled||!validator.allValid()};return react_default.a.createElement("button",_objectSpread({},childProps,{},buttonProps,{type:"submit"}),children)},classCallCheck=__webpack_require__(80),createClass=__webpack_require__(276),slicedToArray=__webpack_require__(6);function validator_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function validator_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?validator_ownKeys(source,!0).forEach(function(key){Object(defineProperty.a)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):validator_ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}var validator_useValidatorState=function useValidatorState(params){var _ref=params||{},_ref$initialState=_ref.initialState,initialState=void 0===_ref$initialState?defaultState:_ref$initialState,_ref$middleware=_ref.middleware,middleware=void 0===_ref$middleware?void 0:_ref$middleware,reducer=middleware?function(state,action){return middleware(state,action,mainReducer)}:mainReducer,_useReducer=Object(react.useReducer)(reducer,initialState),_useReducer2=Object(slicedToArray.a)(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];return Object(react.useMemo)(function(){return new validator_Validator(state,dispatch)},[state,dispatch])},validator_Validator=function(){function Validator(state,dispatch){Object(classCallCheck.a)(this,Validator),this.state=void 0,this.dispatch=void 0,this.state=state,this.dispatch=dispatch}return Object(createClass.a)(Validator,[{key:"getValues",value:function getValues(){return Object.entries(this.state.fields).reduce(function(acc,_ref2){var _ref3=Object(slicedToArray.a)(_ref2,2),name=_ref3[0],field=_ref3[1];return validator_objectSpread({},acc,Object(defineProperty.a)({},name,field.value))},{})}},{key:"allValid",value:function allValid(){return Object.values(this.state.fields).filter(function(field){return field.required}).every(function(field){return!0===field.valid})}},{key:"registerField",value:function registerField(_ref4){var name=_ref4.name,_ref4$initialValue=_ref4.initialValue,initialValue=void 0===_ref4$initialValue?null:_ref4$initialValue,fieldType=_ref4.fieldType,required=_ref4.required;this.dispatch({type:"registerField",name:name,initialValue:initialValue,fieldType:fieldType,required:required})}},{key:"updateField",value:function updateField(_ref5){var name=_ref5.name,value=_ref5.value,valid=_ref5.valid,_ref5$error=_ref5.error,error=void 0===_ref5$error?null:_ref5$error;return void 0===valid&&(valid=!!error),this.dispatch({type:"updateField",name:name,value:value,valid:valid,error:error})}},{key:"getFieldState",value:function getFieldState(fieldName){return this.state.fields[fieldName]}},{key:"getFieldProp",value:function getFieldProp(fieldName,propName,defVal){return fieldName in this.state.fields&&propName in this.state.fields[fieldName]&&null!==this.state.fields[fieldName][propName]?this.state.fields[fieldName][propName]:defVal}},{key:"getValue",value:function getValue(name,defVal){return this.getFieldProp(name,"value",defVal)}},{key:"isInvalid",value:function isInvalid(name){return!1===this.getFieldProp(name,"valid")}},{key:"getError",value:function getError(name){return this.getFieldProp(name,"error")}},{key:"getGlobalError",value:function getGlobalError(){return this.state.error}},{key:"setGlobalError",value:function setGlobalError(error){this.dispatch({type:"setGlobalError",error:error})}},{key:"resetGlobalError",value:function resetGlobalError(){this.dispatch({type:"resetGlobalError"})}}]),Validator}(),defaultState={error:null,fields:{}},mainReducer=function mainReducer(state,action){switch(action.type){case"registerField":var _name=action.name,fieldType=action.fieldType,required=action.required,initialValue=action.initialValue;return validator_setFieldState(state,_name,function(field){return validator_objectSpread({value:initialValue,valid:null,error:null},field,{fieldType:fieldType,required:required})});case"updateField":var _name2=action.name,value=action.value,valid=action.valid,error=action.error;return validator_setFieldState(state,_name2,function(field){return validator_objectSpread({},field,{value:value,valid:valid,error:error})});case"setGlobalError":return validator_objectSpread({},state,{error:action.error});case"resetGlobalError":return validator_objectSpread({},state,{error:null})}return state},validator_setFieldState=function setFieldState(state,name,fn){return validator_objectSpread({},state,{fields:validator_objectSpread({},state.fields,Object(defineProperty.a)({},name,fn(state.fields[name])))})},formats=__webpack_require__(135),AppContext=__webpack_require__(17),SMALL_DEVICE_LINE_HEIGHT=(__webpack_require__(584),"37px"),DEFAULT_LINE_HEIGHT="45px",stripeElementStyles={base:{fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif',fontSize:"13px",fontWeight:"500",lineHeight:"45px"}};var InjectedPaymentForm=Object(es.injectStripe)(function PaymentForm(_ref){var _ref$inProgress=_ref.inProgress,inProgress=void 0!==_ref$inProgress&&_ref$inProgress,_ref$confirm=_ref.confirm,confirm=void 0===_ref$confirm||_ref$confirm,plan=_ref.plan,onCancel=_ref.onCancel,onPayment=_ref.onPayment,onPaymentError=_ref.onPaymentError,validatorInitialState=_ref.validatorInitialState,validatorMiddlewareReducer=_ref.validatorMiddlewareReducer,stripe=_ref.stripe,validator=validator_useValidatorState({initialState:validatorInitialState,middleware:validatorMiddlewareReducer}),matchMedia=Object(react.useContext)(AppContext.a).matchMedia,onSubmit=Object(react.useCallback)(function(ev){if(ev.preventDefault(),validator.allValid()){var _validator$getValues=validator.getValues(),name=_validator$getValues.name,zip=_validator$getValues.zip;stripe&&stripe.createToken({name:name,address_zip:zip}).then(function(tokenResponse){return onPayment(tokenResponse,name)}).catch(onPaymentError)}},[validator,onPayment,onPaymentError,stripe]);return stripeElementStyles=function checkMedia(matched,stripeElementStyles){var lh=matched?SMALL_DEVICE_LINE_HEIGHT:DEFAULT_LINE_HEIGHT;return Object.assign(stripeElementStyles,{base:{lineHeight:lh}})}(matchMedia("(max-width: 480px)"),stripeElementStyles),react_default.a.createElement(fields_Form,{"data-testid":"paymentForm",validator:validator,onSubmit:onSubmit,className:"payment"},react_default.a.createElement(fields_Input,{type:"text",name:"name",label:"Name as it appears on your card","data-testid":"name",placeholder:"Full Name",required:!0,autoFocus:!0,spellCheck:!1,onValidate:function onValidate(value){var error=null;return null===value||value||(error="Please enter your name"),{value:value,error:error}}}),react_default.a.createElement(fields_FieldGroup,null,react_default.a.createElement(fields_StripeElement,{component:es.CardNumberElement,name:"creditCardNumber",label:"Card number",style:stripeElementStyles,className:"input-row input-row--xl",required:!0}),react_default.a.createElement(fields_StripeElement,{component:es.CardExpiryElement,name:"expDate",label:"Exp. date",style:stripeElementStyles,required:!0}),react_default.a.createElement(fields_StripeElement,{component:es.CardCVCElement,name:"cvc",label:"CVC",style:stripeElementStyles,required:!0}),react_default.a.createElement(fields_Input,{type:"text",name:"zip",label:"ZIP code",maxLength:5,minLength:5,required:!0,"data-testid":"zip",placeholder:"12345",onValidate:function onValidate(value){var error=null;return(value=(""+value).substr(0,5))?5!==value.length&&(error="Zip code is too short"):error="Zip code is required",{value:value,error:error}}})),confirm&&plan&&react_default.a.createElement(fields_Checkbox,{"data-testid":"confirm",name:"confirm",required:!0,label:"\n          I authorize Mozilla, maker of Firefox products, to charge my\n          payment method $".concat(Object(formats.a)(plan.amount)," per ").concat(plan.interval,", according to payment\n          terms, until I cancel my subscription.\n        ")}),onCancel?react_default.a.createElement("div",{className:"button-row"},react_default.a.createElement("button",{"data-testid":"cancel",className:"settings-button cancel secondary-button",onClick:onCancel},"Cancel"),react_default.a.createElement(fields_SubmitButton,{"data-testid":"submit",className:"settings-button primary-button",name:"submit",disabled:inProgress},inProgress?react_default.a.createElement("span",{"data-testid":"spinner-update",className:"spinner"}," "):react_default.a.createElement("span",null,"Update"))):react_default.a.createElement("div",{className:"button-row"},react_default.a.createElement(fields_SubmitButton,{"data-testid":"submit",name:"submit",disabled:inProgress},inProgress?react_default.a.createElement("span",{"data-testid":"spinner-submit",className:"spinner"}," "):react_default.a.createElement("span",null,"Submit"))),react_default.a.createElement("div",{className:"legal-blurb"},"Mozilla uses Stripe for secure payment processing.",react_default.a.createElement("br",null),"View the ",react_default.a.createElement("a",{href:"https://stripe.com/privacy"},"Stripe privacy policy"),"."))});__webpack_exports__.a=function WrappedPaymentForm(props){return react_default.a.createElement(es.Elements,null,react_default.a.createElement(InjectedPaymentForm,props))}}},[[282,1,2]]]);
//# sourceMappingURL=main.ad036bbaa2cba1a814ed.bundle.js.map