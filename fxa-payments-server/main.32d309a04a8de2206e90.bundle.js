(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(module,__webpack_exports__,__webpack_require__){"use strict";var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(103);__webpack_exports__.a=function ScreenInfo(win){if(Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,ScreenInfo),this.clientHeight=void 0,this.clientWidth=void 0,this.devicePixelRatio=void 0,this.screenHeight=void 0,this.screenWidth=void 0,win){var documentElement=win.document.documentElement||{clientHeight:void 0,clientWidth:void 0},screen=win.screen||{height:void 0,width:void 0};this.clientHeight=documentElement.clientHeight,this.clientWidth=documentElement.clientWidth,this.devicePixelRatio=win.devicePixelRatio,this.screenHeight=screen.height,this.screenWidth=screen.width}}},104:function(module,__webpack_exports__,__webpack_require__){"use strict";var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),react_stripe_elements__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(80),_fields__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(36),_PaymentLegalBlurb__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(167),_lib_validator__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(168),_lib_hooks__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(34),_lib_formats__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(32),_lib_AppContext__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(28),InjectedPaymentForm=(__webpack_require__(665),Object(react_stripe_elements__WEBPACK_IMPORTED_MODULE_1__.injectStripe)((function PaymentForm(_ref){var _ref$inProgress=_ref.inProgress,inProgress=void 0!==_ref$inProgress&&_ref$inProgress,_ref$confirm=_ref.confirm,confirm=void 0===_ref$confirm||_ref$confirm,plan=_ref.plan,onCancel=_ref.onCancel,onPayment=_ref.onPayment,onPaymentError=_ref.onPaymentError,validatorInitialState=_ref.validatorInitialState,validatorMiddlewareReducer=_ref.validatorMiddlewareReducer,stripe=_ref.stripe,onMounted=_ref.onMounted,onEngaged=_ref.onEngaged,onChangeProp=_ref.onChange,validator=Object(_lib_validator__WEBPACK_IMPORTED_MODULE_4__.a)({initialState:validatorInitialState,middleware:validatorMiddlewareReducer});Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){onMounted(plan)}),[onMounted,plan]);var engageOnce=Object(_lib_hooks__WEBPACK_IMPORTED_MODULE_5__.b)((function(){onEngaged(plan)}),[onEngaged,plan]),onChange=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){engageOnce(),onChangeProp()}),[engageOnce,onChangeProp]),onSubmit=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(ev){if(ev.preventDefault(),validator.allValid()){var _validator$getValues=validator.getValues(),name=_validator$getValues.name,zip=_validator$getValues.zip;stripe&&stripe.createToken({name:name,address_zip:zip}).then((function(tokenResponse){onPayment(tokenResponse,name)})).catch((function(err){onPaymentError(err)}))}}),[validator,onPayment,onPaymentError,stripe]),stripeElementStyles=function mkStripeElementStyles(useSmallDeviceStyles){return{base:{fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif',fontSize:"14px",fontWeight:"500",lineHeight:useSmallDeviceStyles?SMALL_DEVICE_LINE_HEIGHT:DEFAULT_LINE_HEIGHT},invalid:{color:"#0c0c0d"}}}((0,Object(react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_lib_AppContext__WEBPACK_IMPORTED_MODULE_7__.a).matchMedia)(SMALL_DEVICE_RULE));return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_fields__WEBPACK_IMPORTED_MODULE_2__.c,Object.assign({"data-testid":"paymentForm",validator:validator,onSubmit:onSubmit,className:"payment"},{onChange:onChange}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_fields__WEBPACK_IMPORTED_MODULE_2__.d,{type:"text",name:"name",label:"Name as it appears on your card","data-testid":"name",placeholder:"Full Name",required:!0,autoFocus:!0,spellCheck:!1,onValidate:validateName}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_fields__WEBPACK_IMPORTED_MODULE_2__.b,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_fields__WEBPACK_IMPORTED_MODULE_2__.e,{component:react_stripe_elements__WEBPACK_IMPORTED_MODULE_1__.CardNumberElement,name:"creditCardNumber",label:"Card number",style:stripeElementStyles,className:"input-row input-row--xl",required:!0}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_fields__WEBPACK_IMPORTED_MODULE_2__.e,{component:react_stripe_elements__WEBPACK_IMPORTED_MODULE_1__.CardExpiryElement,name:"expDate",label:"Exp. date",style:stripeElementStyles,required:!0}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_fields__WEBPACK_IMPORTED_MODULE_2__.e,{component:react_stripe_elements__WEBPACK_IMPORTED_MODULE_1__.CardCVCElement,name:"cvc",label:"CVC",style:stripeElementStyles,required:!0}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_fields__WEBPACK_IMPORTED_MODULE_2__.d,{type:"text",name:"zip",label:"ZIP code",maxLength:5,minLength:5,required:!0,"data-testid":"zip",placeholder:"12345",onValidate:validateZip})),confirm&&plan&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_fields__WEBPACK_IMPORTED_MODULE_2__.a,{"data-testid":"confirm",name:"confirm",required:!0},"I authorize Mozilla, maker of Firefox products, to charge my payment method"," ",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("strong",null,"$","".concat(Object(_lib_formats__WEBPACK_IMPORTED_MODULE_6__.a)(plan.amount)," per ").concat(plan.interval)),", according to payment terms, until I cancel my subscription."),onCancel?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"button-row"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("button",{"data-testid":"cancel",className:"settings-button cancel secondary-button",onClick:onCancel},"Cancel"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_fields__WEBPACK_IMPORTED_MODULE_2__.f,{"data-testid":"submit",className:"settings-button primary-button",name:"submit",disabled:inProgress},inProgress?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{"data-testid":"spinner-update",className:"spinner"}," "):react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"Update"))):react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"button-row"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_fields__WEBPACK_IMPORTED_MODULE_2__.f,{"data-testid":"submit",name:"submit",disabled:inProgress},inProgress?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{"data-testid":"spinner-submit",className:"spinner"}," "):react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"Submit"))),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_PaymentLegalBlurb__WEBPACK_IMPORTED_MODULE_3__.a,null))}))),SMALL_DEVICE_RULE="(max-width: 520px)",SMALL_DEVICE_LINE_HEIGHT="40px",DEFAULT_LINE_HEIGHT="48px";var validateName=function validateName(value,focused){var valid=!0;return null===value||value||(valid=!1),{value:value,valid:valid,error:valid||focused?null:"Please enter your name"}},validateZip=function validateZip(value,focused){var valid=void 0,error=null;return(value=(""+value).substr(0,5))?5===value.length||focused?5===value.length&&(valid=!0):(valid=!1,error="Zip code is too short"):(valid=!1,error="Zip code is required"),{value:value,valid:valid,error:focused?null:error}};__webpack_exports__.a=function WrappedPaymentForm(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_stripe_elements__WEBPACK_IMPORTED_MODULE_1__.Elements,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(InjectedPaymentForm,props))}},107:function(module,__webpack_exports__,__webpack_require__){"use strict";var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),react_transition_group__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(683),react_transition_group__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(682);__webpack_require__(676);__webpack_exports__.a=function ErrorMessage(_ref){var children=_ref.children,isVisible=_ref.isVisible;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_transition_group__WEBPACK_IMPORTED_MODULE_1__.a,{component:null},isVisible&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_transition_group__WEBPACK_IMPORTED_MODULE_2__.a,{classNames:"animate-fade",timeout:150},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{"data-testid":"error-message-container",className:"error-message-container"},children)))}},108:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return PROFILE})),__webpack_require__.d(__webpack_exports__,"a",(function(){return CUSTOMER})),__webpack_require__.d(__webpack_exports__,"c",(function(){return SELECTED_PLAN})),__webpack_require__.d(__webpack_exports__,"d",(function(){return UPGRADE_FROM_PLAN}));var PROFILE={amrValues:[],avatar:"http://placekitten.com/256/256?image=11",avatarDefault:!1,displayName:"Foo Barson",email:"foo@example.com",locale:"en-US",twoFactorAuthentication:!0,uid:"8675309asdf"},CUSTOMER={payment_type:"credit",last4:"5309",exp_month:"02",exp_year:"2099",subscriptions:[{subscription_id:"sub0.28964929339372136",plan_id:"123doneProMonthly",nickname:"123done Pro Monthly",status:"active",cancel_at_period_end:!1,current_period_end:Date.now()/1e3+2678400,current_period_start:Date.now()/1e3-2678400,end_at:null}]},SELECTED_PLAN={plan_id:"plan_123",plan_name:"Better Upgrade Plan",product_id:"product_8675309",product_name:"Better Upgrade Product",currency:"USD",amount:2999,interval:"month",product_metadata:{webIconURL:"http://placekitten.com/49/49?image=2"}},UPGRADE_FROM_PLAN={plan_id:"plan_abc",plan_name:"Example Plan",product_id:"product_8675309",product_name:"Example Product",currency:"USD",amount:999,interval:"month",product_metadata:{webIconURL:"http://placekitten.com/49/49?image=9"}}},129:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return AlertBar}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_Portal__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(636),__webpack_require__(165)),AlertBar=function AlertBar(_ref){var children=_ref.children,_ref$className=_ref.className,className=void 0===_ref$className?"alert":_ref$className;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_Portal__WEBPACK_IMPORTED_MODULE_2__.a,{id:"top-bar"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{"data-testid":"alert-container",className:className},children))};__webpack_exports__.b=AlertBar},14:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DialogMessage}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(72),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_lib_hooks__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(34),_Portal__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(165),_CloseIcon__WEBPACK_IMPORTED_MODULE_5__=(__webpack_require__(660),__webpack_require__(174)),noop=function noop(){},DialogMessage=function DialogMessage(_ref){var _ref$className=_ref.className,className=void 0===_ref$className?"":_ref$className,onDismiss=_ref.onDismiss,children=_ref.children,_ref$dataTestid=_ref["data-testid"],testid=void 0===_ref$dataTestid?"dialog-message-container":_ref$dataTestid,dialogInsideRef=Object(_lib_hooks__WEBPACK_IMPORTED_MODULE_2__.d)(onDismiss||noop);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_Portal__WEBPACK_IMPORTED_MODULE_3__.a,{id:"dialogs"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{"data-testid":testid,className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("blocker","current")},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{"data-testid":"dialog-message-content",className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("modal",className),ref:dialogInsideRef},onDismiss&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("button",{"data-testid":"dialog-dismiss",className:"dismiss","aria-label":"Close modal",onClick:onDismiss},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_CloseIcon__WEBPACK_IMPORTED_MODULE_5__.a,null)),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"message"},children))))};__webpack_exports__.b=DialogMessage},165:function(module,__webpack_exports__,__webpack_require__){"use strict";var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(79);__webpack_require__(637);__webpack_exports__.a=Object(react__WEBPACK_IMPORTED_MODULE_0__.memo)((function Portal(_ref){var id=_ref.id,children=_ref.children,el=document.getElementById(id);return el||((el=document.createElement("div")).setAttribute("class","portal"),el.setAttribute("id",id),document.body.appendChild(el)),Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){return function(){var el=document.getElementById(id);el&&1===el.children.length&&el.remove()}}),[id]),Object(react_dom__WEBPACK_IMPORTED_MODULE_1__.createPortal)(children,el)}))},166:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Tooltip}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(72),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_lib_AppContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(28),Tooltip=function Tooltip(_ref){var children=_ref.children,parentRef=_ref.parentRef,_ref$id=_ref.id,id=void 0===_ref$id?"":_ref$id,_ref$showBelow=_ref.showBelow,showBelow=void 0===_ref$showBelow||_ref$showBelow,_ref$dismissible=_ref.dismissible,dismissible=void 0!==_ref$dismissible&&_ref$dismissible,_ref$onDismiss=_ref.onDismiss,onDismiss=void 0===_ref$onDismiss?function(){}:_ref$onDismiss,_ref$extraClassNames=_ref.extraClassNames,extraClassNames=void 0===_ref$extraClassNames?"":_ref$extraClassNames,screenInfo=(0,Object(react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_lib_AppContext__WEBPACK_IMPORTED_MODULE_2__.a).getScreenInfo)(),_screenInfo$clientHei=screenInfo.clientHeight,clientHeight=void 0===_screenInfo$clientHei?1e3:_screenInfo$clientHei,_screenInfo$clientWid=screenInfo.clientWidth,doShowBelow=showBelow&&clientHeight>=480&&(void 0===_screenInfo$clientWid?1e3:_screenInfo$clientWid)>=520,tooltipRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){var tooltipEl=tooltipRef.current,parentEl=parentRef.current;tooltipEl&&parentEl&&(tooltipEl.style.top=doShowBelow?parentEl.offsetTop+parentEl.offsetHeight+4+"px":parentEl.offsetTop+(0-tooltipEl.offsetHeight-2)+"px")}),[doShowBelow,tooltipRef,parentRef]);var asideClassNames=["tooltip",extraClassNames,doShowBelow?"tooltip-below fade-up-tt":"fade-down-tt"];return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("aside",{ref:tooltipRef,id:id,className:classnames__WEBPACK_IMPORTED_MODULE_1___default.a.apply(void 0,asideClassNames)},children,dismissible&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{"data-testid":"dismiss-button",onClick:onDismiss,className:"dismiss",tabIndex:2},"✕"))};__webpack_exports__.b=Tooltip},167:function(module,__webpack_exports__,__webpack_require__){"use strict";var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);__webpack_require__(664);__webpack_exports__.a=function PaymentLegalBlurb(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"payment-legal-blurb"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",null,"Mozilla uses Stripe for secure payment processing."),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",null,"View the"," ",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("a",{href:"https://stripe.com/privacy",target:"_blank",rel:"noopener noreferrer"},"Stripe privacy policy"),"."))}},168:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useValidatorState}));var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(103),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(325),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7),react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(0);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach((function(key){Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var useValidatorState=function useValidatorState(params){var _ref=params||{},_ref$initialState=_ref.initialState,initialState=void 0===_ref$initialState?defaultState:_ref$initialState,_ref$middleware=_ref.middleware,middleware=void 0===_ref$middleware?void 0:_ref$middleware,reducer=middleware?function(state,action){return middleware(state,action,mainReducer)}:mainReducer,_useReducer=Object(react__WEBPACK_IMPORTED_MODULE_4__.useReducer)(reducer,initialState),_useReducer2=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];return Object(react__WEBPACK_IMPORTED_MODULE_4__.useMemo)((function(){return new Validator(state,dispatch)}),[state,dispatch])},Validator=function(){function Validator(state,dispatch){Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__.a)(this,Validator),this.state=void 0,this.dispatch=void 0,this.state=state,this.dispatch=dispatch}return Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__.a)(Validator,[{key:"getValues",value:function getValues(){return Object.entries(this.state.fields).reduce((function(acc,_ref2){var _ref3=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(_ref2,2),name=_ref3[0],field=_ref3[1];return _objectSpread({},acc,Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)({},name,field.value))}),{})}},{key:"allValid",value:function allValid(){return Object.values(this.state.fields).filter((function(field){return field.required})).every((function(field){return!0===field.valid}))}},{key:"registerField",value:function registerField(_ref4){var name=_ref4.name,_ref4$initialValue=_ref4.initialValue,initialValue=void 0===_ref4$initialValue?null:_ref4$initialValue,fieldType=_ref4.fieldType,required=_ref4.required;this.dispatch({type:"registerField",name:name,initialValue:initialValue,fieldType:fieldType,required:required})}},{key:"updateField",value:function updateField(_ref5){var name=_ref5.name,value=_ref5.value,valid=_ref5.valid,_ref5$error=_ref5.error,error=void 0===_ref5$error?null:_ref5$error;return this.dispatch({type:"updateField",name:name,value:value,valid:valid,error:error})}},{key:"getFieldState",value:function getFieldState(fieldName){return this.state.fields[fieldName]}},{key:"getFieldProp",value:function getFieldProp(fieldName,propName,defVal){return fieldName in this.state.fields&&propName in this.state.fields[fieldName]&&null!==this.state.fields[fieldName][propName]?this.state.fields[fieldName][propName]:defVal}},{key:"getValue",value:function getValue(name,defVal){return this.getFieldProp(name,"value",defVal)}},{key:"isInvalid",value:function isInvalid(name){return!1===this.getFieldProp(name,"valid")}},{key:"getError",value:function getError(name){return this.getFieldProp(name,"error")}},{key:"getGlobalError",value:function getGlobalError(){return this.state.error}},{key:"setGlobalError",value:function setGlobalError(error){this.dispatch({type:"setGlobalError",error:error})}},{key:"resetGlobalError",value:function resetGlobalError(){this.dispatch({type:"resetGlobalError"})}}]),Validator}(),defaultState={error:null,fields:{}},mainReducer=function mainReducer(state,action){switch(action.type){case"registerField":var _name=action.name,fieldType=action.fieldType,required=action.required,initialValue=action.initialValue;return setFieldState(state,_name,(function(field){return _objectSpread({value:initialValue,valid:null,error:null},field,{fieldType:fieldType,required:required})}));case"updateField":var _name2=action.name,value=action.value,valid=action.valid,error=action.error;return setFieldState(state,_name2,(function(field){return _objectSpread({},field,{value:value,valid:valid,error:error})}));case"setGlobalError":return _objectSpread({},state,{error:action.error});case"resetGlobalError":return _objectSpread({},state,{error:null})}return state},setFieldState=function setFieldState(state,name,fn){return _objectSpread({},state,{fields:_objectSpread({},state.fields,Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)({},name,fn(state.fields[name])))})}},171:function(module,__webpack_exports__,__webpack_require__){"use strict";var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_store_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(54),_lib_amplitude__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6),_lib_formats__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(32),_lib_hooks__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(34),_components_fields__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(36),_lib_validator__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(168),_components_DialogMessage__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(14),_components_PaymentLegalBlurb__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(167),_ProfileBanner__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(172),PlanDetail=(__webpack_require__(671),function PlanDetail(_ref2){var plan=_ref2.plan,productName=plan.product_name,amount=plan.amount,interval=plan.interval,webIconURL=Object(_store_utils__WEBPACK_IMPORTED_MODULE_1__.a)(plan).webIconURL;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"upgrade-plan-detail"},webIconURL&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("img",{src:webIconURL,alt:productName,height:"49",width:"49"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{className:"product-name"},productName),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{className:"plan-price"},"$",Object(_lib_formats__WEBPACK_IMPORTED_MODULE_3__.a)(amount),"/",interval))});__webpack_exports__.a=function SubscriptionUpgrade(_ref){var customer=_ref.customer,profile=_ref.profile,selectedPlan=_ref.selectedPlan,upgradeFromPlan=_ref.upgradeFromPlan,upgradeFromSubscription=_ref.upgradeFromSubscription,updateSubscriptionPlanAndRefresh=_ref.updateSubscriptionPlanAndRefresh,resetUpdateSubscriptionPlan=_ref.resetUpdateSubscriptionPlan,updateSubscriptionPlanStatus=_ref.updateSubscriptionPlanStatus,validator=Object(_lib_validator__WEBPACK_IMPORTED_MODULE_6__.a)(),inProgress=updateSubscriptionPlanStatus.loading;Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){_lib_amplitude__WEBPACK_IMPORTED_MODULE_2__.s(selectedPlan)}),[selectedPlan]);var engageOnce=Object(_lib_hooks__WEBPACK_IMPORTED_MODULE_4__.b)((function(){_lib_amplitude__WEBPACK_IMPORTED_MODULE_2__.r(selectedPlan)}),[selectedPlan]),onSubmit=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(ev){ev.preventDefault(),validator.allValid()&&updateSubscriptionPlanAndRefresh(upgradeFromSubscription.subscription_id,selectedPlan)}),[validator,updateSubscriptionPlanAndRefresh,upgradeFromSubscription,selectedPlan]),cardLast4=customer.last4,cardExpMonth=customer.exp_month,cardExpYear=customer.exp_year;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"product-payment product-upgrade","data-testid":"subscription-upgrade"},updateSubscriptionPlanStatus.error&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_components_DialogMessage__WEBPACK_IMPORTED_MODULE_7__.b,{className:"dialog-error",onDismiss:resetUpdateSubscriptionPlan},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h4",{"data-testid":"error-plan-update-failed"},"Plan update failed"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",null,updateSubscriptionPlanStatus.error.message)),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_ProfileBanner__WEBPACK_IMPORTED_MODULE_9__.a,{profile:profile}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("hr",null),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"upgrade-details"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h2",null,"Review your upgrade details"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("ol",{className:"upgrade-plans"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("li",{className:"from-plan"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(PlanDetail,{plan:upgradeFromPlan})),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("li",{role:"img","aria-label":"upgrade indicator",className:"upgrade-indicator"}," "),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("li",{className:"to-plan"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(PlanDetail,{plan:selectedPlan})))),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("hr",null),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_components_fields__WEBPACK_IMPORTED_MODULE_5__.c,Object.assign({"data-testid":"upgrade-form",className:"upgrade"},{validator:validator,onSubmit:onSubmit}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h3",{className:"billing-title"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{className:"title"},"Billing Information"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{className:"card-details"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{className:"last4"},"Card Ending ",cardLast4),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{className:"expires"},"Expires ",cardExpMonth,"/",cardExpYear))),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",null,"Your plan will change immediately, and you’ll be charged an adjusted amount for the rest of your billing cycle. Starting"," ",Object(_lib_formats__WEBPACK_IMPORTED_MODULE_3__.b)(upgradeFromSubscription.current_period_end)," ","you’ll be charged the full amount."),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_components_fields__WEBPACK_IMPORTED_MODULE_5__.a,{"data-testid":"confirm",name:"confirm",onClick:engageOnce,required:!0},"I authorize Mozilla, maker of Firefox products, to charge my payment method"," ",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("strong",null,"$","".concat(Object(_lib_formats__WEBPACK_IMPORTED_MODULE_3__.a)(selectedPlan.amount),"/").concat(selectedPlan.interval)),", according to payment terms, until I cancel my subscription."),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"button-row"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_components_fields__WEBPACK_IMPORTED_MODULE_5__.f,{"data-testid":"submit",name:"submit",disabled:inProgress},inProgress?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{"data-testid":"spinner-submit",className:"spinner"}," "):react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"Change Plans"))),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_components_PaymentLegalBlurb__WEBPACK_IMPORTED_MODULE_8__.a,null)))}},172:function(module,__webpack_exports__,__webpack_require__){"use strict";var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);__webpack_exports__.a=function(_ref){var _ref$profile=_ref.profile,email=_ref$profile.email,avatar=_ref$profile.avatar,displayName=_ref$profile.displayName;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"profile-banner"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("img",{className:"avatar hoisted",src:avatar,alt:displayName||email}),displayName&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h2",{"data-testid":"profile-display-name",className:"displayName"},displayName),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h3",{"data-testid":"profile-email",className:"name email"},email))}},174:function(module,__webpack_exports__,__webpack_require__){"use strict";var react=__webpack_require__(0),react_default=__webpack_require__.n(react);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var _ref2=react_default.a.createElement("g",null,react_default.a.createElement("path",{fill:"rgba(12, 12, 13, .8)",d:"M9.414 8l5.293-5.293a1 1 0 00-1.414-1.414L8 6.586 2.707 1.293a1 1 0 00-1.414 1.414L6.586 8l-5.293 5.293a1 1 0 101.414 1.414L8 9.414l5.293 5.293a1 1 0 001.414-1.414z"})),close_SvgClose=function SvgClose(_ref){var svgRef=_ref.svgRef,title=_ref.title,props=_objectWithoutProperties(_ref,["svgRef","title"]);return react_default.a.createElement("svg",_extends({width:16,height:16,ref:svgRef},props),title?react_default.a.createElement("title",null,title):null,_ref2)},ForwardRef=react_default.a.forwardRef((function(props,ref){return react_default.a.createElement(close_SvgClose,_extends({svgRef:ref},props))}));__webpack_require__.p,__webpack_exports__.a=ForwardRef},19:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return APIError})),__webpack_require__.d(__webpack_exports__,"f",(function(){return apiFetchProfile})),__webpack_require__.d(__webpack_exports__,"e",(function(){return apiFetchPlans})),__webpack_require__.d(__webpack_exports__,"g",(function(){return apiFetchSubscriptions})),__webpack_require__.d(__webpack_exports__,"h",(function(){return apiFetchToken})),__webpack_require__.d(__webpack_exports__,"d",(function(){return apiFetchCustomer})),__webpack_require__.d(__webpack_exports__,"c",(function(){return apiCreateSubscription})),__webpack_require__.d(__webpack_exports__,"k",(function(){return apiUpdateSubscriptionPlan})),__webpack_require__.d(__webpack_exports__,"b",(function(){return apiCancelSubscription})),__webpack_require__.d(__webpack_exports__,"i",(function(){return apiReactivateSubscription})),__webpack_require__.d(__webpack_exports__,"j",(function(){return apiUpdatePayment}));var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(5),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(10),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(103),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(334),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(170),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(169),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(326),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(333),_config__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(61),_amplitude__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(6);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach((function(key){Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.a)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var APIError=function(_Error){function APIError(body,response,code,errno,error,statusCode){var _getPrototypeOf2,_this;Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__.a)(this,APIError);for(var _len=arguments.length,params=new Array(_len>6?_len-6:0),_key=6;_key<_len;_key++)params[_key-6]=arguments[_key];if((_this=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__.a)(this,(_getPrototypeOf2=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__.a)(APIError)).call.apply(_getPrototypeOf2,[this].concat(params)))).body=void 0,_this.response=void 0,_this.code=void 0,_this.statusCode=void 0,_this.errno=void 0,_this.error=void 0,_this.response=response,_this.body=body||null,_this.code=code||null,_this.statusCode=statusCode||null,_this.errno=errno||null,_this.error=error||null,_this.body){var _this$body=_this.body,_code=_this$body.code,_errno=_this$body.errno,_error=_this$body.error,message=_this$body.message,_statusCode=_this$body.statusCode;Object.assign(Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__.a)(_this),{code:_code,errno:_errno,error:_error,message:message,statusCode:_statusCode})}return _this}return Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_7__.a)(APIError,_Error),APIError}(Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_8__.a)(Error)),accessToken="",config=Object(_config__WEBPACK_IMPORTED_MODULE_9__.b)();function apiFetch(_x,_x2){return _apiFetch.apply(this,arguments)}function _apiFetch(){return(_apiFetch=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee(method,path){var options,response,body,_args=arguments;return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return options=_args.length>2&&void 0!==_args[2]?_args[2]:{},_context.next=3,fetch(path,_objectSpread({mode:"cors",credentials:"omit",method:method},options,{headers:_objectSpread({"Content-Type":"application/json",Authorization:"Bearer ".concat(accessToken)},options.headers||{})}));case 3:if(!((response=_context.sent).status>=400)){_context.next=15;break}return body={},_context.prev=6,_context.next=9,response.json();case 9:body=_context.sent,_context.next=14;break;case 12:_context.prev=12,_context.t0=_context.catch(6);case 14:throw new APIError(body,response);case 15:return _context.abrupt("return",response.json());case 16:case"end":return _context.stop()}}),_callee,null,[[6,12]])})))).apply(this,arguments)}function apiFetchProfile(){return _apiFetchProfile.apply(this,arguments)}function _apiFetchProfile(){return(_apiFetchProfile=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee2(){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return",apiFetch("GET","".concat(config.servers.profile.url,"/v1/profile")));case 1:case"end":return _context2.stop()}}),_callee2)})))).apply(this,arguments)}function apiFetchPlans(){return _apiFetchPlans.apply(this,arguments)}function _apiFetchPlans(){return(_apiFetchPlans=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee3(){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.abrupt("return",apiFetch("GET","".concat(config.servers.auth.url,"/v1/oauth/subscriptions/plans")));case 1:case"end":return _context3.stop()}}),_callee3)})))).apply(this,arguments)}function apiFetchSubscriptions(){return _apiFetchSubscriptions.apply(this,arguments)}function _apiFetchSubscriptions(){return(_apiFetchSubscriptions=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee4(){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.abrupt("return",apiFetch("GET","".concat(config.servers.auth.url,"/v1/oauth/subscriptions/active")));case 1:case"end":return _context4.stop()}}),_callee4)})))).apply(this,arguments)}function apiFetchToken(){return _apiFetchToken.apply(this,arguments)}function _apiFetchToken(){return(_apiFetchToken=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee5(){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.abrupt("return",apiFetch("POST","".concat(config.servers.oauth.url,"/v1/introspect"),{body:JSON.stringify({token:accessToken})}));case 1:case"end":return _context5.stop()}}),_callee5)})))).apply(this,arguments)}function apiFetchCustomer(){return _apiFetchCustomer.apply(this,arguments)}function _apiFetchCustomer(){return(_apiFetchCustomer=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee6(){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.abrupt("return",apiFetch("GET","".concat(config.servers.auth.url,"/v1/oauth/subscriptions/customer")));case 1:case"end":return _context6.stop()}}),_callee6)})))).apply(this,arguments)}function apiCreateSubscription(_x3){return _apiCreateSubscription.apply(this,arguments)}function _apiCreateSubscription(){return(_apiCreateSubscription=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee7(params){var metricsOptions,result;return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return metricsOptions={planId:params.planId,productId:params.productId},_context7.prev=1,_amplitude__WEBPACK_IMPORTED_MODULE_10__.i(metricsOptions),_context7.next=5,apiFetch("POST","".concat(config.servers.auth.url,"/v1/oauth/subscriptions/active"),{body:JSON.stringify(_objectSpread({},params))});case 5:return result=_context7.sent,_amplitude__WEBPACK_IMPORTED_MODULE_10__.h(metricsOptions),_context7.abrupt("return",result);case 10:throw _context7.prev=10,_context7.t0=_context7.catch(1),_amplitude__WEBPACK_IMPORTED_MODULE_10__.j(_objectSpread({},metricsOptions,{error:_context7.t0})),_context7.t0;case 14:case"end":return _context7.stop()}}),_callee7,null,[[1,10]])})))).apply(this,arguments)}function apiUpdateSubscriptionPlan(_x4){return _apiUpdateSubscriptionPlan.apply(this,arguments)}function _apiUpdateSubscriptionPlan(){return(_apiUpdateSubscriptionPlan=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee8(params){var subscriptionId,planId,productId,metricsOptions,result;return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return subscriptionId=params.subscriptionId,planId=params.planId,productId=params.productId,metricsOptions={planId:planId,productId:productId},_context8.prev=2,_amplitude__WEBPACK_IMPORTED_MODULE_10__.u(metricsOptions),_context8.next=6,apiFetch("PUT","".concat(config.servers.auth.url,"/v1/oauth/subscriptions/active/").concat(subscriptionId),{body:JSON.stringify({planId:planId})});case 6:return result=_context8.sent,_amplitude__WEBPACK_IMPORTED_MODULE_10__.t(metricsOptions),_context8.abrupt("return",result);case 11:throw _context8.prev=11,_context8.t0=_context8.catch(2),_amplitude__WEBPACK_IMPORTED_MODULE_10__.v(_objectSpread({},metricsOptions,{error:_context8.t0})),_context8.t0;case 15:case"end":return _context8.stop()}}),_callee8,null,[[2,11]])})))).apply(this,arguments)}function apiCancelSubscription(_x5){return _apiCancelSubscription.apply(this,arguments)}function _apiCancelSubscription(){return(_apiCancelSubscription=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee9(params){var subscriptionId,metricsOptions;return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return subscriptionId=params.subscriptionId,metricsOptions={planId:params.planId,productId:params.productId},_context9.prev=2,_amplitude__WEBPACK_IMPORTED_MODULE_10__.d(metricsOptions),_context9.next=6,apiFetch("DELETE","".concat(config.servers.auth.url,"/v1/oauth/subscriptions/active/").concat(subscriptionId));case 6:return _amplitude__WEBPACK_IMPORTED_MODULE_10__.c(metricsOptions),_context9.abrupt("return",{subscriptionId:subscriptionId});case 10:throw _context9.prev=10,_context9.t0=_context9.catch(2),_amplitude__WEBPACK_IMPORTED_MODULE_10__.e(_objectSpread({},metricsOptions,{error:_context9.t0})),_context9.t0;case 14:case"end":return _context9.stop()}}),_callee9,null,[[2,10]])})))).apply(this,arguments)}function apiReactivateSubscription(_x6){return _apiReactivateSubscription.apply(this,arguments)}function _apiReactivateSubscription(){return(_apiReactivateSubscription=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee10(_ref){var subscriptionId,planId;return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:return subscriptionId=_ref.subscriptionId,planId=_ref.planId,_context10.next=3,apiFetch("POST","".concat(config.servers.auth.url,"/v1/oauth/subscriptions/reactivate"),{body:JSON.stringify({subscriptionId:subscriptionId})});case 3:return _context10.abrupt("return",{subscriptionId:subscriptionId,planId:planId});case 4:case"end":return _context10.stop()}}),_callee10)})))).apply(this,arguments)}function apiUpdatePayment(_x7){return _apiUpdatePayment.apply(this,arguments)}function _apiUpdatePayment(){return(_apiUpdatePayment=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee11(params){var metricsOptions,result;return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:return metricsOptions={planId:params.planId,productId:params.productId},_context11.prev=1,_amplitude__WEBPACK_IMPORTED_MODULE_10__.p(metricsOptions),_context11.next=5,apiFetch("POST","".concat(config.servers.auth.url,"/v1/oauth/subscriptions/updatePayment"),{body:JSON.stringify({paymentToken:params.paymentToken})});case 5:return result=_context11.sent,_amplitude__WEBPACK_IMPORTED_MODULE_10__.o(metricsOptions),_context11.abrupt("return",result);case 10:throw _context11.prev=10,_context11.t0=_context11.catch(1),_amplitude__WEBPACK_IMPORTED_MODULE_10__.q(_objectSpread({},metricsOptions,{error:_context11.t0})),_context11.t0;case 14:case"end":return _context11.stop()}}),_callee11,null,[[1,10]])})))).apply(this,arguments)}},23:function(module,__webpack_exports__,__webpack_require__){"use strict";var defineProperty=__webpack_require__(5),react=__webpack_require__(0),react_default=__webpack_require__.n(react),dist=__webpack_require__(20),es=__webpack_require__(80),MockLoader_MockLoader=function MockLoader(_ref){var children=_ref.children;return react_default.a.createElement(react_default.a.Suspense,{fallback:react_default.a.createElement("div",null,"Loading")},children)},AppContext=__webpack_require__(28),config=__webpack_require__(61),screen_info=__webpack_require__(102);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach((function(key){Object(defineProperty.a)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}__webpack_require__.d(__webpack_exports__,"b",(function(){return defaultAppContextValue}));var defaultAppContextValue={config:_objectSpread({},config.a,{productRedirectURLs:{product_8675309:"https://example.com/product"},servers:_objectSpread({},config.a.servers,{content:{url:"https://accounts.firefox.com"}})}),queryParams:{},navigateToUrl:Object(dist.action)("navigateToUrl"),getScreenInfo:function getScreenInfo(){return new screen_info.a(window)},matchMedia:function matchMedia(query){return window.matchMedia(query).matches},locationReload:Object(dist.action)("locationReload")},defaultStripeStubs=function defaultStripeStubs(stripe){return stripe.createToken=function(element){return Promise.resolve({token:{id:"asdf",object:"mock_object",client_ip:"123.123.123.123",created:Date.now(),livemode:!1,type:"card",used:!1}})},stripe};__webpack_exports__.a=function MockApp(_ref){var children=_ref.children,_ref$stripeApiKey=_ref.stripeApiKey,stripeApiKey=void 0===_ref$stripeApiKey?"8675309":_ref$stripeApiKey,_ref$applyStubsToStri=_ref.applyStubsToStripe,applyStubsToStripe=void 0===_ref$applyStubsToStri?defaultStripeStubs:_ref$applyStubsToStri,_ref$appContextValue=_ref.appContextValue,appContextValue=void 0===_ref$appContextValue?defaultAppContextValue:_ref$appContextValue,mockStripe=Object(react.useMemo)((function(){return applyStubsToStripe(window.Stripe(stripeApiKey))}),[stripeApiKey,applyStubsToStripe]);return Object(react.useEffect)((function(){var el=document.documentElement;el.setAttribute("lang","en"),el.setAttribute("dir","ltr"),el.setAttribute("class","js no-touch no-reveal-pw getusermedia")}),[]),react_default.a.createElement(es.StripeProvider,{stripe:mockStripe},react_default.a.createElement(AppContext.a.Provider,{value:appContextValue},react_default.a.createElement(MockLoader_MockLoader,null,children)))}},24:function(module,__webpack_exports__,__webpack_require__){"use strict";var defineProperty=__webpack_require__(5),regenerator=__webpack_require__(2),regenerator_default=__webpack_require__.n(regenerator),asyncToGenerator=__webpack_require__(10),apiClient=__webpack_require__(19);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach((function(key){Object(defineProperty.a)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var api={fetchProfile:function fetchProfile(){return{type:"fetchProfile",payload:Object(apiClient.f)()}},fetchToken:function fetchToken(){return{type:"fetchToken",payload:Object(apiClient.h)()}},fetchPlans:function fetchPlans(){return{type:"fetchPlans",payload:Object(apiClient.e)()}},fetchSubscriptions:function fetchSubscriptions(){return{type:"fetchSubscriptions",payload:Object(apiClient.g)()}},fetchCustomer:function fetchCustomer(){return{type:"fetchCustomer",payload:Object(apiClient.d)()}},createSubscription:function createSubscription(paymentToken,plan,displayName){return{type:"createSubscription",meta:{plan:plan},payload:Object(apiClient.c)({paymentToken:paymentToken,displayName:displayName,planId:plan.plan_id,productId:plan.product_id})}},updateSubscriptionPlan:function updateSubscriptionPlan(subscriptionId,plan){return{type:"updateSubscriptionPlan",meta:{subscriptionId:subscriptionId,plan:plan},payload:Object(apiClient.k)({subscriptionId:subscriptionId,planId:plan.plan_id,productId:plan.product_id})}},cancelSubscription:function cancelSubscription(subscriptionId,plan){return{type:"cancelSubscription",meta:{plan:plan},payload:(_payload=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee(){var result;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(apiClient.b)({subscriptionId:subscriptionId,planId:plan.plan_id,productId:plan.product_id});case 2:return result=_context.sent,_context.abrupt("return",_objectSpread({},result,{subscriptionId:subscriptionId}));case 4:case"end":return _context.stop()}}),_callee)}))),function payload(){return _payload.apply(this,arguments)})};var _payload},reactivateSubscription:function reactivateSubscription(subscriptionId,plan){return{type:"reactivateSubscription",meta:{plan:plan},payload:(_payload2=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee2(){return regenerator_default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,Object(apiClient.i)({subscriptionId:subscriptionId,planId:plan.plan_id});case 2:return _context2.abrupt("return",{subscriptionId:subscriptionId,plan:plan});case 3:case"end":return _context2.stop()}}),_callee2)}))),function payload(){return _payload2.apply(this,arguments)})};var _payload2},updatePayment:function updatePayment(paymentToken,plan){return{type:"updatePayment",meta:{plan:plan},payload:Object(apiClient.j)({paymentToken:paymentToken,planId:plan.plan_id,productId:plan.product_id})}}};function actions_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}__webpack_require__.d(__webpack_exports__,"a",(function(){return actions}));var actions=function actions_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?actions_ownKeys(source,!0).forEach((function(key){Object(defineProperty.a)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):actions_ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},api,{},{resetCreateSubscription:function resetCreateSubscription(){return{type:"resetCreateSubscription"}},resetUpdateSubscriptionPlan:function resetUpdateSubscriptionPlan(){return{type:"resetUpdateSubscriptionPlan"}},resetCancelSubscription:function resetCancelSubscription(){return{type:"resetCancelSubscription"}},resetReactivateSubscription:function resetReactivateSubscription(){return{type:"resetReactivateSubscription"}},resetUpdatePayment:function resetUpdatePayment(){return{type:"resetUpdatePayment"}}})},25:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return selectors}));var selectors={profile:function profile(state){return state.profile},token:function token(state){return state.token},subscriptions:function subscriptions(state){return state.subscriptions},plans:function plans(state){return state.plans},customer:function customer(state){return state.customer},createSubscriptionStatus:function createSubscriptionStatus(state){return state.createSubscription},updateSubscriptionPlanStatus:function updateSubscriptionPlanStatus(state){return state.updateSubscriptionPlan},cancelSubscriptionStatus:function cancelSubscriptionStatus(state){return state.cancelSubscription},reactivateSubscriptionStatus:function reactivateSubscriptionStatus(state){return state.reactivateSubscription},updatePaymentStatus:function updatePaymentStatus(state){return state.updatePayment},plansByProductId:function plansByProductId(state){return function(productId){return(selectors.plans(state).result||[]).filter((function(plan){return plan.product_id===productId}))}},customerSubscriptions:function customerSubscriptions(state){var fetchedCustomer=selectors.customer(state);return fetchedCustomer&&fetchedCustomer.result&&fetchedCustomer.result.subscriptions?fetchedCustomer.result.subscriptions:null}}},28:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return AppContext}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_config__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(61),_screen_info__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(102),noopFunction=function noopFunction(){},defaultAppContext={config:_config__WEBPACK_IMPORTED_MODULE_1__.a,getScreenInfo:function getScreenInfo(){return new _screen_info__WEBPACK_IMPORTED_MODULE_2__.a},locationReload:noopFunction,matchMedia:function matchMedia(){return!1},navigateToUrl:noopFunction,queryParams:{}},AppContext=react__WEBPACK_IMPORTED_MODULE_0___default.a.createContext(defaultAppContext);__webpack_exports__.b=AppContext},29:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return SignInLayoutContext})),__webpack_require__.d(__webpack_exports__,"b",(function(){return SignInLayout})),__webpack_require__.d(__webpack_exports__,"a",(function(){return SettingsLayout}));var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_lib_AppContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(28),fluent_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(109),classnames__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(72),classnames__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_4__),AppLayout=(__webpack_require__(658),function AppLayout(_ref){var children=_ref.children,config=Object(react__WEBPACK_IMPORTED_MODULE_1__.useContext)(_lib_AppContext__WEBPACK_IMPORTED_MODULE_2__.a).config;return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{id:"stage","data-testid":"stage",className:"fade-in-forward",style:{opacity:1}},children),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("footer",{"data-testid":"footer"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{id:"about-moz-footer","data-testid":"about-moz-footer"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("a",{id:"about-mozilla",rel:"author noopener noreferrer",target:"_blank",href:"https://www.mozilla.org/about/?utm_source=firefox-accounts&utm_medium=Referral"}," ")),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{id:"legal-footer","data-testid":"legal-footer"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(fluent_react__WEBPACK_IMPORTED_MODULE_3__.a,{id:"terms"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("a",{className:"terms",rel:"noopener noreferrer",target:"_blank",href:config.legalDocLinks.termsOfService},"Terms of Service")),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(fluent_react__WEBPACK_IMPORTED_MODULE_3__.a,{id:"privacy"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("a",{className:"privacy",rel:"noopener noreferrer",target:"_blank",href:config.legalDocLinks.privacyNotice},"Privacy Notice")))))}),SignInLayoutContext=react__WEBPACK_IMPORTED_MODULE_1___default.a.createContext({setHideLogo:function setHideLogo(hideLogo){}}),SignInLayout=function SignInLayout(_ref2){var children=_ref2.children,_useState=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),_useState2=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useState,2),hideLogo=_useState2[0],setHideLogo=_useState2[1],mainContentClassNames=classnames__WEBPACK_IMPORTED_MODULE_4___default()("card","payments-card",{"hide-logo":hideLogo});return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(AppLayout,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SignInLayoutContext.Provider,{value:{setHideLogo:setHideLogo}},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{className:"sign-in"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{id:"main-content",className:mainContentClassNames},children))))},SettingsLayout=function SettingsLayout(_ref3){var children=_ref3.children;Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){return document.body.classList.add("settings"),function(){return document.body.classList.remove("settings")}}),[children]);var config=Object(react__WEBPACK_IMPORTED_MODULE_1__.useContext)(_lib_AppContext__WEBPACK_IMPORTED_MODULE_2__.a).config,homeURL="".concat(config.servers.content.url,"/settings"),breadcrumbs=react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("ol",{className:"breadcrumbs","data-testid":"breadcrumbs"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("li",null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(fluent_react__WEBPACK_IMPORTED_MODULE_3__.a,{id:"settings-home"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("a",{href:homeURL},"Account Home"))),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("li",null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(fluent_react__WEBPACK_IMPORTED_MODULE_3__.a,{id:"settings-subscriptions"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("a",{href:"/subscriptions"},"Subscriptions"))));return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(AppLayout,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{className:"settings"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{id:"fxa-settings-header-wrapper"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("header",{id:"fxa-settings-header"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("h1",{id:"fxa-manage-account"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(fluent_react__WEBPACK_IMPORTED_MODULE_3__.a,{id:"project-brand"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("span",{className:"fxa-account-title"},"Firefox Accounts")))),breadcrumbs),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{id:"fxa-settings"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{id:"fxa-settings-content",className:"card"},children))))}},32:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return formatCurrencyInCents})),__webpack_require__.d(__webpack_exports__,"b",(function(){return formatPeriodEndDate}));var dayjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(92),dayjs__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(dayjs__WEBPACK_IMPORTED_MODULE_0__);function formatCurrencyInCents(amount){return(amount/100).toFixed(2)}function formatPeriodEndDate(dt){return dayjs__WEBPACK_IMPORTED_MODULE_0___default.a.unix(dt).format("MMMM DD, YYYY")}},324:function(module,__webpack_exports__,__webpack_require__){"use strict";var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);__webpack_exports__.a=function LoremIpsum(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam diam orci, pulvinar sit amet lorem sed, scelerisque laoreet nulla. Vestibulum scelerisque non ligula eget auctor. Aliquam ullamcorper, quam non convallis ultricies, tellus nunc sodales mi, vel ultricies tellus ex sit amet mi. Mauris sit amet arcu at libero feugiat lacinia sed non ligula. Maecenas sit amet posuere orci. Mauris venenatis pulvinar nisi, eget porta mi. Praesent et velit pulvinar, ultrices velit non, vehicula felis.")}},330:function(module,__webpack_exports__,__webpack_require__){"use strict";var slicedToArray=__webpack_require__(7),react=__webpack_require__(0),react_default=__webpack_require__.n(react),es=__webpack_require__(173),dayjs_min=__webpack_require__(92),dayjs_min_default=__webpack_require__.n(dayjs_min),amplitude=__webpack_require__(6),errors=__webpack_require__(66),AppContext=__webpack_require__(28),actions=__webpack_require__(24),selectors=__webpack_require__(25),sequences=__webpack_require__(74),formats=(__webpack_require__(679),__webpack_require__(32)),hooks=__webpack_require__(34),utils=__webpack_require__(54),PaymentForm=__webpack_require__(104),ErrorMessage=__webpack_require__(107),Subscriptions_PaymentUpdateForm=function PaymentUpdateForm(_ref){var updatePayment=_ref.updatePayment,updatePaymentStatus=_ref.updatePaymentStatus,resetUpdatePayment=_ref.resetUpdatePayment,customer=_ref.customer,customerSubscription=_ref.customerSubscription,plan=_ref.plan,_useBooleanState=Object(hooks.a)(),_useBooleanState2=Object(slicedToArray.a)(_useBooleanState,3),updateRevealed=_useBooleanState2[0],revealUpdate=_useBooleanState2[1],hideUpdate=_useBooleanState2[2],_useState=Object(react.useState)({type:"",error:!1}),_useState2=Object(slicedToArray.a)(_useState,2),createTokenError=_useState2[0],setCreateTokenError=_useState2[1],onRevealUpdateClick=Object(react.useCallback)((function(){resetUpdatePayment(),revealUpdate()}),[resetUpdatePayment,revealUpdate]),onPayment=Object(react.useCallback)((function(tokenResponse){if(tokenResponse&&tokenResponse.token)updatePayment(tokenResponse.token.id,plan);else{setCreateTokenError({type:"api_error",error:!0})}}),[updatePayment,setCreateTokenError,plan]),onPaymentError=Object(react.useCallback)((function(error){error.error=!0,setCreateTokenError(error)}),[setCreateTokenError]),onChange=Object(react.useCallback)((function(){setCreateTokenError({type:"",error:!1}),resetUpdatePayment()}),[setCreateTokenError,resetUpdatePayment]),onFormMounted=Object(react.useCallback)((function(){return amplitude.n(plan)}),[plan]),onFormEngaged=Object(react.useCallback)((function(){return amplitude.m(plan)}),[plan]),inProgress=updatePaymentStatus.loading,upgradeCTA=Object(utils.a)(plan).upgradeCTA,last4=customer.last4,exp_month=customer.exp_month,exp_year=customer.exp_year,periodEndDate=dayjs_min_default.a.unix(customerSubscription.current_period_end).format("MM/DD/YYYY"),expirationDate=dayjs_min_default()().set("month",Number(exp_month)).set("year",Number(exp_year)).format("MMMM YYYY");return react_default.a.createElement("div",{className:"payment-update"},react_default.a.createElement("h3",{className:"billing-title"},react_default.a.createElement("span",{className:"title"},"Billing Information")),react_default.a.createElement("p",{className:"billing-description"},"You are billed $",Object(formats.a)(plan.amount)," per ",plan.interval," ","for ",plan.product_name,". Your next payment occurs on ",periodEndDate,"."),upgradeCTA&&react_default.a.createElement("p",{className:"upgrade-cta","data-testid":"upgrade-cta",dangerouslySetInnerHTML:{__html:upgradeCTA}}),updateRevealed?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(ErrorMessage.a,{isVisible:!!createTokenError.error},createTokenError.error&&react_default.a.createElement("p",{"data-testid":"error-payment-submission"},Object(errors.b)(createTokenError.type))),react_default.a.createElement(ErrorMessage.a,{isVisible:!!updatePaymentStatus.error},updatePaymentStatus.error&&react_default.a.createElement("p",{"data-testid":"error-billing-update"},updatePaymentStatus.error.message)),react_default.a.createElement(PaymentForm.a,{plan:plan,onPayment:onPayment,onPaymentError:onPaymentError,inProgress:inProgress,confirm:!1,onCancel:hideUpdate,onChange:onChange,onMounted:onFormMounted,onEngaged:onFormEngaged})):react_default.a.createElement("div",{className:"with-settings-button"},react_default.a.createElement("div",{className:"card-details"},react_default.a.createElement("div",{className:"last-four"},"Card ending ",last4),react_default.a.createElement("div",{className:"expiry"},"Expires ",expirationDate)),react_default.a.createElement("div",{className:"action"},react_default.a.createElement("button",{"data-testid":"reveal-payment-update-button",className:"settings-button",onClick:onRevealUpdateClick},react_default.a.createElement("span",{className:"change-button"},"Change")))))},DialogMessage=__webpack_require__(14),fpn="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA5NiA5NiIgd2lkdGg9Ijk2IiBoZWlnaHQ9Ijk2Ij48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImEiIHgxPSI2NC4wNjUlIiB4Mj0iMjcuMjI2JSIgeTE9IjYuNTg4JSIgeTI9Ijg4Ljg0OCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNGRjk2NDAiLz48c3RvcCBvZmZzZXQ9IjYwJSIgc3RvcC1jb2xvcj0iI0ZDNDA1NSIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iI0UzMTU4NyIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IGlkPSJiIiB4MT0iNjQuMDY1JSIgeDI9IjI3LjIyNiUiIHkxPSI2LjU4OCUiIHkyPSI4OC44NDglIj48c3RvcCBvZmZzZXQ9IjAlIiBzdG9wLWNvbG9yPSIjRkZGMzZFIiBzdG9wLW9wYWNpdHk9Ii44Ii8+PHN0b3Agb2Zmc2V0PSI5JSIgc3RvcC1jb2xvcj0iI0ZGRjM2RSIgc3RvcC1vcGFjaXR5PSIuNyIvPjxzdG9wIG9mZnNldD0iNzUlIiBzdG9wLWNvbG9yPSIjRkZGMzZFIiBzdG9wLW9wYWNpdHk9IjAiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0iYyIgeDE9Ijc2LjUzNyUiIHgyPSIzMy42NjYlIiB5MT0iODkuMjc5JSIgeTI9IjMuMDQyJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI0I4MzNFMSIvPjxzdG9wIG9mZnNldD0iMzclIiBzdG9wLWNvbG9yPSIjOTA1OUZGIi8+PHN0b3Agb2Zmc2V0PSI2MSUiIHN0b3AtY29sb3I9IiM1QjZERjgiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMwMDkwRUQiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0iZCIgeDE9IjgzLjMzMyUiIHgyPSIzNy42MDIlIiB5MT0iMTAxLjYyNiUiIHkyPSI0Mi41NjMlIj48c3RvcCBvZmZzZXQ9IjAlIiBzdG9wLWNvbG9yPSIjNzIyMjkxIiBzdG9wLW9wYWNpdHk9Ii41Ii8+PHN0b3Agb2Zmc2V0PSI1MCUiIHN0b3AtY29sb3I9IiM3MjIyOTEiIHN0b3Atb3BhY2l0eT0iMCIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0ibm9uemVybyI+PHBhdGggZmlsbD0idXJsKCNhKSIgZD0iTTQ0LjY4NyA1MS44NjNoLjA3Yy4xODMuMDExLjM2Ny4wMTEuNTUgMGE0Ljc2NSA0Ljc2NSAwIDAxLS42MiAwek02Mi43NjMgMTIuMzRhMzYuNDYgMzYuNDYgMCAwMC0yNi40Ny0xMS4xN0MxNS45MjIgMS4xNyAwIDE3LjM2MiAwIDM4LjAzNyAwIDU3LjE5IDI5LjUwMiA4OS43OTUgMzIuODc0IDkzLjQ2YTQuNzY4IDQuNzY4IDAgMDA3LjAyNS02LjQ1MWMtLjA5NC0uMDk0LTcuODMzLTguNTctMTUuNDc4LTE4Ljk5QzExLjQ2MSA1MC4zNDIgOS41MyA0MS42MzIgOS41MyAzOC4wMzggOS41MyAyMi43IDIxLjIzNyAxMC43IDM2LjI1OCAxMC43YTI3LjAwOSAyNy4wMDkgMCAwMTE5LjY0NCA4LjI1NCAyNi4yMDEgMjYuMjAxIDAgMDE3LjMxOCAxOS4zMjljLS4yODEgNy41OTgtNy45MjYgMTkuNjIxLTE1LjMyNSAyOC44NDdsLTIuNjQ2IDIuNzUxYy0yLjU1MiAyLjE3OC02LjQwNCAxLjM0Ni04LjUxMS0xLjI1M2EyNTQuNTE1IDI1NC41MTUgMCAwMDYuNzY2IDcuOTg1QTUuOTI0IDUuOTI0IDAgMDA0OCA3OC42MjZhNS45MzYgNS45MzYgMCAwMDQuNDcyLTIuMDcyYzQuNjgzLTUuNDA5IDE5Ljc3NC0yNC4xMTcgMjAuMjg5LTM3LjkyYTM1LjYzNyAzNS42MzcgMCAwMC05Ljk5OC0yNi4yOTR6bS0yMS45NCAzNC4wNjh2LjE2NGMuMDMzLS4yODYuMDkyLS41NjguMTc2LS44NDNhNC42ODMgNC42ODMgMCAwMC0uMTc2LjY3OXoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDExLjcwNykiLz48cGF0aCBmaWxsPSJ1cmwoI2IpIiBkPSJNNDQuNjg3IDUxLjg2M2guMDdjLjE4My4wMTEuMzY3LjAxMS41NSAwYTQuNzY1IDQuNzY1IDAgMDEtLjYyIDB6TTYyLjc2MyAxMi4zNGEzNi40NiAzNi40NiAwIDAwLTI2LjQ3LTExLjE3QzE1LjkyMiAxLjE3IDAgMTcuMzYyIDAgMzguMDM3IDAgNTcuMTkgMjkuNTAyIDg5Ljc5NSAzMi44NzQgOTMuNDZhNC43NjggNC43NjggMCAwMDcuMDI1LTYuNDUxYy0uMDk0LS4wOTQtNy44MzMtOC41Ny0xNS40NzgtMTguOTlDMTEuNDYxIDUwLjM0MiA5LjUzIDQxLjYzMiA5LjUzIDM4LjAzOCA5LjUzIDIyLjcgMjEuMjM3IDEwLjcgMzYuMjU4IDEwLjdhMjcuMDA5IDI3LjAwOSAwIDAxMTkuNjQ0IDguMjU0IDI2LjIwMSAyNi4yMDEgMCAwMTcuMzE4IDE5LjMyOWMtLjI4MSA3LjU5OC03LjkyNiAxOS42MjEtMTUuMzI1IDI4Ljg0N2wtMi42NDYgMi43NTFjLTIuNTUyIDIuMTc4LTYuNDA0IDEuMzQ2LTguNTExLTEuMjUzYTI1NC41MTUgMjU0LjUxNSAwIDAwNi43NjYgNy45ODVBNS45MjQgNS45MjQgMCAwMDQ4IDc4LjYyNmE1LjkzNiA1LjkzNiAwIDAwNC40NzItMi4wNzJjNC42ODMtNS40MDkgMTkuNzc0LTI0LjExNyAyMC4yODktMzcuOTJhMzUuNjM3IDM1LjYzNyAwIDAwLTkuOTk4LTI2LjI5NHptLTIxLjk0IDM0LjA2OHYuMTY0Yy4wMzMtLjI4Ni4wOTItLjU2OC4xNzYtLjg0M2E0LjY4MyA0LjY4MyAwIDAwLS4xNzYuNjc5eiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTEuNzA3KSIvPjxwYXRoIGZpbGw9InVybCgjYykiIGQ9Ik00NS4yNiA2OS44ODFjLTIuNTUyIDIuMTktNi40MDMgMS4zNDYtOC41MjItMS4yNjRsLS4zNjMtLjQ0NUMyMi44MDUgNTEuMzYgMjAuMzQ3IDQzLjE4OCAxOS45MDIgNDAuMjVBMTYuMDc0IDE2LjA3NCAwIDAxMjMuOTA2IDI3LjNhMTYuNTc4IDE2LjU3OCAwIDAxMTIuODc4LTUuNDA4IDE2LjEzMyAxNi4xMzMgMCAwMTExLjcwOCA1LjU0OSAxNy41NjEgMTcuNTYxIDAgMDE0LjE5IDEzLjE5NCAxNy43ODMgMTcuNzgzIDAgMDEtMy4yODkgOS4yNiA0Ljc1MyA0Ljc1MyAwIDExLTcuNDgtNS44NTMgOS4yOTYgOS4yOTYgMCAwMDEuMjk5LTQuMjk3IDcuOTczIDcuOTczIDAgMDAtMS45MDktNi4wMDZBNi42ODUgNi42ODUgMCAwMDM2LjQ4IDMxLjRhNy4wOTUgNy4wOTUgMCAwMC01LjUwMiAyLjI3MSA2LjQ3NCA2LjQ3NCAwIDAwLTEuNjI4IDUuMjkyYy43MTQgNS4yNjggOS42MzUgMTcuNjY2IDE4LjUxIDI4LjA5OGwtMi42IDIuODIxeiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTEuNzA3KSIvPjxwYXRoIGZpbGw9InVybCgjZCkiIGQ9Ik0zMC42MjYgNjAuNjY3YTEzNC43NzYgMTM0Ljc3NiAwIDAwNS43NDkgNy41MDVsLjM2My40NDVjMi4xMTkgMi42MSA1Ljk3IDMuNDQyIDguNTIyIDEuMjY0bDIuNjQ2LTIuNzUxYy0zLjY3Ni00LjMzMi03LjMyOC04Ljk2OC0xMC40NDMtMTMuMjc2bC02LjgzNyA2LjgxM3oiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDExLjcwNykiLz48L2c+PC9zdmc+Cg==",ConfirmationDialog=function(_ref){var onDismiss=_ref.onDismiss,onConfirm=_ref.onConfirm,plan=_ref.plan,customer=_ref.customer,periodEndDate=_ref.periodEndDate,webIconURL=Object(utils.a)(plan).webIconURL,last4=customer.last4;return react_default.a.createElement(DialogMessage.b,{onDismiss:onDismiss},react_default.a.createElement("img",{className:"fpn-reactivate-subscription",alt:plan.product_name,src:webIconURL||fpn,height:"48",width:"48"}),react_default.a.createElement("h4",null,"Want to keep using ",plan.product_name,"?"),react_default.a.createElement("p",null,"Your access to ",plan.product_name," will continue, and your billing cycle and payment will stay the same. Your next charge will be $",Object(formats.a)(plan.amount)," to the card ending in ",last4," on"," ",periodEndDate,"."),react_default.a.createElement("div",{className:"action"},react_default.a.createElement("button",{className:"settings-button",onClick:onConfirm,"data-testid":"reactivate-subscription-confirm-button"},react_default.a.createElement("span",{className:"change-button"},"Resubscribe"))))},ManagementPanel=function(_ref){var plan=_ref.plan,customerSubscription=_ref.customerSubscription,subscription=_ref.subscription,customer=_ref.customer,reactivateSubscription=_ref.reactivateSubscription,subscription_id=customerSubscription.subscription_id,_useBooleanState=Object(hooks.a)(),_useBooleanState2=Object(slicedToArray.a)(_useBooleanState,3),reactivateConfirmationRevealed=_useBooleanState2[0],revealReactivateConfirmation=_useBooleanState2[1],hideReactivateConfirmation=_useBooleanState2[2],onReactivateClick=Object(react.useCallback)((function(){reactivateSubscription(subscription_id,plan),hideReactivateConfirmation()}),[reactivateSubscription,plan,subscription_id,hideReactivateConfirmation]),cancelledAtDate=subscription.cancelledAt?Object(formats.b)(subscription.cancelledAt/1e3):null,periodEndDate=Object(formats.b)(customerSubscription.current_period_end);return react_default.a.createElement(react_default.a.Fragment,null,reactivateConfirmationRevealed&&react_default.a.createElement(ConfirmationDialog,Object.assign({plan:plan,customer:customer,periodEndDate:periodEndDate},{onDismiss:hideReactivateConfirmation,onConfirm:onReactivateClick})),react_default.a.createElement("div",{className:"subscription-cancelled"},react_default.a.createElement("div",{className:"with-settings-button"},react_default.a.createElement("div",{className:"subscription-cancelled-details"},cancelledAtDate&&react_default.a.createElement("p",{"data-testid":"subscription-cancelled-date"},"You cancelled your subscription on ",cancelledAtDate,"."),react_default.a.createElement("p",null,"You will lose access to ",plan.product_name," on"," ",react_default.a.createElement("strong",null,periodEndDate),".")),react_default.a.createElement("div",{className:"action"},react_default.a.createElement("button",{className:"settings-button",onClick:revealReactivateConfirmation,"data-testid":"reactivate-subscription-button"},react_default.a.createElement("span",{className:"change-button"},"Resubscribe"))))))},SubscriptionItem_CancelSubscriptionPanel=function CancelSubscriptionPanel(_ref2){var plan=_ref2.plan,cancelSubscription=_ref2.cancelSubscription,_ref2$customerSubscri=_ref2.customerSubscription,subscription_id=_ref2$customerSubscri.subscription_id,current_period_end=_ref2$customerSubscri.current_period_end,cancelSubscriptionStatus=_ref2.cancelSubscriptionStatus,_useBooleanState=Object(hooks.a)(),_useBooleanState2=Object(slicedToArray.a)(_useBooleanState,3),cancelRevealed=_useBooleanState2[0],revealCancel=_useBooleanState2[1],hideCancel=_useBooleanState2[2],_useCheckboxState=Object(hooks.c)(),_useCheckboxState2=Object(slicedToArray.a)(_useCheckboxState,2),confirmationChecked=_useCheckboxState2[0],onConfirmationChanged=_useCheckboxState2[1],confirmCancellation=Object(react.useCallback)((function(){cancelSubscription(subscription_id,plan)}),[cancelSubscription,subscription_id,plan]),viewed=Object(react.useRef)(!1),engaged=Object(react.useRef)(!1);Object(react.useEffect)((function(){!viewed.current&&cancelRevealed&&(amplitude.b(plan),viewed.current=!0)}),[cancelRevealed,viewed,plan]);var engage=Object(react.useCallback)((function(){engaged.current||(amplitude.a(plan),engaged.current=!0)}),[engaged,plan]),engagedOnHideCancel=Object(react.useCallback)((function(){engage(),hideCancel()}),[hideCancel,engage]),engagedOnConfirmationChanged=Object(react.useCallback)((function(evt){engage(),onConfirmationChanged(evt)}),[onConfirmationChanged,engage]);return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("div",{className:"cancel-subscription"},cancelRevealed?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("h3",null,"Cancel Subscription"),react_default.a.createElement("p",null,"You will no longer be able to use ",plan.product_name," after"," ",Object(formats.b)(current_period_end),", the last day of your billing cycle."),react_default.a.createElement("p",null,react_default.a.createElement("label",null,react_default.a.createElement("input",{"data-testid":"confirm-cancel-subscription-checkbox",type:"checkbox",defaultChecked:confirmationChecked,onChange:engagedOnConfirmationChanged}),react_default.a.createElement("span",null,"Cancel my access and my saved information within"," ",plan.product_name," on"," ",Object(formats.b)(current_period_end)))),react_default.a.createElement("div",{className:"button-row"},react_default.a.createElement("button",{className:"settings-button primary-button",onClick:engagedOnHideCancel},"Stay Subscribed"),react_default.a.createElement("button",{"data-testid":"cancel-subscription-button",className:"settings-button secondary-button",onClick:confirmCancellation,disabled:cancelSubscriptionStatus.loading||!confirmationChecked},cancelSubscriptionStatus.loading?react_default.a.createElement("span",{"data-testid":"spinner-update",className:"spinner"}," "):react_default.a.createElement("span",null,"Cancel Subscription")))):react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("div",{className:"with-settings-button"},react_default.a.createElement("div",{className:"card-details"},react_default.a.createElement("h3",null,"Cancel Subscription")),react_default.a.createElement("div",{className:"action"},react_default.a.createElement("button",{className:"settings-button",onClick:revealCancel,"data-testid":"reveal-cancel-subscription-button"},react_default.a.createElement("span",{className:"change-button"},"Cancel")))))))},Subscriptions_SubscriptionItem=function SubscriptionItem(_ref){var subscription=_ref.subscription,cancelSubscription=_ref.cancelSubscription,cancelSubscriptionStatus=_ref.cancelSubscriptionStatus,reactivateSubscription=_ref.reactivateSubscription,customer=_ref.customer,plan=_ref.plan,updatePayment=_ref.updatePayment,resetUpdatePayment=_ref.resetUpdatePayment,updatePaymentStatus=_ref.updatePaymentStatus,customerSubscription=_ref.customerSubscription,locationReload=Object(react.useContext)(AppContext.b).locationReload;return subscription?plan?react_default.a.createElement("div",{className:"settings-unit"},react_default.a.createElement("div",{className:"subscription","data-testid":"subscription-item"},react_default.a.createElement("header",null,react_default.a.createElement("h2",null,plan.product_name)),customerSubscription.cancel_at_period_end?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(ManagementPanel,{plan:plan,customer:customer,customerSubscription:customerSubscription,subscription:subscription,reactivateSubscription:reactivateSubscription})):react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(Subscriptions_PaymentUpdateForm,{plan:plan,customerSubscription:customerSubscription,customer:customer,updatePayment:updatePayment,resetUpdatePayment:resetUpdatePayment,updatePaymentStatus:updatePaymentStatus}),react_default.a.createElement(SubscriptionItem_CancelSubscriptionPanel,{cancelSubscription:cancelSubscription,cancelSubscriptionStatus:cancelSubscriptionStatus,customerSubscription:customerSubscription,plan:plan})))):react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:locationReload},react_default.a.createElement("h4",{"data-testid":"error-subhub-missing-plan"},"Plan not found"),react_default.a.createElement("p",null,"No such plan for this subscription.")):react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:locationReload},react_default.a.createElement("h4",{"data-testid":"error-fxa-missing-subscription"},"Problem loading subscriptions"),react_default.a.createElement("p",null,"Please try again later."))},SuccessDialog=function(_ref){var plan=_ref.plan,onDismiss=_ref.onDismiss,productName=plan.product_name,webIconURL=Object(utils.a)(plan).webIconURL;return react_default.a.createElement(DialogMessage.b,{onDismiss:onDismiss,"data-testid":"reactivate-subscription-success-dialog"},react_default.a.createElement("img",{alt:productName,src:webIconURL||fpn,width:"96",height:"96"}),react_default.a.createElement("p",{"data-testid":"reactivate-subscription-success",className:"reactivate-subscription-success"},"Thanks! You're all set."),react_default.a.createElement("button",{className:"settings-button",onClick:onDismiss,"data-testid":"reactivate-subscription-success-button"},"Close"))},AlertBar=__webpack_require__(129),FetchErrorDialogMessage=__webpack_require__(75),LoadingOverlay=__webpack_require__(91),CloseIcon=__webpack_require__(174);__webpack_require__.d(__webpack_exports__,"a",(function(){return Subscriptions_Subscriptions}));var Subscriptions_Subscriptions=function Subscriptions(_ref){var profile=_ref.profile,customer=_ref.customer,plans=_ref.plans,subscriptions=_ref.subscriptions,customerSubscriptions=_ref.customerSubscriptions,fetchSubscriptionsRouteResources=_ref.fetchSubscriptionsRouteResources,cancelSubscription=_ref.cancelSubscription,cancelSubscriptionStatus=_ref.cancelSubscriptionStatus,reactivateSubscription=_ref.reactivateSubscription,reactivateSubscriptionStatus=_ref.reactivateSubscriptionStatus,resetReactivateSubscription=_ref.resetReactivateSubscription,updatePayment=_ref.updatePayment,resetUpdatePayment=_ref.resetUpdatePayment,resetCancelSubscription=_ref.resetCancelSubscription,updatePaymentStatus=_ref.updatePaymentStatus,_useContext=Object(react.useContext)(AppContext.a),config=_useContext.config,locationReload=_useContext.locationReload,navigateToUrl=_useContext.navigateToUrl,_useState=Object(react.useState)(!0),_useState2=Object(slicedToArray.a)(_useState,2),showPaymentSuccessAlert=_useState2[0],setShowPaymentSuccessAlert=_useState2[1],clearSuccessAlert=Object(react.useCallback)((function(){return setShowPaymentSuccessAlert(!1)}),[setShowPaymentSuccessAlert]),SUPPORT_FORM_URL="".concat(config.servers.content.url,"/support"),engaged=Object(react.useRef)(!1);Object(react.useEffect)((function(){amplitude.l()}),[]);var onAnyClick=Object(react.useCallback)((function(evt){engaged.current||"BUTTON"!==evt.target.tagName&&"BUTTON"!==evt.target.parentNode.tagName||(amplitude.k(),engaged.current=!0)}),[engaged]);Object(react.useEffect)((function(){fetchSubscriptionsRouteResources()}),[fetchSubscriptionsRouteResources]);var onSupportClick=Object(react.useCallback)((function(){return navigateToUrl(SUPPORT_FORM_URL)}),[navigateToUrl,SUPPORT_FORM_URL]);if(customer.loading||subscriptions.loading||profile.loading||plans.loading)return react_default.a.createElement(LoadingOverlay.a,{isLoading:!0});if(!profile.result||null!==profile.error)return react_default.a.createElement(FetchErrorDialogMessage.a,{testid:"error-loading-profile",title:"Problem loading profile",fetchState:profile,onDismiss:locationReload});if(!plans.result||null!==plans.error)return react_default.a.createElement(FetchErrorDialogMessage.a,{testid:"error-loading-plans",title:"Problem loading plans",fetchState:plans,onDismiss:locationReload});if(!subscriptions.result||null!==subscriptions.error)return react_default.a.createElement(FetchErrorDialogMessage.a,{testid:"error-subscriptions-fetch",title:"Problem loading subscriptions",fetchState:subscriptions,onDismiss:locationReload});if(customer.error&&customer.error.errno!==errors.a.UNKNOWN_SUBSCRIPTION_CUSTOMER)return react_default.a.createElement(FetchErrorDialogMessage.a,{testid:"error-loading-customer",title:"Problem loading customer",fetchState:customer,onDismiss:locationReload});if(customerSubscriptions&&0===customerSubscriptions.length||customer.error&&customer.error.errno===errors.a.UNKNOWN_SUBSCRIPTION_CUSTOMER){var SETTINGS_URL="".concat(config.servers.content.url,"/settings");return navigateToUrl(SETTINGS_URL),react_default.a.createElement(LoadingOverlay.a,{isLoading:!0})}return react_default.a.createElement("div",{className:"subscription-management",onClick:onAnyClick},customerSubscriptions&&null!==cancelSubscriptionStatus.result&&react_default.a.createElement(Subscriptions_CancellationDialogMessage,{subscription:cancelSubscriptionStatus.result,customerSubscriptions:customerSubscriptions,plans:plans.result,resetCancelSubscription:resetCancelSubscription,supportFormUrl:SUPPORT_FORM_URL}),updatePaymentStatus.result&&showPaymentSuccessAlert&&react_default.a.createElement(AlertBar.b,{className:"alert alertSuccess alertCenter"},react_default.a.createElement("span",{"data-testid":"success-billing-update",className:"checked"},"Your billing information has been updated successfully"),react_default.a.createElement("span",{"data-testid":"clear-success-alert",className:"close","aria-label":"Close modal",onClick:clearSuccessAlert},react_default.a.createElement(CloseIcon.a,{className:"close"}))),updatePaymentStatus.loading&&react_default.a.createElement(AlertBar.b,{className:"alert alertPending"},react_default.a.createElement("span",null,"Updating billing information...")),reactivateSubscriptionStatus.error&&react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:resetReactivateSubscription},react_default.a.createElement("h4",{"data-testid":"error-reactivation"},"Reactivating subscription failed"),react_default.a.createElement("p",null,reactivateSubscriptionStatus.error.message)),reactivateSubscriptionStatus.result&&react_default.a.createElement(SuccessDialog,{plan:reactivateSubscriptionStatus.result.plan,onDismiss:resetReactivateSubscription}),cancelSubscriptionStatus.error&&react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:resetCancelSubscription},react_default.a.createElement("h4",{"data-testid":"error-cancellation"},"Cancelling subscription failed"),react_default.a.createElement("p",null,cancelSubscriptionStatus.error.message)),profile.result&&react_default.a.createElement(Subscriptions_ProfileBanner,{profile:profile.result}),react_default.a.createElement("div",{className:"child-views","data-testid":"subscription-management-loaded"},react_default.a.createElement("div",{className:"settings-child-view support"},react_default.a.createElement("div",{className:"settings-unit"},react_default.a.createElement("div",{className:"settings-unit-stub"},react_default.a.createElement("header",{className:"settings-unit-summary"},react_default.a.createElement("h2",{className:"settings-unit-title"},"Subscriptions")),react_default.a.createElement("button",{"data-testid":"contact-support-button",className:"settings-button primary-button settings-unit-toggle",onClick:onSupportClick},react_default.a.createElement("span",{className:"change-button"},"Contact Support")))),customer.result&&customerSubscriptions&&customerSubscriptions.map((function(customerSubscription,idx){return react_default.a.createElement(Subscriptions_SubscriptionItem,Object.assign({key:idx},{customer:customer.result,updatePayment:updatePayment,resetUpdatePayment:resetUpdatePayment,updatePaymentStatus:updatePaymentStatus,cancelSubscription:cancelSubscription,reactivateSubscription:reactivateSubscription,customerSubscription:customerSubscription,cancelSubscriptionStatus:cancelSubscriptionStatus,plan:planForId(customerSubscription.plan_id,plans.result),subscription:subscriptionForId(customerSubscription.subscription_id,subscriptions.result)}))})))))},subscriptionForId=function subscriptionForId(subscriptionId,subscriptions){return subscriptions.filter((function(subscription){return subscription.subscriptionId===subscriptionId}))[0]},planForId=function planForId(planId,plans){return plans.filter((function(plan){return plan.plan_id===planId}))[0]},Subscriptions_CancellationDialogMessage=function CancellationDialogMessage(_ref2){var subscription=_ref2.subscription,customerSubscriptions=_ref2.customerSubscriptions,plans=_ref2.plans,resetCancelSubscription=_ref2.resetCancelSubscription,supportFormUrl=_ref2.supportFormUrl,customerSubscription=function customerSubscriptionForId(subscriptionId,customerSubscriptions){return customerSubscriptions.filter((function(subscription){return subscription.subscription_id===subscriptionId}))[0]}(subscription.subscriptionId,customerSubscriptions),plan=planForId(customerSubscription.plan_id,plans),periodEndDate=dayjs_min_default.a.unix(customerSubscription.current_period_end).format("MMMM DD, YYYY");return react_default.a.createElement(DialogMessage.b,{onDismiss:resetCancelSubscription},react_default.a.createElement("h4",{"data-testid":"cancellation-message-title"},"We're sorry to see you go"),react_default.a.createElement("p",null,"Your ",plan.product_name," subscription has been cancelled.",react_default.a.createElement("br",null),"You will still have access to ",plan.product_name," until ",periodEndDate,"."),react_default.a.createElement("p",{className:"small"},"Have questions? Visit ",react_default.a.createElement("a",{href:supportFormUrl},"Mozilla Support"),"."))},Subscriptions_ProfileBanner=function ProfileBanner(_ref3){var _ref3$profile=_ref3.profile,email=_ref3$profile.email,avatar=_ref3$profile.avatar,displayName=_ref3$profile.displayName;return react_default.a.createElement("header",{id:"fxa-settings-profile-header-wrapper"},react_default.a.createElement("div",{className:"avatar-wrapper avatar-settings-view nohover"},react_default.a.createElement("img",{src:avatar,alt:displayName||email,className:"profile-image"})),react_default.a.createElement("div",{id:"fxa-settings-profile-header"},react_default.a.createElement("h1",{className:"card-header"},displayName||email),displayName&&react_default.a.createElement("h2",{className:"card-subheader"},email)))};Object(es.a)((function(state){return{plans:selectors.a.plans(state),profile:selectors.a.profile(state),customer:selectors.a.customer(state),customerSubscriptions:selectors.a.customerSubscriptions(state),subscriptions:selectors.a.subscriptions(state),updatePaymentStatus:selectors.a.updatePaymentStatus(state),cancelSubscriptionStatus:selectors.a.cancelSubscriptionStatus(state),reactivateSubscriptionStatus:selectors.a.reactivateSubscriptionStatus(state),plansByProductId:selectors.a.plansByProductId(state)}}),{fetchSubscriptionsRouteResources:sequences.a.fetchSubscriptionsRouteResources,updatePayment:sequences.a.updatePaymentAndRefresh,resetUpdatePayment:actions.a.resetUpdatePayment,cancelSubscription:sequences.a.cancelSubscriptionAndRefresh,resetCancelSubscription:actions.a.resetCancelSubscription,reactivateSubscription:sequences.a.reactivateSubscriptionAndRefresh,resetReactivateSubscription:actions.a.resetReactivateSubscription})(Subscriptions_Subscriptions)},331:function(module,__webpack_exports__,__webpack_require__){"use strict";var defineProperty=__webpack_require__(5),react=__webpack_require__(0),react_default=__webpack_require__.n(react),es=__webpack_require__(173),errors=__webpack_require__(66),AppContext=__webpack_require__(28),LoadingOverlay=__webpack_require__(91),sequences=__webpack_require__(74),actions=__webpack_require__(24),selectors=__webpack_require__(25),utils=__webpack_require__(54),DialogMessage=(__webpack_require__(674),__webpack_require__(14)),FetchErrorDialogMessage=__webpack_require__(75),routes_Product_SubscriptionRedirect=(__webpack_require__(675),function SubscriptionRedirect(_ref){var plan=_ref.plan,product_id=plan.product_id,downloadURL=Object(utils.a)(plan).downloadURL,_useContext=Object(react.useContext)(AppContext.a),_useContext$config=_useContext.config,env=_useContext$config.env,productRedirectURLs=_useContext$config.productRedirectURLs,surveyGizmoUrl=_useContext$config.servers.surveyGizmo.url,navigateToUrl=_useContext.navigateToUrl,surveyEmbedUrl="".concat(surveyGizmoUrl,"/s3/5294819/VPN-Subscription?__no_style=true&env=").concat(env),redirectUrl=downloadURL||productRedirectURLs[product_id]||"https://mozilla.org";return Object(react.useEffect)((function(){var handleIframeTask=function handleIframeTask(e){"submitted survey"===e.data&&setTimeout((function(){navigateToUrl(redirectUrl)}),250)};return window.addEventListener("message",handleIframeTask),function(){return window.removeEventListener("message",handleIframeTask)}}),[navigateToUrl,redirectUrl]),react_default.a.createElement("div",{className:"product-payment","data-testid":"subscription-redirect"},react_default.a.createElement("div",{className:"subscription-ready"},react_default.a.createElement("div",{className:"subscription-message"},react_default.a.createElement("h2",null,"Your subscription is ready"),react_default.a.createElement("div",{className:"exp-message"},"Please take a moment to tell us about your experience.")),react_default.a.createElement("hr",null),react_default.a.createElement("div",{className:"survey-frame"},react_default.a.createElement("iframe",{"data-testid":"survey-iframe",title:"survey",sandbox:"allow-scripts allow-forms",scrolling:"no",src:surveyEmbedUrl})),react_default.a.createElement("div",null,react_default.a.createElement("a",{href:redirectUrl,className:"download-link","data-testid":"download-link"},"No thanks, just take me to my product."))))}),slicedToArray=__webpack_require__(7),AppLayout=__webpack_require__(29),PaymentForm=__webpack_require__(104),ErrorMessage=__webpack_require__(107),loadDetails123DonePro=(__webpack_require__(677),function loadDetails123DonePro(){return __webpack_require__.e(3).then(__webpack_require__.bind(null,689))}),availableDetails={fortressProMonthly:react_default.a.lazy(loadDetails123DonePro),plan_FUUOYlhpIhWtoo:react_default.a.lazy(loadDetails123DonePro),plan_F4bof27uz71Vk7:react_default.a.lazy(loadDetails123DonePro),prod_FfiuDs9u11ESbD:react_default.a.lazy(loadDetails123DonePro)},defaultDetails=react_default.a.lazy((function(){return __webpack_require__.e(4).then(__webpack_require__.bind(null,690))})),routes_Product_PlanDetails=function PlanDetails(_ref){var plan=_ref.plan,Details=plan.plan_id in availableDetails?availableDetails[plan.plan_id]:defaultDetails;return react_default.a.createElement(Details,{plan:plan})},ProfileBanner=__webpack_require__(172),AccountActivatedBanner=function(_ref){var _ref$profile=_ref.profile,email=_ref$profile.email,displayName=_ref$profile.displayName;return react_default.a.createElement("div",{"data-testid":"account-activated",className:"account-activated"},react_default.a.createElement("h2",null,"Your account is activated,"," ",displayName?react_default.a.createElement("span",{"data-testid":"activated-display-name",className:"displayName"},displayName):react_default.a.createElement("span",{"data-testid":"activated-email",className:"email"},email)))},amplitude=__webpack_require__(6),Product_SubscriptionCreate=function SubscriptionCreate(_ref){var profile=_ref.profile,accountActivated=_ref.accountActivated,selectedPlan=_ref.selectedPlan,createSubscriptionAndRefresh=_ref.createSubscriptionAndRefresh,createSubscriptionStatus=_ref.createSubscriptionStatus,resetCreateSubscription=_ref.resetCreateSubscription,validatorInitialState=_ref.validatorInitialState,setHideLogo=Object(react.useContext)(AppLayout.c).setHideLogo;Object(react.useEffect)((function(){setHideLogo(!accountActivated)}),[setHideLogo,accountActivated]);var onFormMounted=Object(react.useCallback)((function(){return amplitude.g(selectedPlan)}),[selectedPlan]),onFormEngaged=Object(react.useCallback)((function(){return amplitude.f(selectedPlan)}),[selectedPlan]);Object(react.useEffect)((function(){resetCreateSubscription()}),[resetCreateSubscription]);var _useState=Object(react.useState)({type:"",error:!1}),_useState2=Object(slicedToArray.a)(_useState,2),createTokenError=_useState2[0],setCreateTokenError=_useState2[1],inProgress=createSubscriptionStatus.loading,isCardError=null!==createSubscriptionStatus.error&&("card_declined"===createSubscriptionStatus.error.code||"incorrect_cvc"===createSubscriptionStatus.error.code),onChange=Object(react.useCallback)((function(){createTokenError.error?setCreateTokenError({type:"",error:!1}):isCardError&&resetCreateSubscription()}),[createTokenError,setCreateTokenError,resetCreateSubscription,isCardError]),onPayment=Object(react.useCallback)((function(tokenResponse,name){if(tokenResponse&&tokenResponse.token)createSubscriptionAndRefresh(tokenResponse.token.id,selectedPlan,name);else{setCreateTokenError({type:"api_error",error:!0})}}),[selectedPlan,createSubscriptionAndRefresh,setCreateTokenError]),onPaymentError=Object(react.useCallback)((function(error){error.error=!0,setCreateTokenError(error)}),[setCreateTokenError]);return react_default.a.createElement("div",{className:"product-payment","data-testid":"subscription-create"},accountActivated?react_default.a.createElement(AccountActivatedBanner,{profile:profile}):react_default.a.createElement(ProfileBanner.a,{profile:profile}),react_default.a.createElement("hr",null),react_default.a.createElement(routes_Product_PlanDetails,{plan:selectedPlan}),react_default.a.createElement("hr",null),react_default.a.createElement("h3",{className:"billing-title"},react_default.a.createElement("span",{className:"title"},"Billing Information")),react_default.a.createElement(ErrorMessage.a,{isVisible:!!createTokenError.error},createTokenError.error&&react_default.a.createElement("p",{"data-testid":"error-payment-submission"},Object(errors.b)(createTokenError.type))),react_default.a.createElement(ErrorMessage.a,{isVisible:isCardError},react_default.a.createElement("p",{"data-testid":"error-card-rejected"},Object(errors.b)("card_error"))),createSubscriptionStatus.error&&!isCardError&&react_default.a.createElement(DialogMessage.b,{className:"dialog-error",onDismiss:resetCreateSubscription},react_default.a.createElement("h4",{"data-testid":"error-subscription-failed"},"Subscription failed"),react_default.a.createElement("p",null,createSubscriptionStatus.error.message)),react_default.a.createElement(PaymentForm.a,{onPayment:onPayment,onPaymentError:onPaymentError,onChange:onChange,inProgress:inProgress,validatorInitialState:validatorInitialState,confirm:!0,plan:selectedPlan,onMounted:onFormMounted,onEngaged:onFormEngaged}))},SubscriptionUpgrade=__webpack_require__(171);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}__webpack_require__.d(__webpack_exports__,"a",(function(){return Product_Product}));var Product_Product=function Product(_ref){var productId=_ref.match.params.productId,profile=_ref.profile,plans=_ref.plans,customer=_ref.customer,customerSubscriptions=_ref.customerSubscriptions,createSubscriptionStatus=_ref.createSubscriptionStatus,plansByProductId=_ref.plansByProductId,createSubscriptionAndRefresh=_ref.createSubscriptionAndRefresh,resetCreateSubscription=_ref.resetCreateSubscription,fetchProductRouteResources=_ref.fetchProductRouteResources,validatorInitialState=_ref.validatorInitialState,updateSubscriptionPlanAndRefresh=_ref.updateSubscriptionPlanAndRefresh,resetUpdateSubscriptionPlan=_ref.resetUpdateSubscriptionPlan,updateSubscriptionPlanStatus=_ref.updateSubscriptionPlanStatus,_useContext=Object(react.useContext)(AppContext.a),locationReload=_useContext.locationReload,queryParams=_useContext.queryParams,planId=queryParams.plan,accountActivated=!!queryParams.activated;Object(react.useEffect)((function(){fetchProductRouteResources()}),[fetchProductRouteResources]);var plansById=Object(react.useMemo)((function(){return Product_indexPlansById(plans)}),[plans]),productPlans=plansByProductId(productId),selectedPlan=productPlans.filter((function(plan){return plan.plan_id===planId}))[0];if(selectedPlan||(selectedPlan=productPlans[0]),customer.loading||plans.loading||profile.loading)return react_default.a.createElement(LoadingOverlay.a,{isLoading:!0});if(!plans.result||null!==plans.error)return react_default.a.createElement(FetchErrorDialogMessage.a,{testid:"error-loading-plans",title:"Problem loading plans",fetchState:plans,onDismiss:locationReload});if(!profile.result||null!==profile.error)return react_default.a.createElement(FetchErrorDialogMessage.a,{testid:"error-loading-profile",title:"Problem loading profile",fetchState:profile,onDismiss:locationReload});if(customer.error&&customer.error.errno!==errors.a.UNKNOWN_SUBSCRIPTION_CUSTOMER)return react_default.a.createElement(FetchErrorDialogMessage.a,{testid:"error-loading-customer",title:"Problem loading customer",fetchState:customer,onDismiss:locationReload});if(!selectedPlan)return react_default.a.createElement(DialogMessage.b,{className:"dialog-error"},react_default.a.createElement("h4",null,"Plan not found"),react_default.a.createElement("p",{"data-testid":"no-such-plan-error"},"No such plan for this product."));if(customer.result){var upgradeFrom=findUpgradeFromPlan(customerSubscriptions,selectedPlan,plansById);if(upgradeFrom)return react_default.a.createElement(SubscriptionUpgrade.a,{profile:profile.result,customer:customer.result,selectedPlan:selectedPlan,upgradeFromPlan:upgradeFrom.plan,upgradeFromSubscription:upgradeFrom.subscription,updateSubscriptionPlanAndRefresh:updateSubscriptionPlanAndRefresh,resetUpdateSubscriptionPlan:resetUpdateSubscriptionPlan,updateSubscriptionPlanStatus:updateSubscriptionPlanStatus});if(customerIsSubscribedToProduct(customerSubscriptions,productPlans))return react_default.a.createElement(routes_Product_SubscriptionRedirect,{plan:selectedPlan})}return react_default.a.createElement(Product_SubscriptionCreate,{profile:profile.result,accountActivated:accountActivated,selectedPlan:selectedPlan,createSubscriptionAndRefresh:createSubscriptionAndRefresh,createSubscriptionStatus:createSubscriptionStatus,resetCreateSubscription:resetCreateSubscription,validatorInitialState:validatorInitialState})},Product_indexPlansById=function indexPlansById(plans){return(plans.result||[]).reduce((function(acc,plan){return function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach((function(key){Object(defineProperty.a)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},acc,Object(defineProperty.a)({},plan.plan_id,{plan:plan,metadata:Object(utils.a)(plan)}))}),{})},customerIsSubscribedToProduct=function customerIsSubscribedToProduct(customerSubscriptions,productPlans){return customerSubscriptions&&customerSubscriptions.some((function(customerSubscription){return productPlans.some((function(plan){return plan.plan_id===customerSubscription.plan_id}))}))},findUpgradeFromPlan=function findUpgradeFromPlan(customerSubscriptions,selectedPlan,plansById){if(customerSubscriptions){var selectedPlanInfo=plansById[selectedPlan.plan_id],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=customerSubscriptions[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var customerSubscription=_step.value,subscriptionPlanInfo=plansById[customerSubscription.plan_id];if(selectedPlan.plan_id!==customerSubscription.plan_id&&selectedPlanInfo.metadata.productSet&&subscriptionPlanInfo.metadata.productSet&&selectedPlanInfo.metadata.productSet===subscriptionPlanInfo.metadata.productSet)return{plan:subscriptionPlanInfo.plan,subscription:customerSubscription}}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}return null};Object(es.a)((function(state){return{customer:selectors.a.customer(state),customerSubscriptions:selectors.a.customerSubscriptions(state),profile:selectors.a.profile(state),plans:selectors.a.plans(state),createSubscriptionStatus:selectors.a.createSubscriptionStatus(state),updateSubscriptionPlanStatus:selectors.a.updateSubscriptionPlanStatus(state),plansByProductId:selectors.a.plansByProductId(state)}}),{resetCreateSubscription:actions.a.resetCreateSubscription,fetchProductRouteResources:sequences.a.fetchProductRouteResources,createSubscriptionAndRefresh:sequences.a.createSubscriptionAndRefresh,updateSubscriptionPlanAndRefresh:sequences.a.updateSubscriptionPlanAndRefresh,resetUpdateSubscriptionPlan:actions.a.resetUpdateSubscriptionPlan})(Product_Product)},336:function(module,exports,__webpack_require__){__webpack_require__(337),__webpack_require__(448),module.exports=__webpack_require__(449)},34:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return useCallbackOnce})),__webpack_require__.d(__webpack_exports__,"a",(function(){return useBooleanState})),__webpack_require__.d(__webpack_exports__,"c",(function(){return useCheckboxState})),__webpack_require__.d(__webpack_exports__,"d",(function(){return useClickOutsideEffect}));var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(332),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0);function useCallbackOnce(cb,deps){var called=Object(react__WEBPACK_IMPORTED_MODULE_2__.useRef)(!1);return Object(react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((function(){called.current||(cb(),called.current=!0)}),[called,cb].concat(Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(deps)))}function useBooleanState(){var defaultState=arguments.length>0&&void 0!==arguments[0]&&arguments[0],_useState=Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(defaultState),_useState2=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useState,2),state=_useState2[0],setState=_useState2[1];return[state,Object(react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((function(){return setState(!0)}),[setState]),Object(react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((function(){return setState(!1)}),[setState])]}function useCheckboxState(){var defaultState=arguments.length>0&&void 0!==arguments[0]&&arguments[0],_useState3=Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(defaultState),_useState4=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useState3,2),state=_useState4[0],setState=_useState4[1];return[state,Object(react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((function(ev){return setState(ev.target.checked)}),[setState])]}function useClickOutsideEffect(onClickOutside){var insideEl=Object(react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);return Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){var onBodyClick=function onBodyClick(ev){insideEl.current instanceof HTMLElement&&ev.target instanceof HTMLElement&&!insideEl.current.contains(ev.target)&&onClickOutside()};return document.body.addEventListener("click",onBodyClick),function(){return document.body.removeEventListener("click",onBodyClick)}}),[onClickOutside]),insideEl}},358:function(module,exports){},36:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return Form})),__webpack_require__.d(__webpack_exports__,"b",(function(){return FieldGroup})),__webpack_require__.d(__webpack_exports__,"d",(function(){return Input})),__webpack_require__.d(__webpack_exports__,"e",(function(){return StripeElement})),__webpack_require__.d(__webpack_exports__,"a",(function(){return Checkbox})),__webpack_require__.d(__webpack_exports__,"f",(function(){return SubmitButton}));var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(81),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__),classnames__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(72),classnames__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_3__),_Tooltip__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(166);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach((function(key){Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var FormContext=react__WEBPACK_IMPORTED_MODULE_2___default.a.createContext(null),Form=function Form(props){var children=props.children,validator=props.validator,formProps=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__.a)(props,["children","validator"]);return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("form",formProps,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(FormContext.Provider,{value:{validator:validator}},children))},FieldGroup=function FieldGroup(_ref){var children=_ref.children;return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div",{className:"input-row-group"},children)},Field=function Field(_ref2){var tooltipParentRef=_ref2.tooltipParentRef,fieldType=_ref2.fieldType,name=_ref2.name,_ref2$initialValue=_ref2.initialValue,initialValue=void 0===_ref2$initialValue?null:_ref2$initialValue,_ref2$tooltip=_ref2.tooltip,tooltip=void 0===_ref2$tooltip||_ref2$tooltip,_ref2$required=_ref2.required,required=void 0!==_ref2$required&&_ref2$required,_ref2$autoFocus=_ref2.autoFocus,autoFocus=void 0!==_ref2$autoFocus&&_ref2$autoFocus,label=_ref2.label,_ref2$className=_ref2.className,className=void 0===_ref2$className?"input-row":_ref2$className,children=_ref2.children,validator=Object(react__WEBPACK_IMPORTED_MODULE_2__.useContext)(FormContext).validator;Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){return validator.registerField({name:name,initialValue:initialValue,required:required,fieldType:fieldType})}),[name,required,fieldType]);var focusElement=autoFocus&&tooltipParentRef&&tooltipParentRef.current;return Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){focusElement&&focusElement.focus&&setTimeout((function(){focusElement.focus()}),200)}),[focusElement]),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div",{className:className},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("label",null,label&&react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("span",{className:"label-text"},label),tooltip&&tooltipParentRef&&validator.getError(name)&&react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_Tooltip__WEBPACK_IMPORTED_MODULE_4__.b,{parentRef:tooltipParentRef},validator.getError(name)),children))},defaultInputValidator=function defaultInputValidator(value,focused,props){return props.required&&null!==value&&!value?{value:value,valid:!1,error:focused?null:"This field is required"}:{value:value,valid:!0,error:null}},Input=function Input(props){var name=props.name,label=props.label,initialValue=props.initialValue,_props$onValidate=props.onValidate,onValidate=void 0===_props$onValidate?defaultInputValidator:_props$onValidate,tooltip=props.tooltip,autoFocus=props.autoFocus,_props$required=props.required,required=void 0!==_props$required&&_props$required,className=props.className,childProps=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__.a)(props,["name","label","initialValue","onValidate","tooltip","autoFocus","required","className"]),validator=Object(react__WEBPACK_IMPORTED_MODULE_2__.useContext)(FormContext).validator,onChange=Object(react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((function(ev){var value=ev.target.value;validator.updateField(_objectSpread({name:name},onValidate(value,!0,props)))}),[name,props,validator,onValidate]),onBlur=Object(react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((function(ev){var value=ev.target.value;validator.updateField(_objectSpread({name:name},onValidate(value,!1,props)))}),[name,props,validator,onValidate]),tooltipParentRef=Object(react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,{fieldType:"input",tooltipParentRef:tooltipParentRef,name:name,initialValue:initialValue,tooltip:tooltip,required:required,label:label,className:className,autoFocus:autoFocus},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("input",_objectSpread({},childProps,{ref:tooltipParentRef,name:name,required:required,className:classnames__WEBPACK_IMPORTED_MODULE_3___default()({invalid:validator.isInvalid(name)}),value:validator.getValue(name,""),onBlur:onBlur,onChange:onChange})))},defaultStripeElementValidator=function defaultStripeElementValidator(value,focused,props){if(!value||value.empty){if(props.required)return{value:value,valid:!1,error:focused?null:"".concat(props.label," is required")}}else if(value.error&&value.error.message){var error=value.error.message;return error.endsWith(".")&&(error=error.slice(0,-1)),{value:value,valid:!1,error:focused?"":error}}return{value:value,valid:!(!value||!value.complete)||void 0,error:null}},StripeElement=function StripeElement(props){var StripeElementComponent=props.component,name=props.name,tooltip=props.tooltip,_props$onValidate2=props.onValidate,onValidate=void 0===_props$onValidate2?defaultStripeElementValidator:_props$onValidate2,_props$required2=props.required,required=void 0!==_props$required2&&_props$required2,label=props.label,className=props.className,autoFocus=props.autoFocus,childProps=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__.a)(props,["component","name","tooltip","onValidate","required","label","className","autoFocus"]),validator=Object(react__WEBPACK_IMPORTED_MODULE_2__.useContext)(FormContext).validator,elementValue=Object(react__WEBPACK_IMPORTED_MODULE_2__.useRef)(),onChange=Object(react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((function(value){elementValue.current=value,validator.updateField(_objectSpread({name:name},onValidate(value,!0,props)))}),[name,props,validator,onValidate,elementValue]),onBlur=Object(react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((function(ev){var value=elementValue.current;validator.updateField(_objectSpread({name:name},onValidate(value,!1,props)))}),[name,props,validator,onValidate,elementValue]),tooltipParentRef=Object(react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,{fieldType:"stripe",tooltipParentRef:tooltipParentRef,name:name,tooltip:tooltip,required:required,label:label,className:className,autoFocus:autoFocus},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(StripeElementComponent,_objectSpread({},childProps,{ref:function stripeElementRef(el){el&&(tooltipParentRef.current=el._ref)},onChange:onChange,onBlur:onBlur})))},defaultCheckboxValidator=function defaultCheckboxValidator(value,focused,props){return{value:value,valid:!(props.required&&!value),error:null}},Checkbox=function Checkbox(props){var children=props.children,name=props.name,label=props.label,_props$onValidate3=props.onValidate,onValidate=void 0===_props$onValidate3?defaultCheckboxValidator:_props$onValidate3,_props$required3=props.required,required=void 0!==_props$required3&&_props$required3,_props$className=props.className,className=void 0===_props$className?"input-row input-row--checkbox":_props$className,childProps=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__.a)(props,["children","name","label","onValidate","required","className"]),validator=Object(react__WEBPACK_IMPORTED_MODULE_2__.useContext)(FormContext).validator,onChange=Object(react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((function(ev){var value=ev.target.checked;validator.updateField(_objectSpread({name:name},onValidate(value,!0,props)))}),[name,props,validator,onValidate]);return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,{fieldType:"input",name:name,className:className,required:required,tooltip:!1},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("input",_objectSpread({},childProps,{type:"checkbox",name:name,onChange:onChange})),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("span",{className:"label-text checkbox"},children||label))},SubmitButton=function SubmitButton(props){var name=props.name,children=(props.label,props.children),className=props.className,_props$disabled=props.disabled,disabled=void 0!==_props$disabled&&_props$disabled,childProps=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__.a)(props,["name","label","children","className","disabled"]),validator=Object(react__WEBPACK_IMPORTED_MODULE_2__.useContext)(FormContext).validator,buttonProps={className:className,name:name,disabled:disabled||!validator.allValid()};return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("button",_objectSpread({},childProps,{},buttonProps,{type:"submit"}),children)}},449:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _storybook_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9),reqFromComponents=(__webpack_require__(631),__webpack_require__(632),__webpack_require__(633),__webpack_require__(634)),reqFromRoutes=__webpack_require__(667);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.configure)((function loadStories(){[reqFromComponents,reqFromRoutes].forEach((function(req){return req.keys().forEach((function(filename){return req(filename)}))}))}),module)}.call(this,__webpack_require__(51)(module))},54:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return metadataFromPlan}));var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}var metadataFromPlan=function metadataFromPlan(plan){return function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach((function(key){Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({productSet:null,productOrder:null,emailIconURL:null,webIconURL:null,upgradeCTA:null,downloadURL:null},plan.product_metadata,{},plan.plan_metadata)}},6:function(module,__webpack_exports__,__webpack_require__){"use strict";var defineProperty=__webpack_require__(5),objectWithoutProperties=__webpack_require__(81);function Logger(logWindow){this._window=logWindow||window}Logger.prototype={info:function info(){this._window.console&&this._window.console.info&&this._window.console.info.apply(this._window.console,arguments)},trace:function trace(){this._window.console&&this._window.console.trace&&this._window.console.trace()},warn:function warn(){this._window.console&&this._window.console.warn&&this._window.console.warn.apply(this._window.console,arguments)},error:function error(_error){if(this._window.console&&this._window.console.error){var errorMessage="";_error.errorModule?(errorMessage=_error.errorModule.toInterpolatedMessage(_error),this._window.console.error(errorMessage)):this._window.console.error.apply(this._window.console,arguments)}}};var logger=Logger,sdk=__webpack_require__(688),esm=__webpack_require__(45),ALLOWED_QUERY_PARAMETERS=["automatedBrowser","client_id","context","entrypoint","keys","migration","redirect_uri","scope","service","setting","style"];function beforeSend(data){return data&&data.request&&(data.request.url&&(data.request.url=cleanUpQueryParam(data.request.url)),data.tags&&data.tags.errno&&(data.fingerprint=["errno"+data.tags.errno],data.level="info"),data.exception&&data.exception.values&&data.exception.values.forEach((function(value){value.stacktrace&&value.stacktrace.frames&&value.stacktrace.frames.forEach((function(frame){frame.abs_path&&(frame.abs_path=cleanUpQueryParam(frame.abs_path))}))})),data.request.headers&&data.request.headers.Referer&&(data.request.headers.Referer=cleanUpQueryParam(data.request.headers.Referer))),data}function cleanUpQueryParam(){var url=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",urlObj=new URL(url);if(!urlObj.search.length)return url;var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=urlObj.searchParams[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var key=_step.value[0];ALLOWED_QUERY_PARAMETERS.includes(key)||urlObj.searchParams.set(key,"VALUE")}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return urlObj.href}var exceptionTags=["code","context","errno","namespace","status"];function SentryMetrics(dsn,release){if(this._logger=new logger,this._release=release,dsn)try{sdk.a({release:release,dsn:dsn,beforeSend:beforeSend})}catch(e){this._logger.error(e)}else this._logger.error("No Sentry dsn provided")}SentryMetrics.prototype={captureException:function captureException(err){esm.b((function(scope){exceptionTags.forEach((function(tagName){tagName in err&&scope.setTag(tagName,err[tagName])})),esm.a(err)}))},__beforeSend:beforeSend,__cleanUpQueryParam:cleanUpQueryParam};var sentry=SentryMetrics,config=__webpack_require__(61);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach((function(key){Object(defineProperty.a)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var optEventData,sentryMetrics=new sentry(config.a.sentry.dsn),initialized=!1;function logAmplitudeEvent(groupName,eventName,eventProperties){if(function shouldSend(){return initialized&&window.navigator.sendBeacon}())try{var now=Date.now();!function postMetrics(eventData){window.navigator.sendBeacon("/metrics",JSON.stringify(eventData))}({events:[{offset:now-optEventData.flowBeginTime||0,type:"amplitude.".concat(groupName,".").concat(eventName)}],data:_objectSpread({flushTime:now},optEventData,{},eventProperties)})}catch(e){console.error("AppError",e),sentryMetrics.captureException(e)}}function amplitude_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}__webpack_require__.d(__webpack_exports__,"l",(function(){return manageSubscriptionsMounted})),__webpack_require__.d(__webpack_exports__,"k",(function(){return manageSubscriptionsEngaged})),__webpack_require__.d(__webpack_exports__,"g",(function(){return createSubscriptionMounted})),__webpack_require__.d(__webpack_exports__,"f",(function(){return createSubscriptionEngaged})),__webpack_require__.d(__webpack_exports__,"i",(function(){return createSubscription_PENDING})),__webpack_require__.d(__webpack_exports__,"h",(function(){return createSubscription_FULFILLED})),__webpack_require__.d(__webpack_exports__,"j",(function(){return createSubscription_REJECTED})),__webpack_require__.d(__webpack_exports__,"n",(function(){return updatePaymentMounted})),__webpack_require__.d(__webpack_exports__,"m",(function(){return updatePaymentEngaged})),__webpack_require__.d(__webpack_exports__,"p",(function(){return updatePayment_PENDING})),__webpack_require__.d(__webpack_exports__,"o",(function(){return updatePayment_FULFILLED})),__webpack_require__.d(__webpack_exports__,"q",(function(){return updatePayment_REJECTED})),__webpack_require__.d(__webpack_exports__,"b",(function(){return cancelSubscriptionMounted})),__webpack_require__.d(__webpack_exports__,"a",(function(){return cancelSubscriptionEngaged})),__webpack_require__.d(__webpack_exports__,"d",(function(){return cancelSubscription_PENDING})),__webpack_require__.d(__webpack_exports__,"c",(function(){return cancelSubscription_FULFILLED})),__webpack_require__.d(__webpack_exports__,"e",(function(){return cancelSubscription_REJECTED})),__webpack_require__.d(__webpack_exports__,"s",(function(){return updateSubscriptionPlanMounted})),__webpack_require__.d(__webpack_exports__,"r",(function(){return updateSubscriptionPlanEngaged})),__webpack_require__.d(__webpack_exports__,"u",(function(){return updateSubscriptionPlan_PENDING})),__webpack_require__.d(__webpack_exports__,"t",(function(){return updateSubscriptionPlan_FULFILLED})),__webpack_require__.d(__webpack_exports__,"v",(function(){return updateSubscriptionPlan_REJECTED}));var amplitude_sentryMetrics=new sentry(config.a.sentry.dsn),eventGroupNames={createSubscription:"subPaySetup",upgradeSubscription:"subPayUpgrade",updatePayment:"subPayManage",cancelSubscription:"subCancel",manageSubscriptions:"subManage"},eventTypeNames={view:"view",engage:"engage",submit:"submit",success:"success",fail:"fail",complete:"complete"},amplitude_safeLogAmplitudeEvent=function safeLogAmplitudeEvent(groupName,eventName,eventProperties){try{logAmplitudeEvent(groupName,eventName,amplitude_normalizeEventProperties(eventProperties))}catch(e){console.error("AppError",e),amplitude_sentryMetrics.captureException(e)}},amplitude_normalizeEventProperties=function normalizeEventProperties(eventProperties){var _eventProperties$erro=eventProperties.error,error=void 0===_eventProperties$erro?void 0:_eventProperties$erro,_eventProperties$plan=eventProperties.planId,planId=void 0===_eventProperties$plan?void 0:_eventProperties$plan,_eventProperties$plan2=eventProperties.plan_id,plan_id=void 0===_eventProperties$plan2?void 0:_eventProperties$plan2,_eventProperties$prod=eventProperties.productId,productId=void 0===_eventProperties$prod?void 0:_eventProperties$prod,_eventProperties$prod2=eventProperties.product_id,product_id=void 0===_eventProperties$prod2?void 0:_eventProperties$prod2,otherEventProperties=Object(objectWithoutProperties.a)(eventProperties,["error","planId","plan_id","productId","product_id"]);return function amplitude_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?amplitude_ownKeys(source,!0).forEach((function(key){Object(defineProperty.a)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):amplitude_ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({planId:planId||plan_id,productId:productId||product_id,reason:error&&error.message?error.message:void 0},otherEventProperties)};function manageSubscriptionsMounted(){amplitude_safeLogAmplitudeEvent(eventGroupNames.manageSubscriptions,eventTypeNames.view,{})}function manageSubscriptionsEngaged(){amplitude_safeLogAmplitudeEvent(eventGroupNames.manageSubscriptions,eventTypeNames.engage,{})}function createSubscriptionMounted(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.createSubscription,eventTypeNames.view,eventProperties)}function createSubscriptionEngaged(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.createSubscription,eventTypeNames.engage,eventProperties)}function createSubscription_PENDING(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.createSubscription,eventTypeNames.submit,eventProperties)}function createSubscription_FULFILLED(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.createSubscription,eventTypeNames.success,eventProperties),amplitude_safeLogAmplitudeEvent(eventGroupNames.createSubscription,eventTypeNames.complete,eventProperties)}function createSubscription_REJECTED(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.createSubscription,eventTypeNames.fail,eventProperties)}function updatePaymentMounted(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.updatePayment,eventTypeNames.view,eventProperties)}function updatePaymentEngaged(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.updatePayment,eventTypeNames.engage,eventProperties)}function updatePayment_PENDING(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.updatePayment,eventTypeNames.submit,eventProperties)}function updatePayment_FULFILLED(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.updatePayment,eventTypeNames.success,eventProperties),amplitude_safeLogAmplitudeEvent(eventGroupNames.updatePayment,eventTypeNames.complete,eventProperties)}function updatePayment_REJECTED(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.updatePayment,eventTypeNames.fail,eventProperties)}function cancelSubscriptionMounted(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.cancelSubscription,eventTypeNames.view,eventProperties)}function cancelSubscriptionEngaged(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.cancelSubscription,eventTypeNames.engage,eventProperties)}function cancelSubscription_PENDING(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.cancelSubscription,eventTypeNames.submit,eventProperties)}function cancelSubscription_FULFILLED(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.cancelSubscription,eventTypeNames.success,eventProperties),amplitude_safeLogAmplitudeEvent(eventGroupNames.cancelSubscription,eventTypeNames.complete,eventProperties)}function cancelSubscription_REJECTED(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.cancelSubscription,eventTypeNames.fail,eventProperties)}function updateSubscriptionPlanMounted(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.upgradeSubscription,eventTypeNames.view,eventProperties)}function updateSubscriptionPlanEngaged(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.upgradeSubscription,eventTypeNames.engage,eventProperties)}function updateSubscriptionPlan_PENDING(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.upgradeSubscription,eventTypeNames.submit,eventProperties)}function updateSubscriptionPlan_FULFILLED(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.upgradeSubscription,eventTypeNames.success,eventProperties)}function updateSubscriptionPlan_REJECTED(eventProperties){amplitude_safeLogAmplitudeEvent(eventGroupNames.upgradeSubscription,eventTypeNames.fail,eventProperties)}},61:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return config})),__webpack_require__.d(__webpack_exports__,"b",(function(){return defaultConfig}));__webpack_require__(7);var config={env:"development",featureFlags:{},lang:"",legalDocLinks:{privacyNotice:"",termsOfService:""},productRedirectURLs:{},sentry:{url:"https://sentry.prod.mozaws.net",dsn:""},servers:{auth:{url:""},content:{url:""},oauth:{url:""},profile:{url:""},surveyGizmo:{url:""}},stripe:{apiKey:""}};function defaultConfig(){return{env:"development",featureFlags:{},lang:"",legalDocLinks:{privacyNotice:"",termsOfService:""},productRedirectURLs:{},sentry:{url:"https://sentry.prod.mozaws.net",dsn:""},servers:{auth:{url:""},content:{url:""},oauth:{url:""},profile:{url:""},surveyGizmo:{url:""}},stripe:{apiKey:""}}}},631:function(module,exports,__webpack_require__){},632:function(module,exports,__webpack_require__){},633:function(module,exports,__webpack_require__){},634:function(module,exports,__webpack_require__){var map={"./AlertBar.stories.tsx":635,"./AppLayout/index.stories.tsx":638,"./DialogMessage.stories.tsx":659,"./LoadingOverlay.stories.tsx":661,"./PaymentForm/index.stories.tsx":663,"./Tooltip/index.stories.tsx":666};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=634},635:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_storybook_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9),_AlertBar__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(129);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_1__.storiesOf)("components/AlertBar",module).add("basic",(function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_AlertBar__WEBPACK_IMPORTED_MODULE_2__.a,{className:"alert"},"This is an alert.")}))}.call(this,__webpack_require__(51)(module))},636:function(module,exports,__webpack_require__){},637:function(module,exports,__webpack_require__){},638:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_storybook_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9),_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(23),_index__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(29);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_1__.storiesOf)("components/AppLayout",module).add("Settings layout",(function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_2__.a,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_index__WEBPACK_IMPORTED_MODULE_3__.a,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",{style:{padding:"0 2em 4em 2em"}},"App contents go here")))})).add("Sign-in layout",(function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_2__.a,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_index__WEBPACK_IMPORTED_MODULE_3__.b,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",null,"App contents go here")))}))}.call(this,__webpack_require__(51)(module))},658:function(module,exports,__webpack_require__){},659:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_storybook_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(9),_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(23),_storybook_components_LoremIpsum__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(324),_lib_hooks__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(34),_AppLayout__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(29),_DialogMessage__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(14);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_2__.storiesOf)("components/DialogMessage",module).add("basic",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(MockPage,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(DialogToggle,null,(function(_ref){var dialogShown=_ref.dialogShown,hideDialog=_ref.hideDialog;return dialogShown&&react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_DialogMessage__WEBPACK_IMPORTED_MODULE_7__.a,{onDismiss:hideDialog},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("h4",null,"This is a basic dialog"),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("p",null,"Content goes in here."))})))})).add("error",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(MockPage,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(DialogToggle,null,(function(_ref2){var dialogShown=_ref2.dialogShown,hideDialog=_ref2.hideDialog;return dialogShown&&react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_DialogMessage__WEBPACK_IMPORTED_MODULE_7__.a,{className:"dialog-error",onDismiss:hideDialog},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("h4",null,"This is an error dialog"),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("p",null,"Content goes in here."))})))})).add("without onDismiss",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(MockPage,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_DialogMessage__WEBPACK_IMPORTED_MODULE_7__.a,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("h4",null,"This is a basic dialog"),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("p",null,"Content goes in here.")))}));var MockPage=function MockPage(_ref3){var children=_ref3.children;return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_3__.a,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_AppLayout__WEBPACK_IMPORTED_MODULE_6__.b,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("h2",null,"This is some sample content"),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("p",null,"App content goes here, underneath the dialog."),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_storybook_components_LoremIpsum__WEBPACK_IMPORTED_MODULE_4__.a,null),children))},DialogToggle=function DialogToggle(_ref4){var children=_ref4.children,_useBooleanState=Object(_lib_hooks__WEBPACK_IMPORTED_MODULE_5__.a)(!0),_useBooleanState2=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useBooleanState,3),dialogShown=_useBooleanState2[0],showDialog=_useBooleanState2[1],hideDialog=_useBooleanState2[2],onClick=Object(react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(ev){ev.preventDefault(),showDialog()}),[showDialog]);return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{className:"dialog-toggle"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("button",{onClick:onClick},"Show dialog"),children({dialogShown:dialogShown,showDialog:showDialog,hideDialog:hideDialog}))}}.call(this,__webpack_require__(51)(module))},66:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return AuthServerErrno})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getErrorMessage}));var AuthServerErrno={UNKNOWN_SUBSCRIPTION_CUSTOMER:176,UNKNOWN_SUBSCRIPTION:177,UNKNOWN_SUBSCRIPTION_PLAN:178,REJECTED_SUBSCRIPTION_PAYMENT_TOKEN:179,SUBSCRIPTION_ALREADY_CANCELLED:180,REJECTED_CUSTOMER_UPDATE:181},BASIC_ERROR="basic-error-message",errorMessageIndex={expired_card:"expired-card-error",insufficient_funds:"insufficient-funds-error",withdrawal_count_limit_exceeded:"withdrawal-count-limit-error",charge_exceeds_source_limit:"charge-exceeds-source-limit-error",instant_payouts_unsupported:"instant-payouts-unsupported-error",duplicate_transaction:"duplicate-transaction-error",coupon_expired:"coupon-expired-error",card_error:"card-error"};function getErrorMessage(type){return errorMessageIndex[type]?errorMessageIndex[type]:BASIC_ERROR}["api_key_expired","platform_api_key_expired","rate_limit","UNKNOWN","api_connection_error","api_error","invalid_request_error","UNKNOWN","state_unsupported","invalid_source_usage","invoice_no_customer_line_items","invoice_no_subscription_line_items","invoice_not_editable","invoice_upcoming_none","missing","order_creation_failed","order_required_settings","order_status_invalid","order_upstream_timeout","payment_intent_incompatible_payment_method","payment_intent_unexpected_state","payment_method_unactivated","payment_method_unexpected_state","payouts_not_allowed","resource_already_exists","resource_missing","secret_key_required","sepa_unsupported_account","shipping_calculation_failed","tax_id_invalid","taxes_calculation_failed","tls_version_unsupported","token_already_used","token_in_use","transfers_not_allowed"].forEach((function(k){return errorMessageIndex[k]=BASIC_ERROR})),["approve_with_id","issuer_not_available","processing_error","reenter_transaction","try_again_later","payment_intent_authentication_failure","processing_error"].forEach((function(k){return errorMessageIndex[k]="payment-error-1"})),["call_issuer","card_not_supported","card_velocity_exceeded","do_not_honor","do_not_try_again","fraudulent","generic_decline","invalid_account","lost_card","merchant_blacklist","new_account_information_available","no_action_taken","not_permitted","pickup_card","restricted_card","revocation_of_all_authorizations","revocation_of_authorization","security_violation","service_not_allowed","stolen_card","stop_payment_order","transaction_not_allowed"].forEach((function(k){return errorMessageIndex[k]="payment-error-2"}))},660:function(module,exports,__webpack_require__){},661:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_storybook_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9),_LoadingOverlay__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(91);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_1__.storiesOf)("components/LoadingOverlay",module).add("isLoading = true",(function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_LoadingOverlay__WEBPACK_IMPORTED_MODULE_2__.a,{isLoading:!0})}))}.call(this,__webpack_require__(51)(module))},662:function(module,exports,__webpack_require__){},663:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_storybook_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9),_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(20),_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(23),_AppLayout__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(29),_index__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(104);var PLAN={plan_id:"plan_123",plan_name:"Example Plan",product_id:"product_8675309",product_name:"Example Product",currency:"USD",amount:1099,interval:"month"},Subject=function Subject(_ref){var _ref$inProgress=_ref.inProgress,inProgress=void 0!==_ref$inProgress&&_ref$inProgress,_ref$confirm=_ref.confirm,confirm=void 0===_ref$confirm||_ref$confirm,_ref$plan=_ref.plan,plan=void 0===_ref$plan?PLAN:_ref$plan,_ref$onPayment=_ref.onPayment,onPayment=void 0===_ref$onPayment?Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_2__.action)("onPayment"):_ref$onPayment,_ref$onPaymentError=_ref.onPaymentError,onPaymentError=void 0===_ref$onPaymentError?Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_2__.action)("onPaymentError"):_ref$onPaymentError,validatorInitialState=_ref.validatorInitialState,validatorMiddlewareReducer=_ref.validatorMiddlewareReducer,_ref$onChange=_ref.onChange,paymentFormProps={inProgress:inProgress,confirm:confirm,plan:plan,onPayment:onPayment,onPaymentError:onPaymentError,onChange:void 0===_ref$onChange?function(){}:_ref$onChange,validatorInitialState:validatorInitialState,validatorMiddlewareReducer:validatorMiddlewareReducer,onMounted:function onMounted(){},onEngaged:function onEngaged(){}};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(MockPage,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_index__WEBPACK_IMPORTED_MODULE_5__.a,paymentFormProps))},MockPage=function MockPage(_ref2){var children=_ref2.children;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_3__.a,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_AppLayout__WEBPACK_IMPORTED_MODULE_4__.b,null,children))},mockValidatorState=function mockValidatorState(){return{error:null,fields:{name:{value:null,valid:null,error:null,fieldType:"input",required:!0},zip:{value:null,valid:null,error:null,fieldType:"input",required:!0},creditCardNumber:{value:null,valid:null,error:null,fieldType:"stripe",required:!0},expDate:{value:null,valid:null,error:null,fieldType:"stripe",required:!0},cvc:{value:null,valid:null,error:null,fieldType:"stripe",required:!0},confirm:{value:null,valid:null,error:null,fieldType:"input",required:!0},submit:{value:null,valid:null,error:null,fieldType:"input",required:!1}}}};!function init(){Object(_storybook_react__WEBPACK_IMPORTED_MODULE_1__.storiesOf)("components/PaymentForm",module).add("default",(function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Subject,null)})).add("in progress",(function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Subject,{inProgress:!0})})).add("all invalid",(function(){var state=mockValidatorState();return state.fields.name.valid=!1,state.fields.name.error="Please enter your name",state.fields.zip.valid=!1,state.fields.zip.error="Zip code is too short",state.fields.creditCardNumber.valid=!1,state.fields.creditCardNumber.error="Your card number is incomplete",state.fields.expDate.valid=!1,state.fields.expDate.error="Your card's expiration date is incomplete",state.fields.cvc.valid=!1,state.fields.cvc.error="Your card's security code is incomplete",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Subject,{validatorInitialState:state})}))}()}.call(this,__webpack_require__(51)(module))},664:function(module,exports,__webpack_require__){},665:function(module,exports,__webpack_require__){},666:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__),_storybook_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(9),_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(23),_lib_screen_info__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(102),_AppLayout__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(29),_index__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(166);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}var Field=function Field(_ref){var children=_ref.children,_ref$message=_ref.message,message=void 0===_ref$message?"Valid email required":_ref$message,_ref$showTooltip=_ref.showTooltip,showTooltip=void 0===_ref$showTooltip||_ref$showTooltip,_ref$dismissible=_ref.dismissible,dismissible=void 0!==_ref$dismissible&&_ref$dismissible,_ref$onDismiss=_ref.onDismiss,onDismiss=void 0===_ref$onDismiss?function(){}:_ref$onDismiss,_ref$onFocus=_ref.onFocus,onFocus=void 0===_ref$onFocus?function(){}:_ref$onFocus,_ref$showBelow=_ref.showBelow,showBelow=void 0===_ref$showBelow?void 0:_ref$showBelow,_ref$clientHeight=_ref.clientHeight,clientHeight=void 0===_ref$clientHeight?void 0:_ref$clientHeight,_ref$extraClassNames=_ref.extraClassNames,extraClassNames=void 0===_ref$extraClassNames?"tooltip-error":_ref$extraClassNames,screenInfo=new _lib_screen_info__WEBPACK_IMPORTED_MODULE_5__.a(window);void 0!==clientHeight&&(screenInfo.clientHeight=clientHeight);var parentRef=Object(react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div",{className:"input-row"},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("label",null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("span",{className:"label-text"},children),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("input",{ref:parentRef,onFocus:onFocus,name:"name",type:"text",className:"name tooltip-below invalid",defaultValue:"",required:!0,autoFocus:!0,"aria-invalid":"true"}),showTooltip&&react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_index__WEBPACK_IMPORTED_MODULE_7__.a,{parentRef:parentRef,showBelow:showBelow,dismissible:dismissible,onDismiss:onDismiss,extraClassNames:extraClassNames,screenInfo:screenInfo},message)))},FieldWithDismissible=function FieldWithDismissible(props){var _useState=Object(react__WEBPACK_IMPORTED_MODULE_2__.useState)(!0),_useState2=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(_useState,2),showTooltip=_useState2[0],setShowTooltip=_useState2[1],onFocus=Object(react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((function(){return setShowTooltip(!0)}),[setShowTooltip]),onDismiss=Object(react__WEBPACK_IMPORTED_MODULE_2__.useCallback)((function(ev){ev.preventDefault(),setShowTooltip(!1)}),[setShowTooltip]);return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach((function(key){Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},props,{showTooltip:showTooltip,onFocus:onFocus,onDismiss:onDismiss}))},MockPage=function MockPage(_ref2){var children=_ref2.children;return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_4__.a,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_AppLayout__WEBPACK_IMPORTED_MODULE_6__.b,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("form",{className:"payment"},children)))};!function init(){Object(_storybook_react__WEBPACK_IMPORTED_MODULE_3__.storiesOf)("components/Tooltip",module).add("default",(function(){return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(MockPage,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,null,"default"))})).add("dismissible",(function(){return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(MockPage,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(FieldWithDismissible,{message:react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_2___default.a.Fragment,null,"Did you mean ",react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("a",{href:"https://mozilla.org"},"mozilla.org"),"?"),extraClassNames:"tooltip-error tooltip-suggest",dismissible:!0},"dismissible = true"))})).add("showBelow",(function(){return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(MockPage,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,{showBelow:!1},"showBelow = false"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,{showBelow:!0},"showBelow default"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,{showBelow:!0},"showBelow = true"))})).add("clientHeight",(function(){return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(MockPage,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,{clientHeight:300},"clientHeight = 300"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,{showBelow:!1,clientHeight:300},"clientHeight = 300, showBelow = false"),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Field,{clientHeight:1e3},"clientHeight = 1000"))}))}()}.call(this,__webpack_require__(51)(module))},667:function(module,exports,__webpack_require__){var map={"./Product/SubscriptionUpgrade/index.stories.tsx":668,"./Product/index.stories.tsx":672,"./Subscriptions/index.stories.tsx":678};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=667},668:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(20),_storybook_addon_links__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(48),_storybook_react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(9),_lib_apiClient__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(19),_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(23),_components_AppLayout__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(29),_mocks__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(108),_index__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(171);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach((function(key){Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var SubscriptionUpgradeView=function SubscriptionUpgradeView(_ref){var _ref$props=_ref.props,props=void 0===_ref$props?MOCK_PROPS:_ref$props;return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_6__.a,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_components_AppLayout__WEBPACK_IMPORTED_MODULE_7__.b,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_index__WEBPACK_IMPORTED_MODULE_9__.a,props)))},linkToUpgradeSuccess=Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_3__.linkTo)("routes/Product","success"),linkToUpgradeOffer=Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_3__.linkTo)("routes/Product/SubscriptionUpgrade","upgrade offer"),MOCK_PROPS={profile:_mocks__WEBPACK_IMPORTED_MODULE_8__.b,customer:_mocks__WEBPACK_IMPORTED_MODULE_8__.a,selectedPlan:_mocks__WEBPACK_IMPORTED_MODULE_8__.c,upgradeFromPlan:_mocks__WEBPACK_IMPORTED_MODULE_8__.d,upgradeFromSubscription:_mocks__WEBPACK_IMPORTED_MODULE_8__.a.subscriptions[0],updateSubscriptionPlanStatus:{error:null,loading:!1,result:null},updateSubscriptionPlanAndRefresh:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_2__.action)("updateSubscriptionPlanAndRefresh"),resetUpdateSubscriptionPlan:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_2__.action)("resetUpdateSubscriptionPlan")};!function init(){Object(_storybook_react__WEBPACK_IMPORTED_MODULE_4__.storiesOf)("routes/Product/SubscriptionUpgrade",module).add("upgrade offer",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionUpgradeView,{props:_objectSpread({},MOCK_PROPS,{updateSubscriptionPlanAndRefresh:function updateSubscriptionPlanAndRefresh(subscriptionId,plan){return linkToUpgradeSuccess()}})})})).add("submitting",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionUpgradeView,{props:_objectSpread({},MOCK_PROPS,{updateSubscriptionPlanStatus:{loading:!0,result:null,error:null}})})})),Object(_storybook_react__WEBPACK_IMPORTED_MODULE_4__.storiesOf)("routes/Product/SubscriptionUpgrade/failures",module).add("internal server error",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionUpgradeView,{props:_objectSpread({},MOCK_PROPS,{updateSubscriptionPlanStatus:{loading:!1,result:null,error:new _lib_apiClient__WEBPACK_IMPORTED_MODULE_5__.a({statusCode:500,message:"Internal Server Error"})},resetUpdateSubscriptionPlan:linkToUpgradeOffer})})}))}()}.call(this,__webpack_require__(51)(module))},671:function(module,exports,__webpack_require__){},672:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_storybook_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(9),_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(20),_storybook_addon_links__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(48),_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(23),_lib_apiClient__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(19),_components_AppLayout__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(29),_index__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(331);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach((function(key){Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var ProductRoute=function ProductRoute(_ref){var _ref$routeProps=_ref.routeProps,routeProps=void 0===_ref$routeProps?MOCK_PROPS:_ref$routeProps,_ref$queryParams=_ref.queryParams,queryParams=void 0===_ref$queryParams?_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_5__.b.queryParams:_ref$queryParams,applyStubsToStripe=_ref.applyStubsToStripe;return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_5__.a,{applyStubsToStripe:applyStubsToStripe,appContextValue:_objectSpread({},_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_5__.b,{queryParams:queryParams})},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_components_AppLayout__WEBPACK_IMPORTED_MODULE_7__.b,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_index__WEBPACK_IMPORTED_MODULE_8__.a,routeProps)))},PLANS=[{plan_id:"plan_123",plan_name:"Example Plan",product_id:"product_8675309",product_name:"Example Product",currency:"USD",amount:1050,interval:"month",product_metadata:{webIconURL:"http://placekitten.com/512/512"}}],CUSTOMER={payment_type:"credit",last4:"5309",exp_month:"02",exp_year:"2099",subscriptions:[{subscription_id:"sub0.28964929339372136",plan_id:"123doneProMonthly",nickname:"123done Pro Monthly",status:"active",cancel_at_period_end:!1,current_period_end:Date.now()/1e3+2678400,current_period_start:Date.now()/1e3-2678400,end_at:null}]},linkToSubscriptionSuccess=Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_4__.linkTo)("routes/Product","subscription success"),MOCK_PROPS={match:{params:{productId:"product_8675309"}},profile:{error:null,loading:!1,result:{amrValues:[],avatar:"http://placekitten.com/256/256",avatarDefault:!1,displayName:"Foo Barson",email:"foo@example.com",locale:"en-US",twoFactorAuthentication:!0,uid:"8675309asdf"}},plans:{error:null,loading:!1,result:PLANS},createSubscriptionStatus:{error:null,loading:!1,result:null},customer:{error:null,loading:!1,result:null},customerSubscriptions:[],plansByProductId:function plansByProductId(_){return PLANS},createSubscriptionAndRefresh:linkToSubscriptionSuccess,resetCreateSubscription:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("resetCreateSubscription"),fetchProductRouteResources:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("fetchProductRouteResources"),updateSubscriptionPlanAndRefresh:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("updateSubscriptionPlanAndRefresh"),resetUpdateSubscriptionPlan:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("resetUpdateSubscriptionPlan"),updateSubscriptionPlanStatus:{error:null,loading:!1,result:null}},FAILURE_PROPS=_objectSpread({},MOCK_PROPS,{resetCreateSubscription:Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_4__.linkTo)("routes/Product","subscribing with existing account")}),mkValidPaymentFormState=function mkValidPaymentFormState(){return{error:null,fields:{name:{value:"Foo Barson",valid:!0,error:null,fieldType:"input",required:!0},zip:{value:"90210",valid:!0,error:null,fieldType:"input",required:!0},creditCardNumber:{value:!0,valid:null,error:null,fieldType:"stripe",required:!0},expDate:{value:!0,valid:null,error:null,fieldType:"stripe",required:!0},cvc:{value:!0,valid:null,error:null,fieldType:"stripe",required:!0},confirm:{value:!0,valid:!0,error:null,fieldType:"input",required:!0},submit:{value:null,valid:null,error:null,fieldType:"input",required:!1}}}};!function init(){Object(_storybook_react__WEBPACK_IMPORTED_MODULE_2__.storiesOf)("routes/Product",module).add("subscribing with existing account",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,null)})).add("subscribing with new account",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{queryParams:{activated:"1"}})})).add("success",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},MOCK_PROPS,{customer:{loading:!1,error:null,result:CUSTOMER},customerSubscriptions:[{current_period_end:Date.now()/1e3+86400,current_period_start:Date.now()/1e3-86400,cancel_at_period_end:!1,end_at:null,nickname:"Example Plan",plan_id:"plan_123",status:"active",subscription_id:"sk_78987"}]})})})),Object(_storybook_react__WEBPACK_IMPORTED_MODULE_2__.storiesOf)("routes/Product/page load",module).add("profile loading",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},MOCK_PROPS,{profile:{loading:!0,error:null,result:null}})})})).add("profile error",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},MOCK_PROPS,{profile:{loading:!1,result:null,error:new _lib_apiClient__WEBPACK_IMPORTED_MODULE_6__.a({statusCode:500,message:"Internal Server Error"})}})})})).add("customer loading",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},MOCK_PROPS,{customer:{loading:!0,error:null,result:null}})})})).add("customer error",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},MOCK_PROPS,{customer:{loading:!1,result:null,error:new _lib_apiClient__WEBPACK_IMPORTED_MODULE_6__.a({statusCode:500,message:"Internal Server Error"})}})})})).add("plans loading",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},MOCK_PROPS,{plans:{loading:!0,error:null,result:null}})})})).add("plans error",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},MOCK_PROPS,{plans:{loading:!1,result:null,error:new _lib_apiClient__WEBPACK_IMPORTED_MODULE_6__.a({statusCode:500,message:"Internal Server Error"})}})})})),Object(_storybook_react__WEBPACK_IMPORTED_MODULE_2__.storiesOf)("routes/Product/payment failures",module).add("card declined",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},FAILURE_PROPS,{createSubscriptionStatus:{result:null,loading:!1,error:{code:"expired_card",message:"Your card has expired.",errno:181,error:"Bad Request",info:"https://github.com/mozilla/fxa/blob/master/packages/fxa-auth-server/docs/api.md#response-format",statusCode:402}}})})})).add("miscellaneous",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{routeProps:_objectSpread({},FAILURE_PROPS,{createSubscriptionStatus:{result:null,loading:!1,error:{code:"",message:"Payment server request failed."}}})})})).add("stripe.createToken() fails on submit",(function(){var validatorInitialState=mkValidPaymentFormState();return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(ProductRoute,{applyStubsToStripe:function applyStubsToStripe(stripe){return stripe.createToken=function(element){return Promise.reject({type:"api_error",message:"The Stripe system is down."})},stripe},routeProps:_objectSpread({},MOCK_PROPS,{validatorInitialState:validatorInitialState})})}))}()}.call(this,__webpack_require__(51)(module))},674:function(module,exports,__webpack_require__){},675:function(module,exports,__webpack_require__){},676:function(module,exports,__webpack_require__){},677:function(module,exports,__webpack_require__){},678:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_storybook_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(9),_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(20),_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(23),_components_AppLayout__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(29),_index__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(330),_lib_apiClient__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(19),_storybook_addon_links__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(48);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach((function(key){Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var linkToReactivationConfirmation=function linkToReactivationConfirmation(){return Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_8__.linkTo)("routes/Subscriptions","reactivation confirmation")},errorFetchState=function errorFetchState(){return{loading:!1,result:null,error:new _lib_apiClient__WEBPACK_IMPORTED_MODULE_7__.a({statusCode:500,message:"Internal Server Error"})}},SubscriptionsRoute=function SubscriptionsRoute(_ref){var _ref$routeProps=_ref.routeProps,routeProps=void 0===_ref$routeProps?baseProps:_ref$routeProps,_ref$queryParams=_ref.queryParams,queryParams=void 0===_ref$queryParams?_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_4__.b.queryParams:_ref$queryParams,applyStubsToStripe=_ref.applyStubsToStripe;return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_4__.a,{applyStubsToStripe:applyStubsToStripe,appContextValue:_objectSpread({},_storybook_components_MockApp__WEBPACK_IMPORTED_MODULE_4__.b,{queryParams:queryParams})},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_components_AppLayout__WEBPACK_IMPORTED_MODULE_5__.a,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_index__WEBPACK_IMPORTED_MODULE_6__.a,routeProps)))},PLANS=[{plan_id:"plan_123",plan_name:"Example Plan",product_id:"product_8675309",product_name:"Example Product",currency:"USD",amount:1099,interval:"month",product_metadata:{webIconURL:"http://placekitten.com/512/512"}}],baseProps={profile:{error:null,loading:!1,result:{amrValues:[],avatar:"http://placekitten.com/256/256",avatarDefault:!1,displayName:"Foo Barson",email:"foo@example.com",locale:"en-US",twoFactorAuthentication:!0,uid:"8675309asdf"}},plans:{error:null,loading:!1,result:PLANS},customer:{error:null,loading:!1,result:null},subscriptions:{error:null,loading:!1,result:null},customerSubscriptions:[],fetchSubscriptionsRouteResources:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("fetchSubscriptionsRouteResources"),cancelSubscription:function cancelSubscription(){return Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_8__.linkTo)("routes/Subscriptions","cancelled")()},reactivateSubscription:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("reactivateSubscription"),resetUpdatePayment:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("resetUpdatePayment"),resetCancelSubscription:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("resetCancelSubscription"),resetReactivateSubscription:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("resetReactivateSubscription"),updatePayment:function updatePayment(){return Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_8__.linkTo)("routes/Subscriptions","updated payment")()},updatePaymentStatus:{error:null,loading:!1,result:null},cancelSubscriptionStatus:{error:null,loading:!1,result:null},reactivateSubscriptionStatus:{error:null,loading:!1,result:null}},subscribedProps=_objectSpread({},baseProps,{customer:{loading:!1,error:null,result:{payment_type:"card",last4:"8675",exp_month:"12",exp_year:"2028",subscriptions:[]}},customerSubscriptions:[{current_period_end:(Date.now()+86400)/1e3,current_period_start:(Date.now()-86400)/1e3,cancel_at_period_end:!1,end_at:null,nickname:"Example Plan",plan_id:"plan_123",status:"active",subscription_id:"sub_5551212"}],subscriptions:{loading:!1,error:null,result:[{subscriptionId:"sub_5551212",productId:"product_123",createdAt:Date.now(),cancelledAt:null}]}}),cancelledProps=_objectSpread({},subscribedProps,{customerSubscriptions:subscribedProps.customerSubscriptions?[_objectSpread({},subscribedProps.customerSubscriptions[0],{cancel_at_period_end:!0})]:null,subscriptions:{loading:!1,error:null,result:[{subscriptionId:"sub_5551212",productId:"product_123",createdAt:Date.now()-4e8,cancelledAt:Date.now()-2e8}]}}),reactivationErrorProps=_objectSpread({},cancelledProps,{reactivateSubscriptionStatus:{loading:!1,result:!1,error:new _lib_apiClient__WEBPACK_IMPORTED_MODULE_7__.a({statusCode:500,message:"reactivateSubscription API not implemented"})}});!function init(){Object(_storybook_react__WEBPACK_IMPORTED_MODULE_2__.storiesOf)("routes/Subscriptions",module).add("loading",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},baseProps,{subscriptions:{loading:!0,error:null,result:null}})})})).add("no subscription",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,null)})).add("subscribed",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},subscribedProps)})})).add("subscribed with upgrade offer",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},subscribedProps,{plans:{error:null,loading:!1,result:[_objectSpread({},PLANS[0],{product_name:"Upgradable Product",product_metadata:{upgradeCTA:'\n                    Interested in better features?\n                    Upgrade to <a href="http://mozilla.org">the Upgrade Product</a>!\n                  '}})]}})})})).add("updated payment",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},subscribedProps,{updatePaymentStatus:{loading:!1,error:null,result:!0}})})})).add("cancelled",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},cancelledProps,{resetCancelSubscription:Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_8__.linkTo)("routes/Subscriptions","reactivation"),cancelSubscriptionStatus:{loading:!1,error:null,result:{subscriptionId:"sub_5551212",productId:"product_123",createdAt:Date.now()-864e5,cancelledAt:Date.now()}}})})})).add("reactivation",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},cancelledProps,{reactivateSubscription:linkToReactivationConfirmation})})})).add("reactivation confirmation",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},subscribedProps,{reactivateSubscriptionStatus:{loading:!1,error:null,result:{subscriptionId:"sub_5551212",plan:PLANS[0]}},resetReactivateSubscription:Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_8__.linkTo)("routes/Subscriptions","subscribed")})})})),Object(_storybook_react__WEBPACK_IMPORTED_MODULE_2__.storiesOf)("routes/Subscriptions/errors",module).add("profile",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},baseProps,{profile:errorFetchState()})})})).add("plans",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},baseProps,{plans:errorFetchState()})})})).add("subscriptions",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},baseProps,{subscriptions:errorFetchState()})})})).add("payment update",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},subscribedProps,{updatePaymentStatus:{loading:!1,result:null,error:new _lib_apiClient__WEBPACK_IMPORTED_MODULE_7__.a({code:"expired_card",message:"Your card has expired.",errno:181,error:"Bad Request",info:"https://github.com/mozilla/fxa/blob/master/packages/fxa-auth-server/docs/api.md#response-format"})}})})})).add("reactivation",(function(){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(SubscriptionsRoute,{routeProps:_objectSpread({},reactivationErrorProps,{reactivateSubscriptionStatus:errorFetchState(),resetReactivateSubscription:Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_8__.linkTo)("routes/Subscriptions","reactivation")})})}))}()}.call(this,__webpack_require__(51)(module))},679:function(module,exports,__webpack_require__){},74:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return sequences}));var _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10),_actions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(24),fetchProfile=_actions__WEBPACK_IMPORTED_MODULE_2__.a.fetchProfile,fetchPlans=_actions__WEBPACK_IMPORTED_MODULE_2__.a.fetchPlans,fetchSubscriptions=_actions__WEBPACK_IMPORTED_MODULE_2__.a.fetchSubscriptions,fetchCustomer=_actions__WEBPACK_IMPORTED_MODULE_2__.a.fetchCustomer,createSubscription=_actions__WEBPACK_IMPORTED_MODULE_2__.a.createSubscription,updateSubscriptionPlan=_actions__WEBPACK_IMPORTED_MODULE_2__.a.updateSubscriptionPlan,cancelSubscription=_actions__WEBPACK_IMPORTED_MODULE_2__.a.cancelSubscription,reactivateSubscription=_actions__WEBPACK_IMPORTED_MODULE_2__.a.reactivateSubscription,updatePayment=_actions__WEBPACK_IMPORTED_MODULE_2__.a.updatePayment,resetUpdatePayment=_actions__WEBPACK_IMPORTED_MODULE_2__.a.resetUpdatePayment,handleThunkError=function handleThunkError(err){},fetchCustomerAndSubscriptions=function fetchCustomerAndSubscriptions(){return function(){var _ref3=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee3(dispatch){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,Promise.all([dispatch(fetchCustomer()),dispatch(fetchSubscriptions())]).catch(handleThunkError);case 2:case"end":return _context3.stop()}}),_callee3)})));return function(_x3){return _ref3.apply(this,arguments)}}()},sequences={fetchProductRouteResources:function fetchProductRouteResources(){return function(){var _ref=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee(dispatch){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Promise.all([dispatch(fetchPlans()),dispatch(fetchProfile()),dispatch(fetchCustomer()),dispatch(fetchSubscriptions())]).catch(handleThunkError);case 2:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}()},fetchSubscriptionsRouteResources:function fetchSubscriptionsRouteResources(){return function(){var _ref2=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee2(dispatch){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,Promise.all([dispatch(fetchPlans()),dispatch(fetchProfile()),dispatch(fetchCustomer()),dispatch(fetchSubscriptions())]).catch(handleThunkError);case 2:case"end":return _context2.stop()}}),_callee2)})));return function(_x2){return _ref2.apply(this,arguments)}}()},fetchCustomerAndSubscriptions:fetchCustomerAndSubscriptions,createSubscriptionAndRefresh:function createSubscriptionAndRefresh(paymentToken,plan,displayName){return function(){var _ref4=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee4(dispatch){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.prev=0,_context4.next=3,dispatch(createSubscription(paymentToken,plan,displayName));case 3:return _context4.next=5,dispatch(fetchCustomerAndSubscriptions());case 5:_context4.next=10;break;case 7:_context4.prev=7,_context4.t0=_context4.catch(0),_context4.t0;case 10:case"end":return _context4.stop()}}),_callee4,null,[[0,7]])})));return function(_x4){return _ref4.apply(this,arguments)}}()},updateSubscriptionPlanAndRefresh:function updateSubscriptionPlanAndRefresh(subscriptionId,plan){return function(){var _ref5=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee5(dispatch){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.prev=0,_context5.next=3,dispatch(updateSubscriptionPlan(subscriptionId,plan));case 3:return _context5.next=5,dispatch(fetchCustomerAndSubscriptions());case 5:_context5.next=10;break;case 7:_context5.prev=7,_context5.t0=_context5.catch(0),_context5.t0;case 10:case"end":return _context5.stop()}}),_callee5,null,[[0,7]])})));return function(_x5){return _ref5.apply(this,arguments)}}()},cancelSubscriptionAndRefresh:function cancelSubscriptionAndRefresh(subscriptionId,plan){return function(){var _ref6=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee6(dispatch,getState){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.prev=0,_context6.next=3,dispatch(cancelSubscription(subscriptionId,plan));case 3:return _context6.next=5,dispatch(fetchCustomerAndSubscriptions());case 5:_context6.next=10;break;case 7:_context6.prev=7,_context6.t0=_context6.catch(0),_context6.t0;case 10:case"end":return _context6.stop()}}),_callee6,null,[[0,7]])})));return function(_x6,_x7){return _ref6.apply(this,arguments)}}()},reactivateSubscriptionAndRefresh:function reactivateSubscriptionAndRefresh(subscriptionId,plan){return function(){var _ref7=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee7(dispatch,getState){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.prev=0,_context7.next=3,dispatch(reactivateSubscription(subscriptionId,plan));case 3:return _context7.next=5,dispatch(fetchCustomerAndSubscriptions());case 5:_context7.next=10;break;case 7:_context7.prev=7,_context7.t0=_context7.catch(0),_context7.t0;case 10:case"end":return _context7.stop()}}),_callee7,null,[[0,7]])})));return function(_x8,_x9){return _ref7.apply(this,arguments)}}()},updatePaymentAndRefresh:function updatePaymentAndRefresh(paymentToken,plan){return function(){var _ref8=Object(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(_home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function _callee8(dispatch){return _home_circleci_project_packages_fxa_payments_server_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.prev=0,_context8.next=3,dispatch(updatePayment(paymentToken,plan));case 3:return _context8.next=5,dispatch(fetchCustomerAndSubscriptions());case 5:setTimeout((function(){return dispatch(resetUpdatePayment())}),5e3),_context8.next=11;break;case 8:_context8.prev=8,_context8.t0=_context8.catch(0),_context8.t0;case 11:case"end":return _context8.stop()}}),_callee8,null,[[0,8]])})));return function(_x10){return _ref8.apply(this,arguments)}}()}}},75:function(module,__webpack_exports__,__webpack_require__){"use strict";var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_DialogMessage__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(14);__webpack_exports__.a=function(_ref){var title=_ref.title,_ref$testid=_ref.testid,testid=void 0===_ref$testid?"":_ref$testid,fetchState=_ref.fetchState,_ref$onDismiss=_ref.onDismiss,onDismiss=void 0===_ref$onDismiss?function(){}:_ref$onDismiss;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_DialogMessage__WEBPACK_IMPORTED_MODULE_1__.b,{className:"dialog-error",onDismiss:onDismiss},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h4",{"data-testid":testid},title),fetchState.error&&fetchState.error.message&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",null,fetchState.error.message))}},91:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return LoadingOverlay}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),LoadingOverlay=(__webpack_require__(662),function LoadingOverlay(_ref){return _ref.isLoading?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{id:"loading-overlay","data-testid":"loading-overlay"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("img",{alt:"",src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSI3M3B4IiBoZWlnaHQ9IjczcHgiIHZpZXdCb3g9IjAgMCA3MyA3MyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgICAgIDxkZWZzPiAgICAgICAgPGxpbmVhckdyYWRpZW50IHgxPSI5My4wOTI4MDk2JSIgeTE9IjUyLjc3MzQzNzUlIiB4Mj0iNjguNTEzMzM5OCUiIHkyPSIxMTkuMzI2MDA3JSIgaWQ9ImxpbmVhckdyYWRpZW50LTEiPiAgICAgICAgICAgIDxzdG9wIHN0b3AtY29sb3I9IiMwQTg0RkYiIHN0b3Atb3BhY2l0eT0iMCIgb2Zmc2V0PSIwJSI+PC9zdG9wPiAgICAgICAgICAgIDxzdG9wIHN0b3AtY29sb3I9IiMwQTg0RkYiIG9mZnNldD0iNjkuMzY5ODE4MiUiPjwvc3RvcD4gICAgICAgICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMEE4NEZGIiBvZmZzZXQ9IjEwMCUiPjwvc3RvcD4gICAgICAgICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMjQ4NEM2IiBzdG9wLW9wYWNpdHk9IjAuMDA0Nzc3NjY5NTEiIG9mZnNldD0iMTAwJSI+PC9zdG9wPiAgICAgICAgICAgIDxzdG9wIHN0b3AtY29sb3I9IiMyNDg0QzYiIHN0b3Atb3BhY2l0eT0iMCIgb2Zmc2V0PSIxMDAlIj48L3N0b3A+ICAgICAgICAgICAgPHN0b3Agc3RvcC1jb2xvcj0iIzI0ODRDNiIgc3RvcC1vcGFjaXR5PSIwIiBvZmZzZXQ9IjEwMCUiPjwvc3RvcD4gICAgICAgIDwvbGluZWFyR3JhZGllbnQ+ICAgICAgICA8cmVjdCBpZD0icGF0aC0yIiB4PSIwIiB5PSIwIiB3aWR0aD0iNDgiIGhlaWdodD0iNjAiPjwvcmVjdD4gICAgPC9kZWZzPiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4gICAgICAgIDxnIGlkPSJTaGFwZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTUuMDAwMDAwLCAtMS4wMDAwMDApIj4gICAgICAgICAgICA8cGF0aCBkPSJNNDEuOCw3My44IEMyMS45LDczLjggNS44LDU3LjcgNS44LDM3LjggQzUuOCwxOC4xIDIxLjYsMi4yIDQxLjEsMS44IEM0MS4zLDEuOCA0MS40LDEuOCA0MS40LDEuOCBDNDEuNSwxLjggNDEuNywxLjggNDEuOCwxLjggQzQ0LjYsMi4yIDQ2LjgsNC41IDQ2LjgsNy4zIEM0Ni44LDEwLjEgNDQuNiwxMi41IDQxLjgsMTIuNyBDMjgsMTIuOCAxNi44LDI0IDE2LjgsMzcuOCBDMTYuOCw1MS42IDI4LDYyLjggNDEuOCw2Mi44IEM1NS42LDYyLjggNjYuOCw1MS42IDY2LjgsMzcuOCBMNzcuOCwzNy44IEM3Ny44LDU3LjcgNjEuNyw3My44IDQxLjgsNzMuOCBaIiBmaWxsPSJ1cmwoI2xpbmVhckdyYWRpZW50LTEpIj48L3BhdGg+ICAgICAgICAgICAgPG1hc2sgaWQ9Im1hc2stMyIgZmlsbD0id2hpdGUiPiAgICAgICAgICAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNwYXRoLTIiPjwvdXNlPiAgICAgICAgICAgIDwvbWFzaz4gICAgICAgICAgICA8ZyBpZD0iTWFzayI+PC9nPiAgICAgICAgICAgIDxwYXRoIGQ9Ik00MS44LDczLjggQzIxLjksNzMuOCA1LjgsNTcuNyA1LjgsMzcuOCBDNS44LDE4LjEgMjEuNiwyLjIgNDEuMSwxLjggQzQxLjMsMS44IDQxLjQsMS44IDQxLjQsMS44IEM0MS41LDEuOCA0MS43LDEuOCA0MS44LDEuOCBDNDQuNiwyLjIgNDYuOCw0LjUgNDYuOCw3LjMgQzQ2LjgsMTAuMSA0NC42LDEyLjUgNDEuOCwxMi43IEMyOCwxMi44IDE2LjgsMjQgMTYuOCwzNy44IEMxNi44LDUxLjYgMjgsNjIuOCA0MS44LDYyLjggQzU1LjYsNjIuOCA2Ni44LDUxLjYgNjYuOCwzNy44IEw3Ny44LDM3LjggQzc3LjgsNTcuNyA2MS43LDczLjggNDEuOCw3My44IFoiIGZpbGw9IiMwQTg0RkYiIG1hc2s9InVybCgjbWFzay0zKSI+PC9wYXRoPiAgICAgICAgPC9nPiAgICA8L2c+PC9zdmc+"})):null})}},[[336,1,2]]]);
//# sourceMappingURL=main.32d309a04a8de2206e90.bundle.js.map